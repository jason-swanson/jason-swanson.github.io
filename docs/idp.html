<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.1"/>
    <title>idp API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>


            <h2>Contents</h2>
            <ul>
  <li><a href="#module-description">Module description</a></li>
  <li><a href="#examples">Examples</a>
  <ul>
    <li><a href="#pressed-penny-machines">Pressed penny machines</a></li>
    <li><a href="#flipping-thumbtacks">Flipping thumbtacks</a></li>
    <li><a href="#amazon-reviews">Amazon reviews</a></li>
    <li><a href="#video-game-leaderboards">Video game leaderboards</a></li>
  </ul></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#IDPModel">IDPModel</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#IDPModel.__init__">IDPModel</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.colConc">colConc</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.rowConc">rowConc</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.baseMeas">baseMeas</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.rowCounts">rowCounts</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.likelihoods">likelihoods</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.scale">scale</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.weightedSims">weightedSims</a>
                        </li>
                        <li>
                                <a class="variable" href="#IDPModel.bandwidth">bandwidth</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.addRowCounts">addRowCounts</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.delRowCounts">delRowCounts</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.addWeightedSims">addWeightedSims</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.clearWeightedSims">clearWeightedSims</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.postProb">postProb</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.meanRDGcdf">meanRDGcdf</a>
                        </li>
                        <li>
                                <a class="function" href="#IDPModel.meanRDGpdf">meanRDGpdf</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#WeightedSim">WeightedSim</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#WeightedSim.__init__">WeightedSim</a>
                        </li>
                        <li>
                                <a class="variable" href="#WeightedSim.idpModel">idpModel</a>
                        </li>
                        <li>
                                <a class="variable" href="#WeightedSim.rowWeights">rowWeights</a>
                        </li>
                        <li>
                                <a class="variable" href="#WeightedSim.rowDistSims">rowDistSims</a>
                        </li>
                        <li>
                                <a class="variable" href="#WeightedSim.totalWeight">totalWeight</a>
                        </li>
                        <li>
                                <a class="function" href="#WeightedSim.updateRowCounts">updateRowCounts</a>
                        </li>
                        <li>
                                <a class="function" href="#WeightedSim.updateScale">updateScale</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
idp    </h1>

                        <div class="docstring"><p>Tools for working with iterated Dirichlet processes.</p>

<h1 id="module-description">Module description</h1>

<p>Consider a situation in which there are several agents, all from the
same population. Each agent undertakes a sequence of actions. These
actions are chosen according to the agent's particular tendencies.
Although different agents have different tendencies, there may be
patterns in the population.</p>

<p>We observe a certain set of agents over a certain amount of time. Based
on these observations, we want to make probabilistic forecasts about two
things:</p>

<ul>
<li>The future behavior of the agents we have observed.</li>
<li>The behavior of a new (unobserved) agent from the population.</li>
</ul>

<p>An iterated Dirichlet process is a mathematical tool that can model
this. The file, <code>idp-paper-9.pdf</code>, gives the mathematical details. (In
this rest of this documentation, we refer to this file as the "Paper.")
This module, <code><a href="">idp</a></code>, is a Python implementation of the iterated Dirichlet
process (IDP).</p>

<h1 id="examples">Examples</h1>

<h2 id="pressed-penny-machines">Pressed penny machines</h2>

<p>Imagine a pressed penny machine, like those found in museums or tourist
attractions. For a fee, the machine presses a penny into a commemorative
souvenir. Now imagine the machine is broken, so that it mangles all the
pennies we feed it. Each pressed penny it creates is mangled in its own
way. Each has its own probability of landing on heads when flipped. In
this situation, the agents are the pennies and the actions are the heads
and tails that they produce.</p>

<p>Now suppose we create seven mangled pennies and flip each one 5 times.
Suppose that the first four coins each result in 4 heads out of 5 flips.
The fifth coin results in 1 head, the sixth coin results in 4 heads, and
the seventh coin results in 3 heads. If we flip the fifth coin one more
time, what is the probability that it will land on heads? Looking only
at the past flips of the fifth coin, it seems biased towards tails.
Overall, though, the machine seems to make coins that are biased towards
heads. All seven coins could be heads-biased, and the fifth coin just
had an unlucky run. How should we balance these competing intuitions to
arrive at a probability?</p>

<p>One way to answer this is to model the situation with an IDP. We can do
this with the <code><a href="#IDPModel">IDPModel</a></code> class as follows:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">idp</span> <span class="kn">import</span> <span class="n">IDPModel</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span> <span class="o">=</span> <span class="n">IDPModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span>     <span class="p">[[</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</code></pre>
</div>

<p>Next, we run 10,000 weighted simulations and use them to estimate the
probability that the fifth coin, if flipped again, will land on heads:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">addWeightedSims</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">postProb</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.44196003938121636</span><span class="p">)</span>
</code></pre>
</div>

<p>Likewise, we can estimate the same probability for the first and seventh
coins:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">postProb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.7236483548829938</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">postProb</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.6806816746246023</span><span class="p">)</span>
</code></pre>
</div>

<p>We can also estimate the probability that a new coin from the machine
will land on heads when flipped. For this, we can use any argument
larger than the highest index in our observed data.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">postProb</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.6559370622554825</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">postProb</span><span class="p">(</span><span class="mi">47586</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.6559370622554825</span><span class="p">)</span>
</code></pre>
</div>

<p>If the new coin from the machine has probability of heads $\theta$, then
$\theta$ is a random variable taking values in $[0, 1]$. The following
will plot the cumulative distribution function of $\theta$:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">meanRDGcdf</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjQ2MC44cHQiIGhlaWdodD0iMzQ1LjZwdCIgdmlld0JveD0iMCAwIDQ2MC44IDM0NS42IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8bWV0YWRhdGE+CiAgPHJkZjpSREYgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICA8Y2M6V29yaz4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzpkYXRlPjIwMjUtMDEtMjZUMDg6Mzc6MzYuODg5MTU3PC9kYzpkYXRlPgogICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICA8ZGM6Y3JlYXRvcj4KICAgICA8Y2M6QWdlbnQ+CiAgICAgIDxkYzp0aXRsZT5NYXRwbG90bGliIHYzLjkuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy88L2RjOnRpdGxlPgogICAgIDwvY2M6QWdlbnQ+CiAgICA8L2RjOmNyZWF0b3I+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGRlZnM+CiAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4qe3N0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS1saW5lY2FwOiBidXR0fTwvc3R5bGU+CiA8L2RlZnM+CiA8ZyBpZD0iZmlndXJlXzEiPgogIDxnIGlkPSJwYXRjaF8xIj4KICAgPHBhdGggZD0iTSAwIDM0NS42IApMIDQ2MC44IDM0NS42IApMIDQ2MC44IDAgCkwgMCAwIAp6CiIgc3R5bGU9ImZpbGw6ICNmZmZmZmYiLz4KICA8L2c+CiAgPGcgaWQ9ImF4ZXNfMSI+CiAgIDxnIGlkPSJwYXRjaF8yIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCkwgNTcuNiA0MS40NzIgCnoKIiBzdHlsZT0iZmlsbDogI2ZmZmZmZiIvPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMSI+CiAgICA8ZyBpZD0ieHRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xIj4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibTRkZmI1ZDRlOTYiIGQ9Ik0gMCAwIApMIDAgMy41IAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNGRmYjVkNGU5NiIgeD0iNzMuODMyNzI3IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEiPgogICAgICA8IS0tIDAuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjUuODgxMTY1IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMCIgZD0iTSAyMDM0IDQyNTAgClEgMTU0NyA0MjUwIDEzMDEgMzc3MCAKUSAxMDU2IDMyOTEgMTA1NiAyMzI4IApRIDEwNTYgMTM2OSAxMzAxIDg4OSAKUSAxNTQ3IDQwOSAyMDM0IDQwOSAKUSAyNTI1IDQwOSAyNzcwIDg4OSAKUSAzMDE2IDEzNjkgMzAxNiAyMzI4IApRIDMwMTYgMzI5MSAyNzcwIDM3NzAgClEgMjUyNSA0MjUwIDIwMzQgNDI1MCAKegpNIDIwMzQgNDc1MCAKUSAyODE5IDQ3NTAgMzIzMyA0MTI5IApRIDM2NDcgMzUwOSAzNjQ3IDIzMjggClEgMzY0NyAxMTUwIDMyMzMgNTI5IApRIDI4MTkgLTkxIDIwMzQgLTkxIApRIDEyNTAgLTkxIDgzNiA1MjkgClEgNDIyIDExNTAgNDIyIDIzMjggClEgNDIyIDM1MDkgODM2IDQxMjkgClEgMTI1MCA0NzUwIDIwMzQgNDc1MCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMmUiIGQ9Ik0gNjg0IDc5NCAKTCAxMzQ0IDc5NCAKTCAxMzQ0IDAgCkwgNjg0IDAgCkwgNjg0IDc5NCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inh0aWNrXzIiPgogICAgIDxnIGlkPSJsaW5lMmRfMiI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTRkZmI1ZDRlOTYiIHg9IjEzOC43NjM2MzYiIHk9IjMwNy41ODQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMiI+CiAgICAgIDwhLS0gMC4yIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzAuODEyMDc0IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMiIgZD0iTSAxMjI4IDUzMSAKTCAzNDMxIDUzMSAKTCAzNDMxIDAgCkwgNDY5IDAgCkwgNDY5IDUzMSAKUSA4MjggOTAzIDE0NDggMTUyOSAKUSAyMDY5IDIxNTYgMjIyOCAyMzM4IApRIDI1MzEgMjY3OCAyNjUxIDI5MTQgClEgMjc3MiAzMTUwIDI3NzIgMzM3OCAKUSAyNzcyIDM3NTAgMjUxMSAzOTg0IApRIDIyNTAgNDIxOSAxODMxIDQyMTkgClEgMTUzNCA0MjE5IDEyMDQgNDExNiAKUSA4NzUgNDAxMyA1MDAgMzgwMyAKTCA1MDAgNDQ0MSAKUSA4ODEgNDU5NCAxMjEyIDQ2NzIgClEgMTU0NCA0NzUwIDE4MTkgNDc1MCAKUSAyNTQ0IDQ3NTAgMjk3NSA0Mzg3IApRIDM0MDYgNDAyNSAzNDA2IDM0MTkgClEgMzQwNiAzMTMxIDMyOTggMjg3MyAKUSAzMTkxIDI2MTYgMjkwNiAyMjY2IApRIDI4MjggMjE3NSAyNDA5IDE3NDIgClEgMTk5MSAxMzA5IDEyMjggNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF8zIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNGRmYjVkNGU5NiIgeD0iMjAzLjY5NDU0NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8zIj4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5NS43NDI5ODMgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM0IiBkPSJNIDI0MTkgNDExNiAKTCA4MjUgMTYyNSAKTCAyNDE5IDE2MjUgCkwgMjQxOSA0MTE2IAp6Ck0gMjI1MyA0NjY2IApMIDMwNDcgNDY2NiAKTCAzMDQ3IDE2MjUgCkwgMzcxMyAxNjI1IApMIDM3MTMgMTEwMCAKTCAzMDQ3IDExMDAgCkwgMzA0NyAwIApMIDI0MTkgMCAKTCAyNDE5IDExMDAgCkwgMzEzIDExMDAgCkwgMzEzIDE3MDkgCkwgMjI1MyA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF80Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNGRmYjVkNGU5NiIgeD0iMjY4LjYyNTQ1NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF80Ij4KICAgICAgPCEtLSAwLjYgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MC42NzM4OTIgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM2IiBkPSJNIDIxMTMgMjU4NCAKUSAxNjg4IDI1ODQgMTQzOSAyMjkzIApRIDExOTEgMjAwMyAxMTkxIDE0OTcgClEgMTE5MSA5OTQgMTQzOSA3MDEgClEgMTY4OCA0MDkgMjExMyA0MDkgClEgMjUzOCA0MDkgMjc4NiA3MDEgClEgMzAzNCA5OTQgMzAzNCAxNDk3IApRIDMwMzQgMjAwMyAyNzg2IDIyOTMgClEgMjUzOCAyNTg0IDIxMTMgMjU4NCAKegpNIDMzNjYgNDU2MyAKTCAzMzY2IDM5ODggClEgMzEyOCA0MTAwIDI4ODYgNDE1OSAKUSAyNjQ0IDQyMTkgMjQwNiA0MjE5IApRIDE3ODEgNDIxOSAxNDUxIDM3OTcgClEgMTEyMiAzMzc1IDEwNzUgMjUyMiAKUSAxMjU5IDI3OTQgMTUzNyAyOTM5IApRIDE4MTYgMzA4NCAyMTUwIDMwODQgClEgMjg1MyAzMDg0IDMyNjEgMjY1NyAKUSAzNjY5IDIyMzEgMzY2OSAxNDk3IApRIDM2NjkgNzc4IDMyNDQgMzQzIApRIDI4MTkgLTkxIDIxMTMgLTkxIApRIDEzMDMgLTkxIDg3NSA1MjkgClEgNDQ3IDExNTAgNDQ3IDIzMjggClEgNDQ3IDM0MzQgOTcyIDQwOTIgClEgMTQ5NyA0NzUwIDIzODEgNDc1MCAKUSAyNjE5IDQ3NTAgMjg2MSA0NzAzIApRIDMxMDMgNDY1NiAzMzY2IDQ1NjMgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM2IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI200ZGZiNWQ0ZTk2IiB4PSIzMzMuNTU2MzY0IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzUiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzI1LjYwNDgwMSAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzgiIGQ9Ik0gMjAzNCAyMjE2IApRIDE1ODQgMjIxNiAxMzI2IDE5NzUgClEgMTA2OSAxNzM0IDEwNjkgMTMxMyAKUSAxMDY5IDg5MSAxMzI2IDY1MCAKUSAxNTg0IDQwOSAyMDM0IDQwOSAKUSAyNDg0IDQwOSAyNzQzIDY1MSAKUSAzMDAzIDg5NCAzMDAzIDEzMTMgClEgMzAwMyAxNzM0IDI3NDUgMTk3NSAKUSAyNDg4IDIyMTYgMjAzNCAyMjE2IAp6Ck0gMTQwMyAyNDg0IApRIDk5NyAyNTg0IDc3MCAyODYyIApRIDU0NCAzMTQxIDU0NCAzNTQxIApRIDU0NCA0MTAwIDk0MiA0NDI1IApRIDEzNDEgNDc1MCAyMDM0IDQ3NTAgClEgMjczMSA0NzUwIDMxMjggNDQyNSAKUSAzNTI1IDQxMDAgMzUyNSAzNTQxIApRIDM1MjUgMzE0MSAzMjk4IDI4NjIgClEgMzA3MiAyNTg0IDI2NjkgMjQ4NCAKUSAzMTI1IDIzNzggMzM3OSAyMDY4IApRIDM2MzQgMTc1OSAzNjM0IDEzMTMgClEgMzYzNCA2MzQgMzIyMCAyNzEgClEgMjgwNiAtOTEgMjAzNCAtOTEgClEgMTI2MyAtOTEgODQ4IDI3MSAKUSA0MzQgNjM0IDQzNCAxMzEzIApRIDQzNCAxNzU5IDY5MCAyMDY4IApRIDk0NyAyMzc4IDE0MDMgMjQ4NCAKegpNIDExNzIgMzQ4MSAKUSAxMTcyIDMxMTkgMTM5OCAyOTE2IApRIDE2MjUgMjcxMyAyMDM0IDI3MTMgClEgMjQ0MSAyNzEzIDI2NzAgMjkxNiAKUSAyOTAwIDMxMTkgMjkwMCAzNDgxIApRIDI5MDAgMzg0NCAyNjcwIDQwNDcgClEgMjQ0MSA0MjUwIDIwMzQgNDI1MCAKUSAxNjI1IDQyNTAgMTM5OCA0MDQ3IApRIDExNzIgMzg0NCAxMTcyIDM0ODEgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM4IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzYiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI200ZGZiNWQ0ZTk2IiB4PSIzOTguNDg3MjczIiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzYiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkwLjUzNTcxIDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMSIgZD0iTSA3OTQgNTMxIApMIDE4MjUgNTMxIApMIDE4MjUgNDA5MSAKTCA3MDMgMzg2NiAKTCA3MDMgNDQ0MSAKTCAxODE5IDQ2NjYgCkwgMjQ1MCA0NjY2IApMIDI0NTAgNTMxIApMIDM0ODEgNTMxIApMIDM0ODEgMCAKTCA3OTQgMCAKTCA3OTQgNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9Im1hdHBsb3RsaWIuYXhpc18yIj4KICAgIDxnIGlkPSJ5dGlja18xIj4KICAgICA8ZyBpZD0ibGluZTJkXzciPgogICAgICA8ZGVmcz4KICAgICAgIDxwYXRoIGlkPSJtNzBlZDRiYjczMSIgZD0iTSAwIDAgCkwgLTMuNSAwIAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNzBlZDRiYjczMSIgeD0iNTcuNiIgeT0iMjk1LjQ4OCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF83Ij4KICAgICAgPCEtLSAwLjAgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAyOTkuMjg3MjE5KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18yIj4KICAgICA8ZyBpZD0ibGluZTJkXzgiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI203MGVkNGJiNzMxIiB4PSI1Ny42IiB5PSIyNDcuMTA0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzgiPgogICAgICA8IS0tIDAuMiAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDI1MC45MDMyMTkpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzIiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inl0aWNrXzMiPgogICAgIDxnIGlkPSJsaW5lMmRfOSI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTcwZWQ0YmI3MzEiIHg9IjU3LjYiIHk9IjE5OC43MiIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF85Ij4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAyMDIuNTE5MjE5KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM0IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja180Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEwIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNzBlZDRiYjczMSIgeD0iNTcuNiIgeT0iMTUwLjMzNiIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8xMCI+CiAgICAgIDwhLS0gMC42IC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNC42OTY4NzUgMTU0LjEzNTIxOSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfNSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xMSI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTcwZWQ0YmI3MzEiIHg9IjU3LjYiIHk9IjEwMS45NTIiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTEiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDEwNS43NTEyMTkpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzgiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inl0aWNrXzYiPgogICAgIDxnIGlkPSJsaW5lMmRfMTIiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI203MGVkNGJiNzMxIiB4PSI1Ny42IiB5PSI1My41NjgiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTIiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDU3LjM2NzIxOSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9ImxpbmUyZF8xMyI+CiAgICA8cGF0aCBkPSJNIDczLjgzMjcyNyAyOTUuNDg4IApMIDc1LjQ2NDE1NyAyOTQuMDc4Mjg3IApMIDc3LjA5NTU4NyAyOTMuNDAyMTYyIApMIDgwLjM1ODQ0NyAyOTIuMzg3OTQ2IApMIDg1LjI1MjczNiAyOTEuMDQ4OTAzIApMIDEwOC4wOTI3NTUgMjg1Ljg2MzYxOCAKTCAxMTcuODgxMzM0IDI4My44NTE4NjYgCkwgMTMwLjkzMjc3MyAyODEuMTY1ODA4IApMIDEzNS44MjcwNjMgMjgwLjI1NjAyMSAKTCAxNDUuNjE1NjQyIDI3OC4zNjczMDQgCkwgMTUwLjUwOTkzMSAyNzcuMzY0NjAzIApMIDE3NC45ODEzOCAyNzIuODcwNjA1IApMIDE3OS44NzU2NjkgMjcxLjkxODk0NSAKTCAxOTEuMjk1Njc4IDI2OS43MTM2MzQgCkwgMTk2LjE4OTk2OCAyNjguNjU0NTk3IApMIDIwMS4wODQyNTggMjY3LjY1NTk2NSAKTCAyMDQuMzQ3MTE3IDI2Ni44ODYwNjYgCkwgMjA5LjI0MTQwNyAyNjUuNzQ5OTk3IApMIDIxMC44NzI4MzcgMjY1LjM5MDkxMyAKTCAyMTcuMzk4NTU2IDI2My41MzAwNzMgCkwgMjE5LjAyOTk4NiAyNjMuMTU0NjM3IApMIDIyMi4yOTI4NDYgMjYyLjA4NDQxNCAKTCAyMjUuNTU1NzA2IDI2MS4wODE2MzMgCkwgMjMwLjQ0OTk5NSAyNTkuMzUwNTMzIApMIDIzOC42MDcxNDUgMjU2LjI4MTMzMSAKTCAyNDMuNTAxNDM0IDI1My44NzIyMjUgCkwgMjQ2Ljc2NDI5NCAyNTIuMTUzNDEyIApMIDI1OC4xODQzMDMgMjQ0LjUxNTcxMSAKTCAyNjMuMDc4NTkzIDIzOS44ODU1MTYgCkwgMjY0LjcxMDAyMyAyMzguMDM4NzM0IApMIDI2OS42MDQzMTIgMjMyLjg3MzY3MSAKTCAyNzEuMjM1NzQyIDIzMC45OTExIApMIDI3Ni4xMzAwMzIgMjIzLjYyMjAwMSAKTCAyNzcuNzYxNDYyIDIyMS40NDE3MDUgCkwgMjc5LjM5Mjg5MiAyMTguOTY5MTY0IApMIDI4MS4wMjQzMjIgMjE2LjAyODg1MSAKTCAyODIuNjU1NzUxIDIxMy41NTIwNjYgCkwgMjg0LjI4NzE4MSAyMTAuNTIzNTc2IApMIDI4Ny41NTAwNDEgMjA1LjM2NzgxNCAKTCAyOTIuNDQ0MzMxIDE5NC42Nzk3ODcgCkwgMjk0LjA3NTc2MSAxOTIuMDY5NjU3IApMIDI5NS43MDcxOSAxODkuMTM0ODA4IApMIDI5Ny4zMzg2MiAxODQuODcwNDIgCkwgMjk4Ljk3MDA1IDE4MS45MjExMDggCkwgMzAwLjYwMTQ4IDE3Ny43NjQzNSAKTCAzMDMuODY0MzQgMTcwLjc4OTA0MSAKTCAzMDUuNDk1NzcgMTY3LjM4NDkxNiAKTCAzMDguNzU4NjMgMTYwLjE3MDgxIApMIDMxMC4zOTAwNTkgMTU2Ljc5OTI1NiAKTCAzMTMuNjUyOTE5IDE0OC42NzE3ODEgCkwgMzE1LjI4NDM0OSAxNDQuNTQwODg5IApMIDMyMS44MTAwNjkgMTMwLjk4MzkwMyAKTCAzMjMuNDQxNDk4IDEyNy43MDgwMTcgCkwgMzI2LjcwNDM1OCAxMjAuNDAzOTkzIApMIDMyOC4zMzU3ODggMTE3LjQ4MjE1NiAKTCAzMzEuNTk4NjQ4IDExMC44MTExNDQgCkwgMzM4LjEyNDM2NyA5OC45NTY3ODIgCkwgMzM5Ljc1NTc5NyA5Ni4zMjA2MjUgCkwgMzQxLjM4NzIyNyA5My4zMzQyMzIgCkwgMzQ0LjY1MDA4NyA4OC40NzAzOTUgCkwgMzQ3LjkxMjk0NyA4My42MjE0NzcgCkwgMzQ5LjU0NDM3NiA4MS44MDIwMjggCkwgMzUxLjE3NTgwNiA3OS43OTQ5MDcgCkwgMzU0LjQzODY2NiA3Ni40NzUwMDYgCkwgMzU2LjA3MDA5NiA3NC41Mjc3MTIgCkwgMzU5LjMzMjk1NiA3MS4zOTgzNjEgCkwgMzYwLjk2NDM4NiA2OS45NzA0NzMgCkwgMzY0LjIyNzI0NSA2Ny41NzY5NiAKTCAzNjkuMTIxNTM1IDY0LjQ2NjQ0OSAKTCAzNzIuMzg0Mzk1IDYyLjg2MTA1OCAKTCAzNzcuMjc4Njg0IDYwLjg2OTU5IApMIDM4MC41NDE1NDQgNTkuNzQ4NTExIApMIDM4Ny4wNjcyNjQgNTcuOTEwNjIyIApMIDM5NS4yMjQ0MTMgNTUuNjAyMzMyIApMIDM5Ni44NTU4NDMgNTQuOTY1NzIxIApMIDM5OC40ODcyNzMgNTMuNTY4IApMIDM5OC40ODcyNzMgNTMuNTY4IAoiIGNsaXAtcGF0aD0idXJsKCNwODMyZjc1NjFlOCkiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMxZjc3YjQ7IHN0cm9rZS13aWR0aDogMS41OyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzMiPgogICAgPHBhdGggZD0iTSA1Ny42IDMwNy41ODQgCkwgNTcuNiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNCI+CiAgICA8cGF0aCBkPSJNIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNSI+CiAgICA8cGF0aCBkPSJNIDU3LjYgMzA3LjU4NCAKTCA0MTQuNzIgMzA3LjU4NCAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF82Ij4KICAgIDxwYXRoIGQ9Ik0gNTcuNiA0MS40NzIgCkwgNDE0LjcyIDQxLjQ3MiAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgPC9nPgogPC9nPgogPGRlZnM+CiAgPGNsaXBQYXRoIGlkPSJwODMyZjc1NjFlOCI+CiAgIDxyZWN0IHg9IjU3LjYiIHk9IjQxLjQ3MiIgd2lkdGg9IjM1Ny4xMiIgaGVpZ2h0PSIyNjYuMTEyIi8+CiAgPC9jbGlwUGF0aD4KIDwvZGVmcz4KPC9zdmc+Cg==" alt="image" /></p>

<p>The random variable $\theta$ has a discrete component, so it does not
have a probability density function. But we can plot an approximate
density as follows:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">meanRDGpdf</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjQ2MC44cHQiIGhlaWdodD0iMzQ1LjZwdCIgdmlld0JveD0iMCAwIDQ2MC44IDM0NS42IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8bWV0YWRhdGE+CiAgPHJkZjpSREYgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICA8Y2M6V29yaz4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzpkYXRlPjIwMjUtMDEtMjZUMDg6Mzc6NDAuMzAwODAzPC9kYzpkYXRlPgogICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICA8ZGM6Y3JlYXRvcj4KICAgICA8Y2M6QWdlbnQ+CiAgICAgIDxkYzp0aXRsZT5NYXRwbG90bGliIHYzLjkuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy88L2RjOnRpdGxlPgogICAgIDwvY2M6QWdlbnQ+CiAgICA8L2RjOmNyZWF0b3I+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGRlZnM+CiAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4qe3N0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS1saW5lY2FwOiBidXR0fTwvc3R5bGU+CiA8L2RlZnM+CiA8ZyBpZD0iZmlndXJlXzEiPgogIDxnIGlkPSJwYXRjaF8xIj4KICAgPHBhdGggZD0iTSAwIDM0NS42IApMIDQ2MC44IDM0NS42IApMIDQ2MC44IDAgCkwgMCAwIAp6CiIgc3R5bGU9ImZpbGw6ICNmZmZmZmYiLz4KICA8L2c+CiAgPGcgaWQ9ImF4ZXNfMSI+CiAgIDxnIGlkPSJwYXRjaF8yIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCkwgNTcuNiA0MS40NzIgCnoKIiBzdHlsZT0iZmlsbDogI2ZmZmZmZiIvPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMSI+CiAgICA8ZyBpZD0ieHRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xIj4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibWI0Y2Y1MzNjYWUiIGQ9Ik0gMCAwIApMIDAgMy41IAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYjRjZjUzM2NhZSIgeD0iNzIuMTg0NzM1IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEiPgogICAgICA8IS0tIDAuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjQuMjMzMTcyIDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMCIgZD0iTSAyMDM0IDQyNTAgClEgMTU0NyA0MjUwIDEzMDEgMzc3MCAKUSAxMDU2IDMyOTEgMTA1NiAyMzI4IApRIDEwNTYgMTM2OSAxMzAxIDg4OSAKUSAxNTQ3IDQwOSAyMDM0IDQwOSAKUSAyNTI1IDQwOSAyNzcwIDg4OSAKUSAzMDE2IDEzNjkgMzAxNiAyMzI4IApRIDMwMTYgMzI5MSAyNzcwIDM3NzAgClEgMjUyNSA0MjUwIDIwMzQgNDI1MCAKegpNIDIwMzQgNDc1MCAKUSAyODE5IDQ3NTAgMzIzMyA0MTI5IApRIDM2NDcgMzUwOSAzNjQ3IDIzMjggClEgMzY0NyAxMTUwIDMyMzMgNTI5IApRIDI4MTkgLTkxIDIwMzQgLTkxIApRIDEyNTAgLTkxIDgzNiA1MjkgClEgNDIyIDExNTAgNDIyIDIzMjggClEgNDIyIDM1MDkgODM2IDQxMjkgClEgMTI1MCA0NzUwIDIwMzQgNDc1MCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMmUiIGQ9Ik0gNjg0IDc5NCAKTCAxMzQ0IDc5NCAKTCAxMzQ0IDAgCkwgNjg0IDAgCkwgNjg0IDc5NCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inh0aWNrXzIiPgogICAgIDxnIGlkPSJsaW5lMmRfMiI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbWI0Y2Y1MzNjYWUiIHg9IjEzNy43NzQ4NDEiIHk9IjMwNy41ODQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMiI+CiAgICAgIDwhLS0gMC4yIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjkuODIzMjc4IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMiIgZD0iTSAxMjI4IDUzMSAKTCAzNDMxIDUzMSAKTCAzNDMxIDAgCkwgNDY5IDAgCkwgNDY5IDUzMSAKUSA4MjggOTAzIDE0NDggMTUyOSAKUSAyMDY5IDIxNTYgMjIyOCAyMzM4IApRIDI1MzEgMjY3OCAyNjUxIDI5MTQgClEgMjc3MiAzMTUwIDI3NzIgMzM3OCAKUSAyNzcyIDM3NTAgMjUxMSAzOTg0IApRIDIyNTAgNDIxOSAxODMxIDQyMTkgClEgMTUzNCA0MjE5IDEyMDQgNDExNiAKUSA4NzUgNDAxMyA1MDAgMzgwMyAKTCA1MDAgNDQ0MSAKUSA4ODEgNDU5NCAxMjEyIDQ2NzIgClEgMTU0NCA0NzUwIDE4MTkgNDc1MCAKUSAyNTQ0IDQ3NTAgMjk3NSA0Mzg3IApRIDM0MDYgNDAyNSAzNDA2IDM0MTkgClEgMzQwNiAzMTMxIDMyOTggMjg3MyAKUSAzMTkxIDI2MTYgMjkwNiAyMjY2IApRIDI4MjggMjE3NSAyNDA5IDE3NDIgClEgMTk5MSAxMzA5IDEyMjggNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF8zIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYjRjZjUzM2NhZSIgeD0iMjAzLjM2NDk0NyIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8zIj4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5NS40MTMzODQgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM0IiBkPSJNIDI0MTkgNDExNiAKTCA4MjUgMTYyNSAKTCAyNDE5IDE2MjUgCkwgMjQxOSA0MTE2IAp6Ck0gMjI1MyA0NjY2IApMIDMwNDcgNDY2NiAKTCAzMDQ3IDE2MjUgCkwgMzcxMyAxNjI1IApMIDM3MTMgMTEwMCAKTCAzMDQ3IDExMDAgCkwgMzA0NyAwIApMIDI0MTkgMCAKTCAyNDE5IDExMDAgCkwgMzEzIDExMDAgCkwgMzEzIDE3MDkgCkwgMjI1MyA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF80Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYjRjZjUzM2NhZSIgeD0iMjY4Ljk1NTA1MyIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF80Ij4KICAgICAgPCEtLSAwLjYgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MS4wMDM0OTEgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM2IiBkPSJNIDIxMTMgMjU4NCAKUSAxNjg4IDI1ODQgMTQzOSAyMjkzIApRIDExOTEgMjAwMyAxMTkxIDE0OTcgClEgMTE5MSA5OTQgMTQzOSA3MDEgClEgMTY4OCA0MDkgMjExMyA0MDkgClEgMjUzOCA0MDkgMjc4NiA3MDEgClEgMzAzNCA5OTQgMzAzNCAxNDk3IApRIDMwMzQgMjAwMyAyNzg2IDIyOTMgClEgMjUzOCAyNTg0IDIxMTMgMjU4NCAKegpNIDMzNjYgNDU2MyAKTCAzMzY2IDM5ODggClEgMzEyOCA0MTAwIDI4ODYgNDE1OSAKUSAyNjQ0IDQyMTkgMjQwNiA0MjE5IApRIDE3ODEgNDIxOSAxNDUxIDM3OTcgClEgMTEyMiAzMzc1IDEwNzUgMjUyMiAKUSAxMjU5IDI3OTQgMTUzNyAyOTM5IApRIDE4MTYgMzA4NCAyMTUwIDMwODQgClEgMjg1MyAzMDg0IDMyNjEgMjY1NyAKUSAzNjY5IDIyMzEgMzY2OSAxNDk3IApRIDM2NjkgNzc4IDMyNDQgMzQzIApRIDI4MTkgLTkxIDIxMTMgLTkxIApRIDEzMDMgLTkxIDg3NSA1MjkgClEgNDQ3IDExNTAgNDQ3IDIzMjggClEgNDQ3IDM0MzQgOTcyIDQwOTIgClEgMTQ5NyA0NzUwIDIzODEgNDc1MCAKUSAyNjE5IDQ3NTAgMjg2MSA0NzAzIApRIDMxMDMgNDY1NiAzMzY2IDQ1NjMgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM2IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI21iNGNmNTMzY2FlIiB4PSIzMzQuNTQ1MTU5IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzUiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzI2LjU5MzU5NyAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzgiIGQ9Ik0gMjAzNCAyMjE2IApRIDE1ODQgMjIxNiAxMzI2IDE5NzUgClEgMTA2OSAxNzM0IDEwNjkgMTMxMyAKUSAxMDY5IDg5MSAxMzI2IDY1MCAKUSAxNTg0IDQwOSAyMDM0IDQwOSAKUSAyNDg0IDQwOSAyNzQzIDY1MSAKUSAzMDAzIDg5NCAzMDAzIDEzMTMgClEgMzAwMyAxNzM0IDI3NDUgMTk3NSAKUSAyNDg4IDIyMTYgMjAzNCAyMjE2IAp6Ck0gMTQwMyAyNDg0IApRIDk5NyAyNTg0IDc3MCAyODYyIApRIDU0NCAzMTQxIDU0NCAzNTQxIApRIDU0NCA0MTAwIDk0MiA0NDI1IApRIDEzNDEgNDc1MCAyMDM0IDQ3NTAgClEgMjczMSA0NzUwIDMxMjggNDQyNSAKUSAzNTI1IDQxMDAgMzUyNSAzNTQxIApRIDM1MjUgMzE0MSAzMjk4IDI4NjIgClEgMzA3MiAyNTg0IDI2NjkgMjQ4NCAKUSAzMTI1IDIzNzggMzM3OSAyMDY4IApRIDM2MzQgMTc1OSAzNjM0IDEzMTMgClEgMzYzNCA2MzQgMzIyMCAyNzEgClEgMjgwNiAtOTEgMjAzNCAtOTEgClEgMTI2MyAtOTEgODQ4IDI3MSAKUSA0MzQgNjM0IDQzNCAxMzEzIApRIDQzNCAxNzU5IDY5MCAyMDY4IApRIDk0NyAyMzc4IDE0MDMgMjQ4NCAKegpNIDExNzIgMzQ4MSAKUSAxMTcyIDMxMTkgMTM5OCAyOTE2IApRIDE2MjUgMjcxMyAyMDM0IDI3MTMgClEgMjQ0MSAyNzEzIDI2NzAgMjkxNiAKUSAyOTAwIDMxMTkgMjkwMCAzNDgxIApRIDI5MDAgMzg0NCAyNjcwIDQwNDcgClEgMjQ0MSA0MjUwIDIwMzQgNDI1MCAKUSAxNjI1IDQyNTAgMTM5OCA0MDQ3IApRIDExNzIgMzg0NCAxMTcyIDM0ODEgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM4IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzYiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI21iNGNmNTMzY2FlIiB4PSI0MDAuMTM1MjY1IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzYiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkyLjE4MzcwMyAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzEiIGQ9Ik0gNzk0IDUzMSAKTCAxODI1IDUzMSAKTCAxODI1IDQwOTEgCkwgNzAzIDM4NjYgCkwgNzAzIDQ0NDEgCkwgMTgxOSA0NjY2IApMIDI0NTAgNDY2NiAKTCAyNDUwIDUzMSAKTCAzNDgxIDUzMSAKTCAzNDgxIDAgCkwgNzk0IDAgCkwgNzk0IDUzMSAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMxIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMiI+CiAgICA8ZyBpZD0ieXRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF83Ij4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibWMwNmNmNmY1NmUiIGQ9Ik0gMCAwIApMIC0zLjUgMCAKIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2RlZnM+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbWMwNmNmNmY1NmUiIHg9IjU3LjYiIHk9IjI3My4yNDg5ODYiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfNyI+CiAgICAgIDwhLS0gMC41IC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNC42OTY4NzUgMjc3LjA0ODIwNSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM1IiBkPSJNIDY5MSA0NjY2IApMIDMxNjkgNDY2NiAKTCAzMTY5IDQxMzQgCkwgMTI2OSA0MTM0IApMIDEyNjkgMjk5MSAKUSAxNDA2IDMwMzggMTU0MyAzMDYxIApRIDE2ODEgMzA4NCAxODE5IDMwODQgClEgMjYwMCAzMDg0IDMwNTYgMjY1NiAKUSAzNTEzIDIyMjggMzUxMyAxNDk3IApRIDM1MTMgNzQ0IDMwNDQgMzI2IApRIDI1NzUgLTkxIDE3MjIgLTkxIApRIDE0MjggLTkxIDExMjMgLTQxIApRIDgxOSA5IDQ5NCAxMDkgCkwgNDk0IDc0NCAKUSA3NzUgNTkxIDEwNzUgNTE2IApRIDEzNzUgNDQxIDE3MDkgNDQxIApRIDIyNTAgNDQxIDI1NjUgNzI1IApRIDI4ODEgMTAwOSAyODgxIDE0OTcgClEgMjg4MSAxOTg0IDI1NjUgMjI2OCAKUSAyMjUwIDI1NTMgMTcwOSAyNTUzIApRIDE0NTYgMjU1MyAxMjA0IDI0OTcgClEgOTUzIDI0NDEgNjkxIDIzMjIgCkwgNjkxIDQ2NjYgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM1IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18yIj4KICAgICA8ZyBpZD0ibGluZTJkXzgiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI21jMDZjZjZmNTZlIiB4PSI1Ny42IiB5PSIyMjkuMjI2OTYxIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzgiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDIzMy4wMjYxOCkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF85Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYzA2Y2Y2ZjU2ZSIgeD0iNTcuNiIgeT0iMTg1LjIwNDkzNiIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF85Ij4KICAgICAgPCEtLSAxLjUgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAxODkuMDA0MTU1KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMSIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM1IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja180Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEwIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYzA2Y2Y2ZjU2ZSIgeD0iNTcuNiIgeT0iMTQxLjE4MjkxIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEwIj4KICAgICAgPCEtLSAyLjAgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAxNDQuOTgyMTI5KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzExIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYzA2Y2Y2ZjU2ZSIgeD0iNTcuNiIgeT0iOTcuMTYwODg1IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzExIj4KICAgICAgPCEtLSAyLjUgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAxMDAuOTYwMTA0KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM1IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEyIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtYzA2Y2Y2ZjU2ZSIgeD0iNTcuNiIgeT0iNTMuMTM4ODYiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTIiPgogICAgICA8IS0tIDMuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDU2LjkzODA3OSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTMzIiBkPSJNIDI1OTcgMjUxNiAKUSAzMDUwIDI0MTkgMzMwNCAyMTEyIApRIDM1NTkgMTgwNiAzNTU5IDEzNTYgClEgMzU1OSA2NjYgMzA4NCAyODcgClEgMjYwOSAtOTEgMTczNCAtOTEgClEgMTQ0MSAtOTEgMTEzMCAtMzMgClEgODE5IDI1IDQ4OCAxNDEgCkwgNDg4IDc1MCAKUSA3NTAgNTk3IDEwNjIgNTE5IApRIDEzNzUgNDQxIDE3MTYgNDQxIApRIDIzMDkgNDQxIDI2MjAgNjc1IApRIDI5MzEgOTA5IDI5MzEgMTM1NiAKUSAyOTMxIDE3NjkgMjY0MiAyMDAxIApRIDIzNTMgMjIzNCAxODM4IDIyMzQgCkwgMTI5NCAyMjM0IApMIDEyOTQgMjc1MyAKTCAxODYzIDI3NTMgClEgMjMyOCAyNzUzIDI1NzUgMjkzOSAKUSAyODIyIDMxMjUgMjgyMiAzNDc1IApRIDI4MjIgMzgzNCAyNTY3IDQwMjYgClEgMjMxMyA0MjE5IDE4MzggNDIxOSAKUSAxNTc4IDQyMTkgMTI4MSA0MTYyIApRIDk4NCA0MTA2IDYyOCAzOTg4IApMIDYyOCA0NTUwIApRIDk4OCA0NjUwIDEzMDIgNDcwMCAKUSAxNjE2IDQ3NTAgMTg5NCA0NzUwIApRIDI2MTMgNDc1MCAzMDMxIDQ0MjMgClEgMzQ1MCA0MDk3IDM0NTAgMzU0MSAKUSAzNDUwIDMxNTMgMzIyOCAyODg2IApRIDMwMDYgMjYxOSAyNTk3IDI1MTYgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgPC9nPgogICA8ZyBpZD0ibGluZTJkXzEzIj4KICAgIDxwYXRoIGQ9Ik0gNzMuODMyNzI3IDI2Mi45NTQ3OSAKTCA3NS40ODA3MiAyNzYuMzk1ODQ0IApMIDc3LjEyODcxMyAyODEuODA4NjQ2IApMIDc4Ljc3NjcwNSAyODQuNjk5MDE1IApMIDgwLjQyNDY5OCAyODYuNDY2NjAxIApMIDgyLjA3MjY5IDI4Ny42NTEzNDUgCkwgODMuNzIwNjgzIDI4OC41MDI1NzEgCkwgODUuMzY4Njc2IDI4OS4xNDQ4NiAKTCA4OC42NjQ2NjEgMjkwLjAzMjA5NCAKTCA5MS45NjA2NDYgMjkwLjU2NDMxMiAKTCA5NS4yNTY2MzEgMjkwLjg2NDc1NiAKTCAxMDMuNDk2NTk0IDI5MS40MTA5OTIgCkwgMTA2Ljc5MjU4IDI5MS44NDk4ODIgCkwgMTE1LjAzMjU0MyAyOTMuMTE3NTA3IApMIDExOC4zMjg1MjggMjkzLjM2NDMxOCAKTCAxMjkuODY0NDc2IDI5My45MDg4MyAKTCAxMzQuODA4NDU0IDI5NC4yMDc3NjEgCkwgMTM5Ljc1MjQzMiAyOTQuMjM5NTU2IApMIDE0NC42OTY0MSAyOTQuMjU4Mjk0IApMIDE0Ny45OTIzOTUgMjk0LjQ0ODg5MyAKTCAxNTkuNTI4MzQzIDI5NS40NTA5ODEgCkwgMTY0LjQ3MjMyMSAyOTUuNDY3MjkzIApMIDE3Mi43MTIyODQgMjk1LjE5MjkzOSAKTCAxNzcuNjU2MjYyIDI5NC44MzY4OTcgCkwgMTgyLjYwMDI0IDI5NC4yNzU3NjggCkwgMTkwLjg0MDIwMyAyOTMuMDY5Mzc3IApMIDE5NS43ODQxODEgMjkyLjIwNzAxNyAKTCAxOTkuMDgwMTY2IDI5MS40MTAyNyAKTCAyMDIuMzc2MTUxIDI5MC4zNjQ5MDMgCkwgMjA1LjY3MjEzNyAyODkuMDg5NjI3IApMIDIxMC42MTYxMTQgMjg2Ljg0MzQ0NyAKTCAyMTUuNTYwMDkyIDI4NC4zMTM1OCAKTCAyMTguODU2MDc4IDI4Mi40NjA5NzYgCkwgMjIyLjE1MjA2MyAyODAuNDA1Nzg1IApMIDIyNS40NDgwNDggMjc4LjEwMDM3NiAKTCAyMjguNzQ0MDMzIDI3NS40OTI4ODcgCkwgMjMwLjM5MjAyNiAyNzQuMDMxMDg0IApMIDIzMi4wNDAwMTggMjcyLjQyMDEzMyAKTCAyMzMuNjg4MDExIDI3MC42MTk4NzYgCkwgMjM1LjMzNjAwNCAyNjguNTkzMzUyIApMIDIzNi45ODM5OTYgMjY2LjMxNTU2MyAKTCAyMzguNjMxOTg5IDI2My43ODAwODYgCkwgMjQxLjkyNzk3NCAyNTguMDEwNTc2IApMIDI0NS4yMjM5NTkgMjUxLjU0ODYzNSAKTCAyNDguNTE5OTQ1IDI0NC41ODE0NjYgCkwgMjUxLjgxNTkzIDIzNi45MDYyNzggCkwgMjUzLjQ2MzkyMiAyMzIuNjQ0NCAKTCAyNTUuMTExOTE1IDIyOC4wMTg1NjMgCkwgMjU2Ljc1OTkwOCAyMjMuMDAxMTkyIApMIDI2MC4wNTU4OTMgMjExLjg1MjAxNCAKTCAyNjMuMzUxODc4IDE5OS40OTk3MTcgCkwgMjY2LjY0Nzg2MyAxODYuMjIyMDgzIApMIDI3MS41OTE4NDEgMTY1LjAxNzE5OCAKTCAyNzYuNTM1ODE5IDE0My42NTc1NTIgCkwgMjgxLjQ3OTc5NyAxMjMuNDI4NjY3IApMIDI4Ni40MjM3NzUgMTA0LjMzODcyOCAKTCAyODkuNzE5NzYgOTIuNjE0MjMxIApMIDI5My4wMTU3NDUgODIuMTkyNDgzIApMIDI5NC42NjM3MzggNzcuNTU1MDQ2IApMIDI5Ni4zMTE3MzEgNzMuMzI0OTA5IApMIDI5Ny45NTk3MjMgNjkuNTE1NDE1IApMIDI5OS42MDc3MTYgNjYuMTMxODI4IApMIDMwMS4yNTU3MDggNjMuMTY0MDI5IApMIDMwMi45MDM3MDEgNjAuNTg1NTkyIApMIDMwNC41NTE2OTQgNTguMzY2NDIxIApMIDMwNi4xOTk2ODYgNTYuNDk3MDA2IApMIDMwNy44NDc2NzkgNTUuMDEyMDE3IApMIDMwOS40OTU2NzEgNTMuOTk2OTU5IApMIDMxMS4xNDM2NjQgNTMuNTY4IApMIDMxMi43OTE2NTcgNTMuODI5NDEyIApMIDMxNC40Mzk2NDkgNTQuODI3MTUxIApMIDMxNi4wODc2NDIgNTYuNTIyMDA4IApMIDMxNy43MzU2MzUgNTguNzk3MzQzIApMIDMxOS4zODM2MjcgNjEuNDk4OTQ3IApMIDMyMi42Nzk2MTIgNjcuNjgxODQxIApMIDMyNS45NzU1OTggNzQuNjc4OTYxIApMIDMyNy42MjM1OSA3OC41NzM4MzMgCkwgMzI5LjI3MTU4MyA4Mi43OTQ0MDEgCkwgMzMwLjkxOTU3NSA4Ny4zNTk5MjIgCkwgMzM0LjIxNTU2MSA5Ny41Mjk2MjQgCkwgMzM3LjUxMTU0NiAxMDkuMTQ0NjExIApMIDM0MC44MDc1MzEgMTIyLjQwNTYxMyAKTCAzNDQuMTAzNTE2IDEzNy4yODkyMDEgCkwgMzUzLjk5MTQ3MiAxODQuMDg2OTQ0IApMIDM1OC45MzU0NSAyMDUuMjQyNjMxIApMIDM2My44Nzk0MjggMjI1LjQ0MDggCkwgMzY3LjE3NTQxMyAyMzguMTE4MDE0IApMIDM3MC40NzEzOTggMjQ5LjYzNDc0NSAKTCAzNzIuMTE5MzkxIDI1NC44NDIxMjcgCkwgMzczLjc2NzM4MyAyNTkuNjQ1OTQyIApMIDM3NS40MTUzNzYgMjY0LjAzMzcwMSAKTCAzNzcuMDYzMzY5IDI2OC4wMDE1NjEgCkwgMzc4LjcxMTM2MSAyNzEuNTUxMDUzIApMIDM4MC4zNTkzNTQgMjc0LjY4NTkxMSAKTCAzODIuMDA3MzQ3IDI3Ny40MDk2MjUgCkwgMzgzLjY1NTMzOSAyNzkuNzIzODI5IApMIDM4NS4zMDMzMzIgMjgxLjYyNjcyMSAKTCAzODYuOTUxMzI0IDI4My4xMDk3NTUgCkwgMzg4LjU5OTMxNyAyODQuMTUwMTI1IApMIDM5MC4yNDczMSAyODQuNjk1NjE3IApMIDM5MS44OTUzMDIgMjg0LjYzNTAyNyAKTCAzOTMuNTQzMjk1IDI4My43MzQ5NyAKTCAzOTUuMTkxMjg3IDI4MS40NzYwNDcgCkwgMzk2LjgzOTI4IDI3Ni40ODUzNTQgCkwgMzk4LjQ4NzI3MyAyNjMuMjkwMjk5IApMIDM5OC40ODcyNzMgMjYzLjI5MDI5OSAKIiBjbGlwLXBhdGg9InVybCgjcDVlNzAxMjA4NjMpIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMWY3N2I0OyBzdHJva2Utd2lkdGg6IDEuNTsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF8zIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDU3LjYgNDEuNDcyIAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzQiPgogICAgPHBhdGggZD0iTSA0MTQuNzIgMzA3LjU4NCAKTCA0MTQuNzIgNDEuNDcyIAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzUiPgogICAgPHBhdGggZD0iTSA1Ny42IDMwNy41ODQgCkwgNDE0LjcyIDMwNy41ODQgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNiI+CiAgICA8cGF0aCBkPSJNIDU3LjYgNDEuNDcyIApMIDQxNC43MiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogIDwvZz4KIDwvZz4KIDxkZWZzPgogIDxjbGlwUGF0aCBpZD0icDVlNzAxMjA4NjMiPgogICA8cmVjdCB4PSI1Ny42IiB5PSI0MS40NzIiIHdpZHRoPSIzNTcuMTIiIGhlaWdodD0iMjY2LjExMiIvPgogIDwvY2xpcFBhdGg+CiA8L2RlZnM+Cjwvc3ZnPgo=" alt="image" /></p>

<p>The approximate density is computed by smoothing out the discrete point
masses. The degree of smoothing is determined by a parameter called the
"bandwidth". (See <code><a href="#IDPModel.meanRDGpdf">IDPModel.meanRDGpdf</a></code> for details.) This bandwidth is
computed automatically. We can view the bandwidth that was used most
recently, and we can also set the bandwidth manually.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">bandwidth</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.11679260408842912</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">meanRDGpdf</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjQ2MC44cHQiIGhlaWdodD0iMzQ1LjZwdCIgdmlld0JveD0iMCAwIDQ2MC44IDM0NS42IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8bWV0YWRhdGE+CiAgPHJkZjpSREYgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICA8Y2M6V29yaz4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzpkYXRlPjIwMjUtMDEtMjZUMDg6Mzc6NDMuMTI3NDczPC9kYzpkYXRlPgogICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICA8ZGM6Y3JlYXRvcj4KICAgICA8Y2M6QWdlbnQ+CiAgICAgIDxkYzp0aXRsZT5NYXRwbG90bGliIHYzLjkuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy88L2RjOnRpdGxlPgogICAgIDwvY2M6QWdlbnQ+CiAgICA8L2RjOmNyZWF0b3I+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGRlZnM+CiAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4qe3N0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS1saW5lY2FwOiBidXR0fTwvc3R5bGU+CiA8L2RlZnM+CiA8ZyBpZD0iZmlndXJlXzEiPgogIDxnIGlkPSJwYXRjaF8xIj4KICAgPHBhdGggZD0iTSAwIDM0NS42IApMIDQ2MC44IDM0NS42IApMIDQ2MC44IDAgCkwgMCAwIAp6CiIgc3R5bGU9ImZpbGw6ICNmZmZmZmYiLz4KICA8L2c+CiAgPGcgaWQ9ImF4ZXNfMSI+CiAgIDxnIGlkPSJwYXRjaF8yIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCkwgNTcuNiA0MS40NzIgCnoKIiBzdHlsZT0iZmlsbDogI2ZmZmZmZiIvPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMSI+CiAgICA8ZyBpZD0ieHRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xIj4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibTUxZTFiMDVkNTciIGQ9Ik0gMCAwIApMIDAgMy41IAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNTFlMWIwNWQ1NyIgeD0iNzIuMTg0NzM1IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEiPgogICAgICA8IS0tIDAuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjQuMjMzMTcyIDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMCIgZD0iTSAyMDM0IDQyNTAgClEgMTU0NyA0MjUwIDEzMDEgMzc3MCAKUSAxMDU2IDMyOTEgMTA1NiAyMzI4IApRIDEwNTYgMTM2OSAxMzAxIDg4OSAKUSAxNTQ3IDQwOSAyMDM0IDQwOSAKUSAyNTI1IDQwOSAyNzcwIDg4OSAKUSAzMDE2IDEzNjkgMzAxNiAyMzI4IApRIDMwMTYgMzI5MSAyNzcwIDM3NzAgClEgMjUyNSA0MjUwIDIwMzQgNDI1MCAKegpNIDIwMzQgNDc1MCAKUSAyODE5IDQ3NTAgMzIzMyA0MTI5IApRIDM2NDcgMzUwOSAzNjQ3IDIzMjggClEgMzY0NyAxMTUwIDMyMzMgNTI5IApRIDI4MTkgLTkxIDIwMzQgLTkxIApRIDEyNTAgLTkxIDgzNiA1MjkgClEgNDIyIDExNTAgNDIyIDIzMjggClEgNDIyIDM1MDkgODM2IDQxMjkgClEgMTI1MCA0NzUwIDIwMzQgNDc1MCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMmUiIGQ9Ik0gNjg0IDc5NCAKTCAxMzQ0IDc5NCAKTCAxMzQ0IDAgCkwgNjg0IDAgCkwgNjg0IDc5NCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inh0aWNrXzIiPgogICAgIDxnIGlkPSJsaW5lMmRfMiI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTUxZTFiMDVkNTciIHg9IjEzNy43NzQ4NDEiIHk9IjMwNy41ODQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMiI+CiAgICAgIDwhLS0gMC4yIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMjkuODIzMjc4IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMiIgZD0iTSAxMjI4IDUzMSAKTCAzNDMxIDUzMSAKTCAzNDMxIDAgCkwgNDY5IDAgCkwgNDY5IDUzMSAKUSA4MjggOTAzIDE0NDggMTUyOSAKUSAyMDY5IDIxNTYgMjIyOCAyMzM4IApRIDI1MzEgMjY3OCAyNjUxIDI5MTQgClEgMjc3MiAzMTUwIDI3NzIgMzM3OCAKUSAyNzcyIDM3NTAgMjUxMSAzOTg0IApRIDIyNTAgNDIxOSAxODMxIDQyMTkgClEgMTUzNCA0MjE5IDEyMDQgNDExNiAKUSA4NzUgNDAxMyA1MDAgMzgwMyAKTCA1MDAgNDQ0MSAKUSA4ODEgNDU5NCAxMjEyIDQ2NzIgClEgMTU0NCA0NzUwIDE4MTkgNDc1MCAKUSAyNTQ0IDQ3NTAgMjk3NSA0Mzg3IApRIDM0MDYgNDAyNSAzNDA2IDM0MTkgClEgMzQwNiAzMTMxIDMyOTggMjg3MyAKUSAzMTkxIDI2MTYgMjkwNiAyMjY2IApRIDI4MjggMjE3NSAyNDA5IDE3NDIgClEgMTk5MSAxMzA5IDEyMjggNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF8zIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNTFlMWIwNWQ1NyIgeD0iMjAzLjM2NDk0NyIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8zIj4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5NS40MTMzODQgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM0IiBkPSJNIDI0MTkgNDExNiAKTCA4MjUgMTYyNSAKTCAyNDE5IDE2MjUgCkwgMjQxOSA0MTE2IAp6Ck0gMjI1MyA0NjY2IApMIDMwNDcgNDY2NiAKTCAzMDQ3IDE2MjUgCkwgMzcxMyAxNjI1IApMIDM3MTMgMTEwMCAKTCAzMDQ3IDExMDAgCkwgMzA0NyAwIApMIDI0MTkgMCAKTCAyNDE5IDExMDAgCkwgMzEzIDExMDAgCkwgMzEzIDE3MDkgCkwgMjI1MyA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF80Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNTFlMWIwNWQ1NyIgeD0iMjY4Ljk1NTA1MyIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF80Ij4KICAgICAgPCEtLSAwLjYgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MS4wMDM0OTEgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM2IiBkPSJNIDIxMTMgMjU4NCAKUSAxNjg4IDI1ODQgMTQzOSAyMjkzIApRIDExOTEgMjAwMyAxMTkxIDE0OTcgClEgMTE5MSA5OTQgMTQzOSA3MDEgClEgMTY4OCA0MDkgMjExMyA0MDkgClEgMjUzOCA0MDkgMjc4NiA3MDEgClEgMzAzNCA5OTQgMzAzNCAxNDk3IApRIDMwMzQgMjAwMyAyNzg2IDIyOTMgClEgMjUzOCAyNTg0IDIxMTMgMjU4NCAKegpNIDMzNjYgNDU2MyAKTCAzMzY2IDM5ODggClEgMzEyOCA0MTAwIDI4ODYgNDE1OSAKUSAyNjQ0IDQyMTkgMjQwNiA0MjE5IApRIDE3ODEgNDIxOSAxNDUxIDM3OTcgClEgMTEyMiAzMzc1IDEwNzUgMjUyMiAKUSAxMjU5IDI3OTQgMTUzNyAyOTM5IApRIDE4MTYgMzA4NCAyMTUwIDMwODQgClEgMjg1MyAzMDg0IDMyNjEgMjY1NyAKUSAzNjY5IDIyMzEgMzY2OSAxNDk3IApRIDM2NjkgNzc4IDMyNDQgMzQzIApRIDI4MTkgLTkxIDIxMTMgLTkxIApRIDEzMDMgLTkxIDg3NSA1MjkgClEgNDQ3IDExNTAgNDQ3IDIzMjggClEgNDQ3IDM0MzQgOTcyIDQwOTIgClEgMTQ5NyA0NzUwIDIzODEgNDc1MCAKUSAyNjE5IDQ3NTAgMjg2MSA0NzAzIApRIDMxMDMgNDY1NiAzMzY2IDQ1NjMgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM2IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201MWUxYjA1ZDU3IiB4PSIzMzQuNTQ1MTU5IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzUiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzI2LjU5MzU5NyAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzgiIGQ9Ik0gMjAzNCAyMjE2IApRIDE1ODQgMjIxNiAxMzI2IDE5NzUgClEgMTA2OSAxNzM0IDEwNjkgMTMxMyAKUSAxMDY5IDg5MSAxMzI2IDY1MCAKUSAxNTg0IDQwOSAyMDM0IDQwOSAKUSAyNDg0IDQwOSAyNzQzIDY1MSAKUSAzMDAzIDg5NCAzMDAzIDEzMTMgClEgMzAwMyAxNzM0IDI3NDUgMTk3NSAKUSAyNDg4IDIyMTYgMjAzNCAyMjE2IAp6Ck0gMTQwMyAyNDg0IApRIDk5NyAyNTg0IDc3MCAyODYyIApRIDU0NCAzMTQxIDU0NCAzNTQxIApRIDU0NCA0MTAwIDk0MiA0NDI1IApRIDEzNDEgNDc1MCAyMDM0IDQ3NTAgClEgMjczMSA0NzUwIDMxMjggNDQyNSAKUSAzNTI1IDQxMDAgMzUyNSAzNTQxIApRIDM1MjUgMzE0MSAzMjk4IDI4NjIgClEgMzA3MiAyNTg0IDI2NjkgMjQ4NCAKUSAzMTI1IDIzNzggMzM3OSAyMDY4IApRIDM2MzQgMTc1OSAzNjM0IDEzMTMgClEgMzYzNCA2MzQgMzIyMCAyNzEgClEgMjgwNiAtOTEgMjAzNCAtOTEgClEgMTI2MyAtOTEgODQ4IDI3MSAKUSA0MzQgNjM0IDQzNCAxMzEzIApRIDQzNCAxNzU5IDY5MCAyMDY4IApRIDk0NyAyMzc4IDE0MDMgMjQ4NCAKegpNIDExNzIgMzQ4MSAKUSAxMTcyIDMxMTkgMTM5OCAyOTE2IApRIDE2MjUgMjcxMyAyMDM0IDI3MTMgClEgMjQ0MSAyNzEzIDI2NzAgMjkxNiAKUSAyOTAwIDMxMTkgMjkwMCAzNDgxIApRIDI5MDAgMzg0NCAyNjcwIDQwNDcgClEgMjQ0MSA0MjUwIDIwMzQgNDI1MCAKUSAxNjI1IDQyNTAgMTM5OCA0MDQ3IApRIDExNzIgMzg0NCAxMTcyIDM0ODEgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM4IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzYiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201MWUxYjA1ZDU3IiB4PSI0MDAuMTM1MjY1IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzYiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkyLjE4MzcwMyAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzEiIGQ9Ik0gNzk0IDUzMSAKTCAxODI1IDUzMSAKTCAxODI1IDQwOTEgCkwgNzAzIDM4NjYgCkwgNzAzIDQ0NDEgCkwgMTgxOSA0NjY2IApMIDI0NTAgNDY2NiAKTCAyNDUwIDUzMSAKTCAzNDgxIDUzMSAKTCAzNDgxIDAgCkwgNzk0IDAgCkwgNzk0IDUzMSAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMxIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMiI+CiAgICA8ZyBpZD0ieXRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF83Ij4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibTU0N2E4MzM1MjIiIGQ9Ik0gMCAwIApMIC0zLjUgMCAKIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2RlZnM+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTU0N2E4MzM1MjIiIHg9IjU3LjYiIHk9IjMwNC4yNzU2NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF83Ij4KICAgICAgPCEtLSAwLjAgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAzMDguMDc0ODU4KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18yIj4KICAgICA8ZyBpZD0ibGluZTJkXzgiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201NDdhODMzNTIyIiB4PSI1Ny42IiB5PSIyNzMuMzY3MzgiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfOCI+CiAgICAgIDwhLS0gMC41IC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNC42OTY4NzUgMjc3LjE2NjU5OSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM1IiBkPSJNIDY5MSA0NjY2IApMIDMxNjkgNDY2NiAKTCAzMTY5IDQxMzQgCkwgMTI2OSA0MTM0IApMIDEyNjkgMjk5MSAKUSAxNDA2IDMwMzggMTU0MyAzMDYxIApRIDE2ODEgMzA4NCAxODE5IDMwODQgClEgMjYwMCAzMDg0IDMwNTYgMjY1NiAKUSAzNTEzIDIyMjggMzUxMyAxNDk3IApRIDM1MTMgNzQ0IDMwNDQgMzI2IApRIDI1NzUgLTkxIDE3MjIgLTkxIApRIDE0MjggLTkxIDExMjMgLTQxIApRIDgxOSA5IDQ5NCAxMDkgCkwgNDk0IDc0NCAKUSA3NzUgNTkxIDEwNzUgNTE2IApRIDEzNzUgNDQxIDE3MDkgNDQxIApRIDIyNTAgNDQxIDI1NjUgNzI1IApRIDI4ODEgMTAwOSAyODgxIDE0OTcgClEgMjg4MSAxOTg0IDI1NjUgMjI2OCAKUSAyMjUwIDI1NTMgMTcwOSAyNTUzIApRIDE0NTYgMjU1MyAxMjA0IDI0OTcgClEgOTUzIDI0NDEgNjkxIDIzMjIgCkwgNjkxIDQ2NjYgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM1IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18zIj4KICAgICA8ZyBpZD0ibGluZTJkXzkiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201NDdhODMzNTIyIiB4PSI1Ny42IiB5PSIyNDIuNDU5MTIxIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzkiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDI0Ni4yNTgzNCkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xMCI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTU0N2E4MzM1MjIiIHg9IjU3LjYiIHk9IjIxMS41NTA4NjEiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTAiPgogICAgICA8IS0tIDEuNSAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDIxNS4zNTAwOCkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNSIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfNSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xMSI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTU0N2E4MzM1MjIiIHg9IjU3LjYiIHk9IjE4MC42NDI2MDIiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTEiPgogICAgICA8IS0tIDIuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDE4NC40NDE4MjEpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMyIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inl0aWNrXzYiPgogICAgIDxnIGlkPSJsaW5lMmRfMTIiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201NDdhODMzNTIyIiB4PSI1Ny42IiB5PSIxNDkuNzM0MzQzIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEyIj4KICAgICAgPCEtLSAyLjUgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAxNTMuNTMzNTYyKSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM1IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja183Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEzIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNTQ3YTgzMzUyMiIgeD0iNTcuNiIgeT0iMTE4LjgyNjA4MyIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8xMyI+CiAgICAgIDwhLS0gMy4wIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNC42OTY4NzUgMTIyLjYyNTMwMikgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTMzIiBkPSJNIDI1OTcgMjUxNiAKUSAzMDUwIDI0MTkgMzMwNCAyMTEyIApRIDM1NTkgMTgwNiAzNTU5IDEzNTYgClEgMzU1OSA2NjYgMzA4NCAyODcgClEgMjYwOSAtOTEgMTczNCAtOTEgClEgMTQ0MSAtOTEgMTEzMCAtMzMgClEgODE5IDI1IDQ4OCAxNDEgCkwgNDg4IDc1MCAKUSA3NTAgNTk3IDEwNjIgNTE5IApRIDEzNzUgNDQxIDE3MTYgNDQxIApRIDIzMDkgNDQxIDI2MjAgNjc1IApRIDI5MzEgOTA5IDI5MzEgMTM1NiAKUSAyOTMxIDE3NjkgMjY0MiAyMDAxIApRIDIzNTMgMjIzNCAxODM4IDIyMzQgCkwgMTI5NCAyMjM0IApMIDEyOTQgMjc1MyAKTCAxODYzIDI3NTMgClEgMjMyOCAyNzUzIDI1NzUgMjkzOSAKUSAyODIyIDMxMjUgMjgyMiAzNDc1IApRIDI4MjIgMzgzNCAyNTY3IDQwMjYgClEgMjMxMyA0MjE5IDE4MzggNDIxOSAKUSAxNTc4IDQyMTkgMTI4MSA0MTYyIApRIDk4NCA0MTA2IDYyOCAzOTg4IApMIDYyOCA0NTUwIApRIDk4OCA0NjUwIDEzMDIgNDcwMCAKUSAxNjE2IDQ3NTAgMTg5NCA0NzUwIApRIDI2MTMgNDc1MCAzMDMxIDQ0MjMgClEgMzQ1MCA0MDk3IDM0NTAgMzU0MSAKUSAzNDUwIDMxNTMgMzIyOCAyODg2IApRIDMwMDYgMjYxOSAyNTk3IDI1MTYgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja184Ij4KICAgICA8ZyBpZD0ibGluZTJkXzE0Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNTQ3YTgzMzUyMiIgeD0iNTcuNiIgeT0iODcuOTE3ODI0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzE0Ij4KICAgICAgPCEtLSAzLjUgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSA5MS43MTcwNDMpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMzIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzUiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inl0aWNrXzkiPgogICAgIDxnIGlkPSJsaW5lMmRfMTUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI201NDdhODMzNTIyIiB4PSI1Ny42IiB5PSI1Ny4wMDk1NjUiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTUiPgogICAgICA8IS0tIDQuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDYwLjgwODc4NCkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzQiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9ImxpbmUyZF8xNiI+CiAgICA8cGF0aCBkPSJNIDczLjgzMjcyNyAyNjguMDM4NTc5IApMIDc1LjQ4MDcyIDI3NC44MzYxMDUgCkwgNzcuMTI4NzEzIDI3OS4yMjQ5MzcgCkwgNzguNzc2NzA1IDI4Mi4yOTc4NjQgCkwgODAuNDI0Njk4IDI3NS43Nzg1ODQgCkwgODIuMDcyNjkgMjcxLjM3Nzc4NyAKTCA4My43MjA2ODMgMjg2Ljk3NTc5NyAKTCA4NS4zNjg2NzYgMjg3LjM5OTYyNCAKTCA4Ny4wMTY2NjggMjg4LjAzNzgyMyAKTCA4OC42NjQ2NjEgMjg3LjUzNjA5MiAKTCA5MC4zMTI2NTMgMjg2LjgwOTI1NSAKTCA5MS45NjA2NDYgMjg3LjYyODg4NSAKTCA5My42MDg2MzkgMjc4LjczODUyOSAKTCA5NS4yNTY2MzEgMjg5LjQ4MjE4IApMIDk2LjkwNDYyNCAyODguNzI3MDQ4IApMIDk4LjU1MjYxNyAyODcuNDkzOTQgCkwgMTAwLjIwMDYwOSAyODguMTI3MyAKTCAxMDEuODQ4NjAyIDI4Mi4wMjE1NzYgCkwgMTAzLjQ5NjU5NCAyODYuNTIzMTU1IApMIDEwNS4xNDQ1ODcgMjg5LjQ5MzU5OCAKTCAxMDYuNzkyNTggMjc3LjUxMzcyIApMIDEwOC40NDA1NzIgMjg2Ljk1MzU1NyAKTCAxMTAuMDg4NTY1IDI3OS43ODE1NjggCkwgMTExLjczNjU1NyAyOTIuNTg5MzY3IApMIDExMy4zODQ1NSAyODcuODAyMzQzIApMIDExNS4wMzI1NDMgMjg2LjE2NTE1MSAKTCAxMTYuNjgwNTM1IDI5Mi4yODI3NSAKTCAxMTguMzI4NTI4IDI5MC44MTAwMjMgCkwgMTE5Ljk3NjUyMSAyOTIuOTk2NjIzIApMIDEyMS42MjQ1MTMgMjg2LjA5OTIzOSAKTCAxMjMuMjcyNTA2IDI4NC44NDkzMjMgCkwgMTI0LjkyMDQ5OCAyODguNzc5NzU1IApMIDEyNi41Njg0OTEgMjg4LjYzMTM0MyAKTCAxMjguMjE2NDg0IDI4NS40NDgxOSAKTCAxMjkuODY0NDc2IDI5MC4xODkxNzUgCkwgMTMxLjUxMjQ2OSAyODguODgyODI3IApMIDEzMy4xNjA0NjEgMjkwLjMzODg5IApMIDEzNC44MDg0NTQgMjg3LjYxMzUwOCAKTCAxMzYuNDU2NDQ3IDI5MC42NjEwNjUgCkwgMTM4LjEwNDQzOSAyOTAuOTMyNzg4IApMIDEzOS43NTI0MzIgMjg1LjU2NjQyNyAKTCAxNDEuNDAwNDI1IDI4OS45MTUwNDIgCkwgMTQzLjA0ODQxNyAyODguNzE0NzM5IApMIDE0NC42OTY0MSAyODAuMTQyODkyIApMIDE0Ni4zNDQ0MDIgMjkxLjcxMzE4OCAKTCAxNDcuOTkyMzk1IDI4NC40MDI1ODcgCkwgMTQ5LjY0MDM4OCAyOTAuMTI1MjIxIApMIDE1MS4yODgzOCAyODQuMzg0NDI5IApMIDE1Mi45MzYzNzMgMjc5Ljc3MDAwNiAKTCAxNTQuNTg0MzY1IDI4OC40NTcyMjIgCkwgMTU2LjIzMjM1OCAyOTMuNzc4MDY1IApMIDE1Ny44ODAzNTEgMjkyLjkxNTE0OSAKTCAxNTkuNTI4MzQzIDI4Ni4zOTI3NzggCkwgMTYxLjE3NjMzNiAyODQuMjUzNDkzIApMIDE2Mi44MjQzMjkgMjg3LjIyMjg3NSAKTCAxNjQuNDcyMzIxIDI5MC43OTk2NzIgCkwgMTY2LjEyMDMxNCAyOTIuMjE3NjY4IApMIDE2Ny43NjgzMDYgMjg1LjY4MDYyNSAKTCAxNjkuNDE2Mjk5IDI5MC43NjAyMzggCkwgMTcxLjA2NDI5MiAyOTQuMTkxMTIzIApMIDE3Mi43MTIyODQgMjgyLjQ1NDk3MiAKTCAxNzQuMzYwMjc3IDI4OS40MTA5ODkgCkwgMTc2LjAwODI2OSAyOTEuNDU3MDE3IApMIDE3Ny42NTYyNjIgMjg3LjkzNDU1NCAKTCAxNzkuMzA0MjU1IDI4OS43OTY4NDggCkwgMTgwLjk1MjI0NyAyOTMuNzExODkyIApMIDE4Mi42MDAyNCAyODUuMTYxMzE3IApMIDE4NC4yNDgyMzMgMjk0LjQyNzIyNyAKTCAxODUuODk2MjI1IDI5NS40ODggCkwgMTg5LjE5MjIxIDI4Ni42NTg5OCAKTCAxOTAuODQwMjAzIDI5NC4wMzc4MTYgCkwgMTkyLjQ4ODE5NiAyODUuNTc1MjA1IApMIDE5NC4xMzYxODggMjgzLjQ3MTQ2NSAKTCAxOTUuNzg0MTgxIDI4OS4xOTg4ODYgCkwgMTk3LjQzMjE3NCAyOTMuNDYxMDE2IApMIDIwMC43MjgxNTkgMjc4LjQ2NDcyNyAKTCAyMDIuMzc2MTUxIDI4NS4yMjM5MDUgCkwgMjA0LjAyNDE0NCAyODguMDc0MTIyIApMIDIwNS42NzIxMzcgMjg4LjQxNTk1MyAKTCAyMDcuMzIwMTI5IDI3NC45OTY1OTkgCkwgMjA4Ljk2ODEyMiAyODIuMTAwMTEzIApMIDIxMC42MTYxMTQgMjc2LjE3MTYzNyAKTCAyMTIuMjY0MTA3IDI5My4wMzY5MjIgCkwgMjE1LjU2MDA5MiAyODIuNzE4NzE0IApMIDIxNy4yMDgwODUgMjc0LjUzMjgzIApMIDIxOC44NTYwNzggMjg3Ljg5NDE1NyAKTCAyMjAuNTA0MDcgMjc4LjI4MjIxNCAKTCAyMjIuMTUyMDYzIDI4My4xNDQ4OTYgCkwgMjIzLjgwMDA1NSAyODMuMjc4MzQ2IApMIDIyNS40NDgwNDggMjc2Ljk1NDY5NSAKTCAyMjcuMDk2MDQxIDI2OC40Mjc0MDMgCkwgMjI4Ljc0NDAzMyAyNzYuODg3NDg2IApMIDIzMC4zOTIwMjYgMjY1LjU1MTc2MSAKTCAyMzIuMDQwMDE4IDI3Ni4wNjI5NTQgCkwgMjMzLjY4ODAxMSAyODMuNjU0NzY3IApMIDIzNS4zMzYwMDQgMjY5Ljc3OTcwMSAKTCAyMzYuOTgzOTk2IDI3OC43NTgxODMgCkwgMjM4LjYzMTk4OSAyNjMuNzIwMjc1IApMIDI0MC4yNzk5ODIgMjYxLjg3Mjc5OCAKTCAyNDEuOTI3OTc0IDI1Mi4zOTcxNSAKTCAyNDMuNTc1OTY3IDI1My44Mjg4NjcgCkwgMjQ1LjIyMzk1OSAyNDQuNjEwNzQgCkwgMjQ2Ljg3MTk1MiAyODIuNTc2NDUzIApMIDI0OC41MTk5NDUgMjIxLjg2Njk0NyAKTCAyNTAuMTY3OTM3IDI0NS45MDA2MTUgCkwgMjUxLjgxNTkzIDIyNi4wNDMyMTggCkwgMjUzLjQ2MzkyMiAyNTguOTkwODM1IApMIDI1NS4xMTE5MTUgMjEwLjIzMzMzMyAKTCAyNTYuNzU5OTA4IDIyNC4wOTUxNjQgCkwgMjU4LjQwNzkgMjE5LjAxODc0MSAKTCAyNjAuMDU1ODkzIDI2My43MDAwNTQgCkwgMjYxLjcwMzg4NiAyMTIuMzY4OTc5IApMIDI2My4zNTE4NzggMjEzLjAyOTMwMSAKTCAyNjQuOTk5ODcxIDIwMy40MjM0OTYgCkwgMjY2LjY0Nzg2MyAyMTEuMTQ5MDg3IApMIDI2OC4yOTU4NTYgMTUyLjY4NTE4MiAKTCAyNjkuOTQzODQ5IDI2OC42NjYzNjUgCkwgMjcxLjU5MTg0MSAyNzIuNjUwMDIzIApMIDI3NC44ODc4MjYgMTM3LjA4NjAxMSAKTCAyNzYuNTM1ODE5IDIzNS4wNjU3MzQgCkwgMjc4LjE4MzgxMiAyMDAuNzA5NzM3IApMIDI3OS44MzE4MDQgMTQyLjI1MDg3MiAKTCAyODEuNDc5Nzk3IDIwMi4zNDI3MDQgCkwgMjgzLjEyNzc5IDE5NS42Njk0MzEgCkwgMjg0Ljc3NTc4MiAxOTIuNDI4NzMzIApMIDI4Ni40MjM3NzUgMTgwLjI2ODUwNyAKTCAyODguMDcxNzY3IDE1OC43NTA4MTMgCkwgMjg5LjcxOTc2IDEwMi4zNTYyNSAKTCAyOTEuMzY3NzUzIDE0Mi41MDUyMzcgCkwgMjkzLjAxNTc0NSAxMjkuNDI4ODQ3IApMIDI5NC42NjM3MzggMTY0LjkyMjI1OSAKTCAyOTYuMzExNzMxIDk5LjE5NDI2NCAKTCAyOTcuOTU5NzIzIDExOC44Mzc0NSAKTCAyOTkuNjA3NzE2IDE0MC4yMzk0MDggCkwgMzAxLjI1NTcwOCAxNDQuMDc0MjQ2IApMIDMwMi45MDM3MDEgNjQuNjY3OTYzIApMIDMwNC41NTE2OTQgMTg2LjA3NjA2NyAKTCAzMDYuMTk5Njg2IDEwMC40ODc4MzYgCkwgMzA3Ljg0NzY3OSAxNDkuNDMxMjY0IApMIDMwOS40OTU2NzEgMTU3LjcyMzc4NSAKTCAzMTEuMTQzNjY0IDE1OC44Njc3NjMgCkwgMzEyLjc5MTY1NyA3Ni41NjI1MjMgCkwgMzE0LjQzOTY0OSA5My4zMzQyNDggCkwgMzE2LjA4NzY0MiA5MC4zNDIzNzggCkwgMzE3LjczNTYzNSAxOTYuODQ2MDM4IApMIDMxOS4zODM2MjcgMTQ0LjUxNzU1OCAKTCAzMjEuMDMxNjIgNjUuNTQ0Mjc2IApMIDMyMi42Nzk2MTIgMTY5Ljk5MDI1IApMIDMyNC4zMjc2MDUgMTcxLjA3NjcyNiAKTCAzMjUuOTc1NTk4IDE3Ny44NTk1OTcgCkwgMzI3LjYyMzU5IDUzLjU2OCAKTCAzMjkuMjcxNTgzIDEyMC41NDEzMDUgCkwgMzMwLjkxOTU3NSAxMzIuNTY2ODE4IApMIDMzMi41Njc1NjggMTM0LjA2NTMyMiAKTCAzMzQuMjE1NTYxIDIyMi41NzcxODMgCkwgMzM1Ljg2MzU1MyAxNTkuOTkyNzg5IApMIDMzNy41MTE1NDYgMTYyLjc4NjIzMiAKTCAzMzkuMTU5NTM5IDE5My44NjcwNTEgCkwgMzQwLjgwNzUzMSAxNDEuMTQxNDUgCkwgMzQyLjQ1NTUyNCAxNDUuNDEzNzM2IApMIDM0NC4xMDM1MTYgMjAwLjg3NjM1NyAKTCAzNDUuNzUxNTA5IDIwMi42ODM2NDEgCkwgMzQ3LjM5OTUwMiAyMDguNzE4MTU5IApMIDM0OS4wNDc0OTQgMjEyLjkxMDk4MiAKTCAzNTAuNjk1NDg3IDIxMy41ODA1NDUgCkwgMzUyLjM0MzQ3OSAxOTAuMzM0MDE3IApMIDM1My45OTE0NzIgMjUyLjUyNDI4NyAKTCAzNTUuNjM5NDY1IDIxNy40NjI4MTcgCkwgMzU3LjI4NzQ1NyAxODcuNTI2NTIyIApMIDM1OC45MzU0NSAyMjIuNTk4MjM2IApMIDM2MC41ODM0NDMgMjIxLjIxNDcwNCAKTCAzNjIuMjMxNDM1IDI1My4wMzUyMjQgCkwgMzYzLjg3OTQyOCAyNTcuOTgxOTU1IApMIDM2NS41Mjc0MiAyMzkuMzAyMTk5IApMIDM2Ny4xNzU0MTMgMjUwLjY2MzU5OCAKTCAzNjguODIzNDA2IDI0OC4wNjIzMzIgCkwgMzcwLjQ3MTM5OCAyNTYuNDczMzczIApMIDM3Mi4xMTkzOTEgMjUzLjk4MDM3NiAKTCAzNzMuNzY3MzgzIDI3MC43OTYwMjYgCkwgMzc1LjQxNTM3NiAyNzIuOTA0MTAyIApMIDM3Ny4wNjMzNjkgMjY5LjA2NjI0OSAKTCAzNzguNzExMzYxIDI3NC42NDY4NzkgCkwgMzgwLjM1OTM1NCAyODEuNDU0NzgyIApMIDM4Mi4wMDczNDcgMjczLjc3NTg4OCAKTCAzODMuNjU1MzM5IDI4Mi4xMzAzOTYgCkwgMzg1LjMwMzMzMiAyODAuNjc1NTM4IApMIDM4Ni45NTEzMjQgMjgzLjc0NDc2NSAKTCAzODguNTk5MzE3IDI4NC4wMzA0NzkgCkwgMzkwLjI0NzMxIDI4NC45MDA5MTEgCkwgMzkxLjg5NTMwMiAyODEuNDkyNDQ2IApMIDM5My41NDMyOTUgMjgzLjUzNDE2MSAKTCAzOTUuMTkxMjg3IDI3OC4zNTYxNjYgCkwgMzk2LjgzOTI4IDI3My45NzQ0NDYgCkwgMzk4LjQ4NzI3MyAyNjcuMzMyMDU0IApMIDM5OC40ODcyNzMgMjY3LjMzMjA1NCAKIiBjbGlwLXBhdGg9InVybCgjcGM3Mzk1ODFmOWIpIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMWY3N2I0OyBzdHJva2Utd2lkdGg6IDEuNTsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF8zIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDU3LjYgNDEuNDcyIAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzQiPgogICAgPHBhdGggZD0iTSA0MTQuNzIgMzA3LjU4NCAKTCA0MTQuNzIgNDEuNDcyIAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzUiPgogICAgPHBhdGggZD0iTSA1Ny42IDMwNy41ODQgCkwgNDE0LjcyIDMwNy41ODQgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNiI+CiAgICA8cGF0aCBkPSJNIDU3LjYgNDEuNDcyIApMIDQxNC43MiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogIDwvZz4KIDwvZz4KIDxkZWZzPgogIDxjbGlwUGF0aCBpZD0icGM3Mzk1ODFmOWIiPgogICA8cmVjdCB4PSI1Ny42IiB5PSI0MS40NzIiIHdpZHRoPSIzNTcuMTIiIGhlaWdodD0iMjY2LjExMiIvPgogIDwvY2xpcFBhdGg+CiA8L2RlZnM+Cjwvc3ZnPgo=" alt="image" /></p>

<h2 id="flipping-thumbtacks">Flipping thumbtacks</h2>

<p>Imagine a box of 320 thumbtacks. We flick each thumbtack 9 times. If it
lands point up, we call it a success. Point down is a failure. Because
of the imperfections, each thumbtack has its own probability of success.
The file, <code>tacks.csv</code>, contains the success and failure counts for this
experiment. The data in <code>tacks.csv</code> is exactly the data considered in
<a href="https://doi.org/10.1214/aos/1032526949">Liu 1996</a>. (This data
originally came from an experiment by Beckett and Diaconis in 1994. In
the original experiment, there were not 320 thumbtacks. Rather, there
were 16 thumbtacks, 2 flickers, and 10 surfaces.)</p>

<p>To study this situation, we first create the model and perform 10,000
simulations. We then look at the approximate density of the posterior
probability of success.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">csv</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;tacks.csv&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">sheet</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="o">...</span>     <span class="n">rowCounts</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sheet</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span> <span class="o">=</span> <span class="n">IDPModel</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">addWeightedSims</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="c1"># took ~3m on a Macbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">meanRDGpdf</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">bandwidth</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.11170697606064083</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjQ2MC44cHQiIGhlaWdodD0iMzQ1LjZwdCIgdmlld0JveD0iMCAwIDQ2MC44IDM0NS42IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8bWV0YWRhdGE+CiAgPHJkZjpSREYgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICA8Y2M6V29yaz4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzpkYXRlPjIwMjUtMDEtMjZUMDg6NTc6MDguMTI2MDAwPC9kYzpkYXRlPgogICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICA8ZGM6Y3JlYXRvcj4KICAgICA8Y2M6QWdlbnQ+CiAgICAgIDxkYzp0aXRsZT5NYXRwbG90bGliIHYzLjkuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy88L2RjOnRpdGxlPgogICAgIDwvY2M6QWdlbnQ+CiAgICA8L2RjOmNyZWF0b3I+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGRlZnM+CiAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4qe3N0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS1saW5lY2FwOiBidXR0fTwvc3R5bGU+CiA8L2RlZnM+CiA8ZyBpZD0iZmlndXJlXzEiPgogIDxnIGlkPSJwYXRjaF8xIj4KICAgPHBhdGggZD0iTSAwIDM0NS42IApMIDQ2MC44IDM0NS42IApMIDQ2MC44IDAgCkwgMCAwIAp6CiIgc3R5bGU9ImZpbGw6ICNmZmZmZmYiLz4KICA8L2c+CiAgPGcgaWQ9ImF4ZXNfMSI+CiAgIDxnIGlkPSJwYXRjaF8yIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCkwgNTcuNiA0MS40NzIgCnoKIiBzdHlsZT0iZmlsbDogI2ZmZmZmZiIvPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMSI+CiAgICA8ZyBpZD0ieHRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xIj4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibTg2ZThiNTUxMGIiIGQ9Ik0gMCAwIApMIDAgMy41IAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtODZlOGI1NTEwYiIgeD0iNzMuODMyNzI3IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEiPgogICAgICA8IS0tIDAuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjUuODgxMTY1IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMCIgZD0iTSAyMDM0IDQyNTAgClEgMTU0NyA0MjUwIDEzMDEgMzc3MCAKUSAxMDU2IDMyOTEgMTA1NiAyMzI4IApRIDEwNTYgMTM2OSAxMzAxIDg4OSAKUSAxNTQ3IDQwOSAyMDM0IDQwOSAKUSAyNTI1IDQwOSAyNzcwIDg4OSAKUSAzMDE2IDEzNjkgMzAxNiAyMzI4IApRIDMwMTYgMzI5MSAyNzcwIDM3NzAgClEgMjUyNSA0MjUwIDIwMzQgNDI1MCAKegpNIDIwMzQgNDc1MCAKUSAyODE5IDQ3NTAgMzIzMyA0MTI5IApRIDM2NDcgMzUwOSAzNjQ3IDIzMjggClEgMzY0NyAxMTUwIDMyMzMgNTI5IApRIDI4MTkgLTkxIDIwMzQgLTkxIApRIDEyNTAgLTkxIDgzNiA1MjkgClEgNDIyIDExNTAgNDIyIDIzMjggClEgNDIyIDM1MDkgODM2IDQxMjkgClEgMTI1MCA0NzUwIDIwMzQgNDc1MCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMmUiIGQ9Ik0gNjg0IDc5NCAKTCAxMzQ0IDc5NCAKTCAxMzQ0IDAgCkwgNjg0IDAgCkwgNjg0IDc5NCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inh0aWNrXzIiPgogICAgIDxnIGlkPSJsaW5lMmRfMiI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTg2ZThiNTUxMGIiIHg9IjEzOC43NjM2MzYiIHk9IjMwNy41ODQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMiI+CiAgICAgIDwhLS0gMC4yIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzAuODEyMDc0IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMiIgZD0iTSAxMjI4IDUzMSAKTCAzNDMxIDUzMSAKTCAzNDMxIDAgCkwgNDY5IDAgCkwgNDY5IDUzMSAKUSA4MjggOTAzIDE0NDggMTUyOSAKUSAyMDY5IDIxNTYgMjIyOCAyMzM4IApRIDI1MzEgMjY3OCAyNjUxIDI5MTQgClEgMjc3MiAzMTUwIDI3NzIgMzM3OCAKUSAyNzcyIDM3NTAgMjUxMSAzOTg0IApRIDIyNTAgNDIxOSAxODMxIDQyMTkgClEgMTUzNCA0MjE5IDEyMDQgNDExNiAKUSA4NzUgNDAxMyA1MDAgMzgwMyAKTCA1MDAgNDQ0MSAKUSA4ODEgNDU5NCAxMjEyIDQ2NzIgClEgMTU0NCA0NzUwIDE4MTkgNDc1MCAKUSAyNTQ0IDQ3NTAgMjk3NSA0Mzg3IApRIDM0MDYgNDAyNSAzNDA2IDM0MTkgClEgMzQwNiAzMTMxIDMyOTggMjg3MyAKUSAzMTkxIDI2MTYgMjkwNiAyMjY2IApRIDI4MjggMjE3NSAyNDA5IDE3NDIgClEgMTk5MSAxMzA5IDEyMjggNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF8zIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtODZlOGI1NTEwYiIgeD0iMjAzLjY5NDU0NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8zIj4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5NS43NDI5ODMgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM0IiBkPSJNIDI0MTkgNDExNiAKTCA4MjUgMTYyNSAKTCAyNDE5IDE2MjUgCkwgMjQxOSA0MTE2IAp6Ck0gMjI1MyA0NjY2IApMIDMwNDcgNDY2NiAKTCAzMDQ3IDE2MjUgCkwgMzcxMyAxNjI1IApMIDM3MTMgMTEwMCAKTCAzMDQ3IDExMDAgCkwgMzA0NyAwIApMIDI0MTkgMCAKTCAyNDE5IDExMDAgCkwgMzEzIDExMDAgCkwgMzEzIDE3MDkgCkwgMjI1MyA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF80Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtODZlOGI1NTEwYiIgeD0iMjY4LjYyNTQ1NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF80Ij4KICAgICAgPCEtLSAwLjYgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MC42NzM4OTIgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM2IiBkPSJNIDIxMTMgMjU4NCAKUSAxNjg4IDI1ODQgMTQzOSAyMjkzIApRIDExOTEgMjAwMyAxMTkxIDE0OTcgClEgMTE5MSA5OTQgMTQzOSA3MDEgClEgMTY4OCA0MDkgMjExMyA0MDkgClEgMjUzOCA0MDkgMjc4NiA3MDEgClEgMzAzNCA5OTQgMzAzNCAxNDk3IApRIDMwMzQgMjAwMyAyNzg2IDIyOTMgClEgMjUzOCAyNTg0IDIxMTMgMjU4NCAKegpNIDMzNjYgNDU2MyAKTCAzMzY2IDM5ODggClEgMzEyOCA0MTAwIDI4ODYgNDE1OSAKUSAyNjQ0IDQyMTkgMjQwNiA0MjE5IApRIDE3ODEgNDIxOSAxNDUxIDM3OTcgClEgMTEyMiAzMzc1IDEwNzUgMjUyMiAKUSAxMjU5IDI3OTQgMTUzNyAyOTM5IApRIDE4MTYgMzA4NCAyMTUwIDMwODQgClEgMjg1MyAzMDg0IDMyNjEgMjY1NyAKUSAzNjY5IDIyMzEgMzY2OSAxNDk3IApRIDM2NjkgNzc4IDMyNDQgMzQzIApRIDI4MTkgLTkxIDIxMTMgLTkxIApRIDEzMDMgLTkxIDg3NSA1MjkgClEgNDQ3IDExNTAgNDQ3IDIzMjggClEgNDQ3IDM0MzQgOTcyIDQwOTIgClEgMTQ5NyA0NzUwIDIzODEgNDc1MCAKUSAyNjE5IDQ3NTAgMjg2MSA0NzAzIApRIDMxMDMgNDY1NiAzMzY2IDQ1NjMgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM2IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI204NmU4YjU1MTBiIiB4PSIzMzMuNTU2MzY0IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzUiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzI1LjYwNDgwMSAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzgiIGQ9Ik0gMjAzNCAyMjE2IApRIDE1ODQgMjIxNiAxMzI2IDE5NzUgClEgMTA2OSAxNzM0IDEwNjkgMTMxMyAKUSAxMDY5IDg5MSAxMzI2IDY1MCAKUSAxNTg0IDQwOSAyMDM0IDQwOSAKUSAyNDg0IDQwOSAyNzQzIDY1MSAKUSAzMDAzIDg5NCAzMDAzIDEzMTMgClEgMzAwMyAxNzM0IDI3NDUgMTk3NSAKUSAyNDg4IDIyMTYgMjAzNCAyMjE2IAp6Ck0gMTQwMyAyNDg0IApRIDk5NyAyNTg0IDc3MCAyODYyIApRIDU0NCAzMTQxIDU0NCAzNTQxIApRIDU0NCA0MTAwIDk0MiA0NDI1IApRIDEzNDEgNDc1MCAyMDM0IDQ3NTAgClEgMjczMSA0NzUwIDMxMjggNDQyNSAKUSAzNTI1IDQxMDAgMzUyNSAzNTQxIApRIDM1MjUgMzE0MSAzMjk4IDI4NjIgClEgMzA3MiAyNTg0IDI2NjkgMjQ4NCAKUSAzMTI1IDIzNzggMzM3OSAyMDY4IApRIDM2MzQgMTc1OSAzNjM0IDEzMTMgClEgMzYzNCA2MzQgMzIyMCAyNzEgClEgMjgwNiAtOTEgMjAzNCAtOTEgClEgMTI2MyAtOTEgODQ4IDI3MSAKUSA0MzQgNjM0IDQzNCAxMzEzIApRIDQzNCAxNzU5IDY5MCAyMDY4IApRIDk0NyAyMzc4IDE0MDMgMjQ4NCAKegpNIDExNzIgMzQ4MSAKUSAxMTcyIDMxMTkgMTM5OCAyOTE2IApRIDE2MjUgMjcxMyAyMDM0IDI3MTMgClEgMjQ0MSAyNzEzIDI2NzAgMjkxNiAKUSAyOTAwIDMxMTkgMjkwMCAzNDgxIApRIDI5MDAgMzg0NCAyNjcwIDQwNDcgClEgMjQ0MSA0MjUwIDIwMzQgNDI1MCAKUSAxNjI1IDQyNTAgMTM5OCA0MDQ3IApRIDExNzIgMzg0NCAxMTcyIDM0ODEgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM4IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzYiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI204NmU4YjU1MTBiIiB4PSIzOTguNDg3MjczIiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzYiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkwLjUzNTcxIDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMSIgZD0iTSA3OTQgNTMxIApMIDE4MjUgNTMxIApMIDE4MjUgNDA5MSAKTCA3MDMgMzg2NiAKTCA3MDMgNDQ0MSAKTCAxODE5IDQ2NjYgCkwgMjQ1MCA0NjY2IApMIDI0NTAgNTMxIApMIDM0ODEgNTMxIApMIDM0ODEgMCAKTCA3OTQgMCAKTCA3OTQgNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9Im1hdHBsb3RsaWIuYXhpc18yIj4KICAgIDxnIGlkPSJ5dGlja18xIj4KICAgICA8ZyBpZD0ibGluZTJkXzciPgogICAgICA8ZGVmcz4KICAgICAgIDxwYXRoIGlkPSJtMTVkMzFjYzMxNSIgZD0iTSAwIDAgCkwgLTMuNSAwIAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtMTVkMzFjYzMxNSIgeD0iNTcuNiIgeT0iMjk1LjY2NzA1MSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF83Ij4KICAgICAgPCEtLSAwIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NC4yMzc1IDI5OS40NjYyNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18yIj4KICAgICA8ZyBpZD0ibGluZTJkXzgiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI20xNWQzMWNjMzE1IiB4PSI1Ny42IiB5PSIyMzkuNDY2NDgxIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzgiPgogICAgICA8IS0tIDEgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ0LjIzNzUgMjQzLjI2NTcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMxIi8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF85Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtMTVkMzFjYzMxNSIgeD0iNTcuNiIgeT0iMTgzLjI2NTkxMSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF85Ij4KICAgICAgPCEtLSAyIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NC4yMzc1IDE4Ny4wNjUxMykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzIiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja180Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEwIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtMTVkMzFjYzMxNSIgeD0iNTcuNiIgeT0iMTI3LjA2NTM0MSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8xMCI+CiAgICAgIDwhLS0gMyAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDQuMjM3NSAxMzAuODY0NTYpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMyIgZD0iTSAyNTk3IDI1MTYgClEgMzA1MCAyNDE5IDMzMDQgMjExMiAKUSAzNTU5IDE4MDYgMzU1OSAxMzU2IApRIDM1NTkgNjY2IDMwODQgMjg3IApRIDI2MDkgLTkxIDE3MzQgLTkxIApRIDE0NDEgLTkxIDExMzAgLTMzIApRIDgxOSAyNSA0ODggMTQxIApMIDQ4OCA3NTAgClEgNzUwIDU5NyAxMDYyIDUxOSAKUSAxMzc1IDQ0MSAxNzE2IDQ0MSAKUSAyMzA5IDQ0MSAyNjIwIDY3NSAKUSAyOTMxIDkwOSAyOTMxIDEzNTYgClEgMjkzMSAxNzY5IDI2NDIgMjAwMSAKUSAyMzUzIDIyMzQgMTgzOCAyMjM0IApMIDEyOTQgMjIzNCAKTCAxMjk0IDI3NTMgCkwgMTg2MyAyNzUzIApRIDIzMjggMjc1MyAyNTc1IDI5MzkgClEgMjgyMiAzMTI1IDI4MjIgMzQ3NSAKUSAyODIyIDM4MzQgMjU2NyA0MDI2IApRIDIzMTMgNDIxOSAxODM4IDQyMTkgClEgMTU3OCA0MjE5IDEyODEgNDE2MiAKUSA5ODQgNDEwNiA2MjggMzk4OCAKTCA2MjggNDU1MCAKUSA5ODggNDY1MCAxMzAyIDQ3MDAgClEgMTYxNiA0NzUwIDE4OTQgNDc1MCAKUSAyNjEzIDQ3NTAgMzAzMSA0NDIzIApRIDM0NTAgNDA5NyAzNDUwIDM1NDEgClEgMzQ1MCAzMTUzIDMyMjggMjg4NiAKUSAzMDA2IDI2MTkgMjU5NyAyNTE2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzMiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzExIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtMTVkMzFjYzMxNSIgeD0iNTcuNiIgeT0iNzAuODY0NzcxIiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzExIj4KICAgICAgPCEtLSA0IC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0NC4yMzc1IDc0LjY2Mzk5KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICA8L2c+CiAgIDxnIGlkPSJsaW5lMmRfMTIiPgogICAgPHBhdGggZD0iTSA3My44MzI3MjcgMjk1LjQ4OCAKTCA5OC4zMDQxNzUgMjk1LjM1NzIxIApMIDEwOS43MjQxODUgMjk1LjI2OTg2OSAKTCAxMTcuODgxMzM0IDI5NS4xMTg1NyAKTCAxNDAuNzIxMzUyIDI5NC41NDI5NzQgCkwgMTQ1LjYxNTY0MiAyOTQuNDM3NzgxIApMIDE0OC44Nzg1MDIgMjk0LjIyODgxMiAKTCAxNTIuMTQxMzYxIDI5My44MzI4MjYgCkwgMTU3LjAzNTY1MSAyOTIuODgxNjg3IApMIDE2MC4yOTg1MTEgMjkyLjI4OTEzNSAKTCAxNjMuNTYxMzcgMjkxLjk2NjI1OSAKTCAxNjguNDU1NjYgMjkxLjU5Mjk4NCAKTCAxNzQuOTgxMzggMjkwLjY5NTQwNyAKTCAxODMuMTM4NTI5IDI4OS40NDQ0NzQgCkwgMTg2LjQwMTM4OSAyODguNzY0MTYxIApMIDE4OS42NjQyNDkgMjg3Ljc1MTk2IApMIDE5Mi45MjcxMDggMjg2LjQ2NzE4MyAKTCAxOTYuMTg5OTY4IDI4NS4wMjU3MTggCkwgMTk3LjgyMTM5OCAyODQuMTg1MzY1IApMIDE5OS40NTI4MjggMjgzLjE0Nzk4NyAKTCAyMDEuMDg0MjU4IDI4MS43NjUyNjEgCkwgMjAyLjcxNTY4OCAyNzkuODYzNTM2IApMIDIwNC4zNDcxMTcgMjc3LjI4OTQwNSAKTCAyMDUuOTc4NTQ3IDI3My45NjQ0OTIgCkwgMjA3LjYwOTk3NyAyNjkuOTI3NzQ3IApMIDIxMC44NzI4MzcgMjYwLjQ3MjAwMSAKTCAyMTQuMTM1Njk3IDI1MC44MDc0NjEgCkwgMjE3LjM5ODU1NiAyNDEuMzQ0ODY0IApMIDIxOS4wMjk5ODYgMjM1Ljk5NDc5NyAKTCAyMjAuNjYxNDE2IDIyOS42Mjk1NjYgCkwgMjIyLjI5Mjg0NiAyMjEuODAzODA4IApMIDIyMy45MjQyNzYgMjEyLjE0MzQ2NCAKTCAyMjUuNTU1NzA2IDIwMC40MDI1MjkgCkwgMjI3LjE4NzEzNiAxODYuNTc5OTI5IApMIDIzMi4wODE0MjUgMTM5LjI4OTMyNCAKTCAyMzMuNzEyODU1IDEyNS45NTIyNzcgCkwgMjM1LjM0NDI4NSAxMTYuMDg4ODUzIApMIDIzNi45NzU3MTUgMTEwLjE0MjE1IApMIDIzOC42MDcxNDUgMTA3LjQ5Njc5IApMIDI0MS44NzAwMDUgMTA1Ljc3OTcgCkwgMjQzLjUwMTQzNCAxMDMuNjk4NDIzIApMIDI0Ni43NjQyOTQgOTcuMzg4OTQgCkwgMjQ4LjM5NTcyNCA5Ni42MzI1NDYgCkwgMjUwLjAyNzE1NCA5OS45MjkzMzEgCkwgMjUxLjY1ODU4NCAxMDcuODc0NTIgCkwgMjUzLjI5MDAxNCAxMTkuNzE4MTU2IApMIDI1OC4xODQzMDMgMTYyLjQ4MTg2MSAKTCAyNTkuODE1NzMzIDE3NS4wNDM2OTUgCkwgMjYxLjQ0NzE2MyAxODYuMDE2MjY1IApMIDI2My4wNzg1OTMgMTk1LjQ0ODI0MSAKTCAyNjQuNzEwMDIzIDIwMy40NTk5MjQgCkwgMjY2LjM0MTQ1MyAyMTAuMTM3NzI2IApMIDI2Ny45NzI4ODMgMjE1LjQ2ODM3MyAKTCAyNjkuNjA0MzEyIDIxOS4zMzM2MDEgCkwgMjcxLjIzNTc0MiAyMjEuNjE2MTMzIApMIDI3Mi44NjcxNzIgMjIyLjQwMTUxNiAKTCAyNzQuNDk4NjAyIDIyMi4xNDU5NTcgCkwgMjc2LjEzMDAzMiAyMjEuNjQ3MTMxIApMIDI3Ny43NjE0NjIgMjIxLjc3MTM3MiAKTCAyNzkuMzkyODkyIDIyMy4wNzY1MzEgCkwgMjgxLjAyNDMyMiAyMjUuNTY1Njk2IApMIDI4NC4yODcxODEgMjMxLjgyMTk3NiAKTCAyODUuOTE4NjExIDIzNC4yMzgzNzEgCkwgMjg3LjU1MDA0MSAyMzUuNjk4NTM4IApMIDI4OS4xODE0NzEgMjM2LjI0NjEwOSAKTCAyOTAuODEyOTAxIDIzNi4wNzAxMiAKTCAyOTIuNDQ0MzMxIDIzNS4zMTYwMDcgCkwgMjk0LjA3NTc2MSAyMzQuMDA3NzY4IApMIDI5NS43MDcxOSAyMzIuMTA0MzI0IApMIDI5Ny4zMzg2MiAyMjkuNjEwOTk1IApMIDI5OC45NzAwNSAyMjYuNjM4ODQ1IApMIDMwMi4yMzI5MSAyMTkuOTQ2MTk0IApMIDMwNS40OTU3NyAyMTIuODM0MzUgCkwgMzA3LjEyNzIgMjA5LjAyMjAzMSAKTCAzMDguNzU4NjMgMjA0LjgyOTQzNSAKTCAzMTAuMzkwMDU5IDE5OS45Mzg1MDMgCkwgMzEyLjAyMTQ4OSAxOTMuODUyNTE0IApMIDMxMy42NTI5MTkgMTg1Ljk1NDk0OSAKTCAzMTUuMjg0MzQ5IDE3NS42OTAyNDcgCkwgMzE2LjkxNTc3OSAxNjIuODA2OTcyIApMIDMxOC41NDcyMDkgMTQ3LjU0NjU3MSAKTCAzMjMuNDQxNDk4IDk2LjU1NTgxOSAKTCAzMjUuMDcyOTI4IDgxLjUwOTczIApMIDMyNi43MDQzNTggNjguOTQzOTcyIApMIDMyOC4zMzU3ODggNTkuNTczODM1IApMIDMyOS45NjcyMTggNTQuMTczNTIyIApMIDMzMS41OTg2NDggNTMuNTY4IApMIDMzMy4yMzAwNzggNTguNDA4MTcyIApMIDMzNC44NjE1MDggNjguODM0ODc0IApMIDMzNi40OTI5MzcgODQuMjM1NzgyIApMIDMzOC4xMjQzNjcgMTAzLjI2NDE5MSAKTCAzNDMuMDE4NjU3IDE2NC45OTYzOCAKTCAzNDQuNjUwMDg3IDE4My4wNDk4MzggCkwgMzQ2LjI4MTUxNyAxOTkuMjM3NDkgCkwgMzQ3LjkxMjk0NyAyMTMuNzc1NTk0IApMIDM0OS41NDQzNzYgMjI2Ljg3NDk1MyAKTCAzNTEuMTc1ODA2IDIzOC41NzIwMjcgCkwgMzUyLjgwNzIzNiAyNDguNzQzNzQgCkwgMzU0LjQzODY2NiAyNTcuMjQ4MDc0IApMIDM1Ni4wNzAwOTYgMjY0LjA2ODUyIApMIDM1Ny43MDE1MjYgMjY5LjM2NTE4NyAKTCAzNTkuMzMyOTU2IDI3My40MTk2OTUgCkwgMzYwLjk2NDM4NiAyNzYuNTM0OTU2IApMIDM2Mi41OTU4MTUgMjc4Ljk2Mzg5MyAKTCAzNjQuMjI3MjQ1IDI4MC44OTc4NzMgCkwgMzY1Ljg1ODY3NSAyODIuNDkxODAzIApMIDM2OS4xMjE1MzUgMjg1LjE3NDg4IApMIDM3Mi4zODQzOTUgMjg3LjU4NzgwNyAKTCAzNzQuMDE1ODI1IDI4OC42MTYxMDEgCkwgMzc1LjY0NzI1NCAyODkuNDM3MTA3IApMIDM3Ny4yNzg2ODQgMjkwLjAzNTI3NSAKTCAzODAuNTQxNTQ0IDI5MC44MDIwNDEgCkwgMzgzLjgwNDQwNCAyOTEuNTU3NTAzIApMIDM5MC4zMzAxMjMgMjkzLjM2NDQ1OCAKTCAzOTMuNTkyOTgzIDI5NC4wMDYzOSAKTCAzOTguNDg3MjczIDI5NC43NDY1NTEgCkwgMzk4LjQ4NzI3MyAyOTQuNzQ2NTUxIAoiIGNsaXAtcGF0aD0idXJsKCNwNGQ2ZTk1OGY0YSkiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMxZjc3YjQ7IHN0cm9rZS13aWR0aDogMS41OyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzMiPgogICAgPHBhdGggZD0iTSA1Ny42IDMwNy41ODQgCkwgNTcuNiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNCI+CiAgICA8cGF0aCBkPSJNIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCiIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjg7IHN0cm9rZS1saW5lam9pbjogbWl0ZXI7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfNSI+CiAgICA8cGF0aCBkPSJNIDU3LjYgMzA3LjU4NCAKTCA0MTQuNzIgMzA3LjU4NCAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF82Ij4KICAgIDxwYXRoIGQ9Ik0gNTcuNiA0MS40NzIgCkwgNDE0LjcyIDQxLjQ3MiAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgPC9nPgogPC9nPgogPGRlZnM+CiAgPGNsaXBQYXRoIGlkPSJwNGQ2ZTk1OGY0YSI+CiAgIDxyZWN0IHg9IjU3LjYiIHk9IjQxLjQ3MiIgd2lkdGg9IjM1Ny4xMiIgaGVpZ2h0PSIyNjYuMTEyIi8+CiAgPC9jbGlwUGF0aD4KIDwvZGVmcz4KPC9zdmc+Cg==" alt="image" /></p>

<p>Here, we use a row concentration parameter of $2$ and a base measure
that assigns probability $1/2$ to both $0$ and $1$. This matches the
distribution used by Liu. What we call the column concentration
parameter is denoted by $c$ in Liu's analysis. Liu considers the cases
$c = 0.1$, $c = 1$, $c = 5$, and $c = 10$. The above image is our result
for $c = 1$. For $c = 10$, we have the following:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span> <span class="o">=</span> <span class="n">IDPModel</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">addWeightedSims</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span> <span class="c1"># took ~3m on a Macbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">meanRDGpdf</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">bandwidth</span>
<span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.10303529320118705</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgd2lkdGg9IjQ2MC44cHQiIGhlaWdodD0iMzQ1LjZwdCIgdmlld0JveD0iMCAwIDQ2MC44IDM0NS42IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSI+CiA8bWV0YWRhdGE+CiAgPHJkZjpSREYgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICA8Y2M6V29yaz4KICAgIDxkYzp0eXBlIHJkZjpyZXNvdXJjZT0iaHR0cDovL3B1cmwub3JnL2RjL2RjbWl0eXBlL1N0aWxsSW1hZ2UiLz4KICAgIDxkYzpkYXRlPjIwMjUtMDEtMjZUMDk6MDc6NTAuMTMzMjQwPC9kYzpkYXRlPgogICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICA8ZGM6Y3JlYXRvcj4KICAgICA8Y2M6QWdlbnQ+CiAgICAgIDxkYzp0aXRsZT5NYXRwbG90bGliIHYzLjkuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy88L2RjOnRpdGxlPgogICAgIDwvY2M6QWdlbnQ+CiAgICA8L2RjOmNyZWF0b3I+CiAgIDwvY2M6V29yaz4KICA8L3JkZjpSREY+CiA8L21ldGFkYXRhPgogPGRlZnM+CiAgPHN0eWxlIHR5cGU9InRleHQvY3NzIj4qe3N0cm9rZS1saW5lam9pbjogcm91bmQ7IHN0cm9rZS1saW5lY2FwOiBidXR0fTwvc3R5bGU+CiA8L2RlZnM+CiA8ZyBpZD0iZmlndXJlXzEiPgogIDxnIGlkPSJwYXRjaF8xIj4KICAgPHBhdGggZD0iTSAwIDM0NS42IApMIDQ2MC44IDM0NS42IApMIDQ2MC44IDAgCkwgMCAwIAp6CiIgc3R5bGU9ImZpbGw6ICNmZmZmZmYiLz4KICA8L2c+CiAgPGcgaWQ9ImF4ZXNfMSI+CiAgIDxnIGlkPSJwYXRjaF8yIj4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IApMIDQxNC43MiA0MS40NzIgCkwgNTcuNiA0MS40NzIgCnoKIiBzdHlsZT0iZmlsbDogI2ZmZmZmZiIvPgogICA8L2c+CiAgIDxnIGlkPSJtYXRwbG90bGliLmF4aXNfMSI+CiAgICA8ZyBpZD0ieHRpY2tfMSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xIj4KICAgICAgPGRlZnM+CiAgICAgICA8cGF0aCBpZD0ibTZmNWM1YjM3ZmYiIGQ9Ik0gMCAwIApMIDAgMy41IAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNmY1YzViMzdmZiIgeD0iNzMuODMyNzI3IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzEiPgogICAgICA8IS0tIDAuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjUuODgxMTY1IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMCIgZD0iTSAyMDM0IDQyNTAgClEgMTU0NyA0MjUwIDEzMDEgMzc3MCAKUSAxMDU2IDMyOTEgMTA1NiAyMzI4IApRIDEwNTYgMTM2OSAxMzAxIDg4OSAKUSAxNTQ3IDQwOSAyMDM0IDQwOSAKUSAyNTI1IDQwOSAyNzcwIDg4OSAKUSAzMDE2IDEzNjkgMzAxNiAyMzI4IApRIDMwMTYgMzI5MSAyNzcwIDM3NzAgClEgMjUyNSA0MjUwIDIwMzQgNDI1MCAKegpNIDIwMzQgNDc1MCAKUSAyODE5IDQ3NTAgMzIzMyA0MTI5IApRIDM2NDcgMzUwOSAzNjQ3IDIzMjggClEgMzY0NyAxMTUwIDMyMzMgNTI5IApRIDI4MTkgLTkxIDIwMzQgLTkxIApRIDEyNTAgLTkxIDgzNiA1MjkgClEgNDIyIDExNTAgNDIyIDIzMjggClEgNDIyIDM1MDkgODM2IDQxMjkgClEgMTI1MCA0NzUwIDIwMzQgNDc1MCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMmUiIGQ9Ik0gNjg0IDc5NCAKTCAxMzQ0IDc5NCAKTCAxMzQ0IDAgCkwgNjg0IDAgCkwgNjg0IDc5NCAKegoiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMTU2MjUpIi8+CiAgICAgICA8L2RlZnM+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inh0aWNrXzIiPgogICAgIDxnIGlkPSJsaW5lMmRfMiI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTZmNWM1YjM3ZmYiIHg9IjEzOC43NjM2MzYiIHk9IjMwNy41ODQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMiI+CiAgICAgIDwhLS0gMC4yIC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMzAuODEyMDc0IDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMiIgZD0iTSAxMjI4IDUzMSAKTCAzNDMxIDUzMSAKTCAzNDMxIDAgCkwgNDY5IDAgCkwgNDY5IDUzMSAKUSA4MjggOTAzIDE0NDggMTUyOSAKUSAyMDY5IDIxNTYgMjIyOCAyMzM4IApRIDI1MzEgMjY3OCAyNjUxIDI5MTQgClEgMjc3MiAzMTUwIDI3NzIgMzM3OCAKUSAyNzcyIDM3NTAgMjUxMSAzOTg0IApRIDIyNTAgNDIxOSAxODMxIDQyMTkgClEgMTUzNCA0MjE5IDEyMDQgNDExNiAKUSA4NzUgNDAxMyA1MDAgMzgwMyAKTCA1MDAgNDQ0MSAKUSA4ODEgNDU5NCAxMjEyIDQ2NzIgClEgMTU0NCA0NzUwIDE4MTkgNDc1MCAKUSAyNTQ0IDQ3NTAgMjk3NSA0Mzg3IApRIDM0MDYgNDAyNSAzNDA2IDM0MTkgClEgMzQwNiAzMTMxIDMyOTggMjg3MyAKUSAzMTkxIDI2MTYgMjkwNiAyMjY2IApRIDI4MjggMjE3NSAyNDA5IDE3NDIgClEgMTk5MSAxMzA5IDEyMjggNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMiIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF8zIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNmY1YzViMzdmZiIgeD0iMjAzLjY5NDU0NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8zIj4KICAgICAgPCEtLSAwLjQgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE5NS43NDI5ODMgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM0IiBkPSJNIDI0MTkgNDExNiAKTCA4MjUgMTYyNSAKTCAyNDE5IDE2MjUgCkwgMjQxOSA0MTE2IAp6Ck0gMjI1MyA0NjY2IApMIDMwNDcgNDY2NiAKTCAzMDQ3IDE2MjUgCkwgMzcxMyAxNjI1IApMIDM3MTMgMTEwMCAKTCAzMDQ3IDExMDAgCkwgMzA0NyAwIApMIDI0MTkgMCAKTCAyNDE5IDExMDAgCkwgMzEzIDExMDAgCkwgMzEzIDE3MDkgCkwgMjI1MyA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieHRpY2tfNCI+CiAgICAgPGcgaWQ9ImxpbmUyZF80Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNmY1YzViMzdmZiIgeD0iMjY4LjYyNTQ1NSIgeT0iMzA3LjU4NCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF80Ij4KICAgICAgPCEtLSAwLjYgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDI2MC42NzM4OTIgMzIyLjE4MjQzNykgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDxkZWZzPgogICAgICAgIDxwYXRoIGlkPSJEZWphVnVTYW5zLTM2IiBkPSJNIDIxMTMgMjU4NCAKUSAxNjg4IDI1ODQgMTQzOSAyMjkzIApRIDExOTEgMjAwMyAxMTkxIDE0OTcgClEgMTE5MSA5OTQgMTQzOSA3MDEgClEgMTY4OCA0MDkgMjExMyA0MDkgClEgMjUzOCA0MDkgMjc4NiA3MDEgClEgMzAzNCA5OTQgMzAzNCAxNDk3IApRIDMwMzQgMjAwMyAyNzg2IDIyOTMgClEgMjUzOCAyNTg0IDIxMTMgMjU4NCAKegpNIDMzNjYgNDU2MyAKTCAzMzY2IDM5ODggClEgMzEyOCA0MTAwIDI4ODYgNDE1OSAKUSAyNjQ0IDQyMTkgMjQwNiA0MjE5IApRIDE3ODEgNDIxOSAxNDUxIDM3OTcgClEgMTEyMiAzMzc1IDEwNzUgMjUyMiAKUSAxMjU5IDI3OTQgMTUzNyAyOTM5IApRIDE4MTYgMzA4NCAyMTUwIDMwODQgClEgMjg1MyAzMDg0IDMyNjEgMjY1NyAKUSAzNjY5IDIyMzEgMzY2OSAxNDk3IApRIDM2NjkgNzc4IDMyNDQgMzQzIApRIDI4MTkgLTkxIDIxMTMgLTkxIApRIDEzMDMgLTkxIDg3NSA1MjkgClEgNDQ3IDExNTAgNDQ3IDIzMjggClEgNDQ3IDM0MzQgOTcyIDQwOTIgClEgMTQ5NyA0NzUwIDIzODEgNDc1MCAKUSAyNjE5IDQ3NTAgMjg2MSA0NzAzIApRIDMxMDMgNDY1NiAzMzY2IDQ1NjMgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM2IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja181Ij4KICAgICA8ZyBpZD0ibGluZTJkXzUiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI202ZjVjNWIzN2ZmIiB4PSIzMzMuNTU2MzY0IiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzUiPgogICAgICA8IS0tIDAuOCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzI1LjYwNDgwMSAzMjIuMTgyNDM3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPGRlZnM+CiAgICAgICAgPHBhdGggaWQ9IkRlamFWdVNhbnMtMzgiIGQ9Ik0gMjAzNCAyMjE2IApRIDE1ODQgMjIxNiAxMzI2IDE5NzUgClEgMTA2OSAxNzM0IDEwNjkgMTMxMyAKUSAxMDY5IDg5MSAxMzI2IDY1MCAKUSAxNTg0IDQwOSAyMDM0IDQwOSAKUSAyNDg0IDQwOSAyNzQzIDY1MSAKUSAzMDAzIDg5NCAzMDAzIDEzMTMgClEgMzAwMyAxNzM0IDI3NDUgMTk3NSAKUSAyNDg4IDIyMTYgMjAzNCAyMjE2IAp6Ck0gMTQwMyAyNDg0IApRIDk5NyAyNTg0IDc3MCAyODYyIApRIDU0NCAzMTQxIDU0NCAzNTQxIApRIDU0NCA0MTAwIDk0MiA0NDI1IApRIDEzNDEgNDc1MCAyMDM0IDQ3NTAgClEgMjczMSA0NzUwIDMxMjggNDQyNSAKUSAzNTI1IDQxMDAgMzUyNSAzNTQxIApRIDM1MjUgMzE0MSAzMjk4IDI4NjIgClEgMzA3MiAyNTg0IDI2NjkgMjQ4NCAKUSAzMTI1IDIzNzggMzM3OSAyMDY4IApRIDM2MzQgMTc1OSAzNjM0IDEzMTMgClEgMzYzNCA2MzQgMzIyMCAyNzEgClEgMjgwNiAtOTEgMjAzNCAtOTEgClEgMTI2MyAtOTEgODQ4IDI3MSAKUSA0MzQgNjM0IDQzNCAxMzEzIApRIDQzNCAxNzU5IDY5MCAyMDY4IApRIDk0NyAyMzc4IDE0MDMgMjQ4NCAKegpNIDExNzIgMzQ4MSAKUSAxMTcyIDMxMTkgMTM5OCAyOTE2IApRIDE2MjUgMjcxMyAyMDM0IDI3MTMgClEgMjQ0MSAyNzEzIDI2NzAgMjkxNiAKUSAyOTAwIDMxMTkgMjkwMCAzNDgxIApRIDI5MDAgMzg0NCAyNjcwIDQwNDcgClEgMjQ0MSA0MjUwIDIwMzQgNDI1MCAKUSAxNjI1IDQyNTAgMTM5OCA0MDQ3IApRIDExNzIgMzg0NCAxMTcyIDM0ODEgCnoKIiB0cmFuc2Zvcm09InNjYWxlKDAuMDE1NjI1KSIvPgogICAgICAgPC9kZWZzPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTM4IiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ4dGlja182Ij4KICAgICA8ZyBpZD0ibGluZTJkXzYiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI202ZjVjNWIzN2ZmIiB4PSIzOTguNDg3MjczIiB5PSIzMDcuNTg0IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzYiPgogICAgICA8IS0tIDEuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzkwLjUzNTcxIDMyMi4xODI0MzcpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zMSIgZD0iTSA3OTQgNTMxIApMIDE4MjUgNTMxIApMIDE4MjUgNDA5MSAKTCA3MDMgMzg2NiAKTCA3MDMgNDQ0MSAKTCAxODE5IDQ2NjYgCkwgMjQ1MCA0NjY2IApMIDI0NTAgNTMxIApMIDM0ODEgNTMxIApMIDM0ODEgMCAKTCA3OTQgMCAKTCA3OTQgNTMxIAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9Im1hdHBsb3RsaWIuYXhpc18yIj4KICAgIDxnIGlkPSJ5dGlja18xIj4KICAgICA8ZyBpZD0ibGluZTJkXzciPgogICAgICA8ZGVmcz4KICAgICAgIDxwYXRoIGlkPSJtNzJhMWQ0ODIwZCIgZD0iTSAwIDAgCkwgLTMuNSAwIAoiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZGVmcz4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNzJhMWQ0ODIwZCIgeD0iNTcuNiIgeT0iMjk4LjMyNjc3OCIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF83Ij4KICAgICAgPCEtLSAwLjAgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAzMDIuMTI1OTk3KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMCIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja18yIj4KICAgICA8ZyBpZD0ibGluZTJkXzgiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI203MmExZDQ4MjBkIiB4PSI1Ny42IiB5PSIyNTMuMTg5MzM3IiBzdHlsZT0ic3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuOCIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgIDxnIGlkPSJ0ZXh0XzgiPgogICAgICA8IS0tIDAuNSAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDI1Ni45ODg1NTYpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iRGVqYVZ1U2Fucy0zNSIgZD0iTSA2OTEgNDY2NiAKTCAzMTY5IDQ2NjYgCkwgMzE2OSA0MTM0IApMIDEyNjkgNDEzNCAKTCAxMjY5IDI5OTEgClEgMTQwNiAzMDM4IDE1NDMgMzA2MSAKUSAxNjgxIDMwODQgMTgxOSAzMDg0IApRIDI2MDAgMzA4NCAzMDU2IDI2NTYgClEgMzUxMyAyMjI4IDM1MTMgMTQ5NyAKUSAzNTEzIDc0NCAzMDQ0IDMyNiAKUSAyNTc1IC05MSAxNzIyIC05MSAKUSAxNDI4IC05MSAxMTIzIC00MSAKUSA4MTkgOSA0OTQgMTA5IApMIDQ5NCA3NDQgClEgNzc1IDU5MSAxMDc1IDUxNiAKUSAxMzc1IDQ0MSAxNzA5IDQ0MSAKUSAyMjUwIDQ0MSAyNTY1IDcyNSAKUSAyODgxIDEwMDkgMjg4MSAxNDk3IApRIDI4ODEgMTk4NCAyNTY1IDIyNjggClEgMjI1MCAyNTUzIDE3MDkgMjU1MyAKUSAxNDU2IDI1NTMgMTIwNCAyNDk3IApRIDk1MyAyNDQxIDY5MSAyMzIyIApMIDY5MSA0NjY2IAp6CiIgdHJhbnNmb3JtPSJzY2FsZSgwLjAxNTYyNSkiLz4KICAgICAgIDwvZGVmcz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNSIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfMyI+CiAgICAgPGcgaWQ9ImxpbmUyZF85Ij4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNzJhMWQ0ODIwZCIgeD0iNTcuNiIgeT0iMjA4LjA1MTg5NiIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF85Ij4KICAgICAgPCEtLSAxLjAgLS0+CiAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM0LjY5Njg3NSAyMTEuODUxMTE1KSBzY2FsZSgwLjEgLTAuMSkiPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zMSIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0yZSIgeD0iNjMuNjIzMDQ3Ii8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMwIiB4PSI5NS40MTAxNTYiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgIDwvZz4KICAgIDxnIGlkPSJ5dGlja180Ij4KICAgICA8ZyBpZD0ibGluZTJkXzEwIj4KICAgICAgPGc+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNtNzJhMWQ0ODIwZCIgeD0iNTcuNiIgeT0iMTYyLjkxNDQ1NSIgc3R5bGU9InN0cm9rZTogIzAwMDAwMDsgc3Ryb2tlLXdpZHRoOiAwLjgiLz4KICAgICAgPC9nPgogICAgIDwvZz4KICAgICA8ZyBpZD0idGV4dF8xMCI+CiAgICAgIDwhLS0gMS41IC0tPgogICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNC42OTY4NzUgMTY2LjcxMzY3NCkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzEiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNSIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgICA8ZyBpZD0ieXRpY2tfNSI+CiAgICAgPGcgaWQ9ImxpbmUyZF8xMSI+CiAgICAgIDxnPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjbTcyYTFkNDgyMGQiIHg9IjU3LjYiIHk9IjExNy43NzcwMTQiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTEiPgogICAgICA8IS0tIDIuMCAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDEyMS41NzYyMzIpIHNjYWxlKDAuMSAtMC4xKSI+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTMyIi8+CiAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNEZWphVnVTYW5zLTJlIiB4PSI2My42MjMwNDciLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzAiIHg9Ijk1LjQxMDE1NiIvPgogICAgICA8L2c+CiAgICAgPC9nPgogICAgPC9nPgogICAgPGcgaWQ9Inl0aWNrXzYiPgogICAgIDxnIGlkPSJsaW5lMmRfMTIiPgogICAgICA8Zz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI203MmExZDQ4MjBkIiB4PSI1Ny42IiB5PSI3Mi42Mzk1NzMiIHN0eWxlPSJzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICAgPGcgaWQ9InRleHRfMTIiPgogICAgICA8IS0tIDIuNSAtLT4KICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzQuNjk2ODc1IDc2LjQzODc5MSkgc2NhbGUoMC4xIC0wLjEpIj4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMzIiLz4KICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI0RlamFWdVNhbnMtMmUiIHg9IjYzLjYyMzA0NyIvPgogICAgICAgPHVzZSB4bGluazpocmVmPSIjRGVqYVZ1U2Fucy0zNSIgeD0iOTUuNDEwMTU2Ii8+CiAgICAgIDwvZz4KICAgICA8L2c+CiAgICA8L2c+CiAgIDwvZz4KICAgPGcgaWQ9ImxpbmUyZF8xMyI+CiAgICA8cGF0aCBkPSJNIDczLjgzMjcyNyAyOTUuNDg4IApMIDgxLjk4OTg3NyAyOTUuMTI4OTUxIApMIDk4LjMwNDE3NSAyOTQuMjY0NjkgCkwgMTA0LjgyOTg5NSAyOTMuNjgzNTMzIApMIDExMi45ODcwNDQgMjkyLjg3MTAxIApMIDExOS41MTI3NjQgMjkyLjQ1Nzg3MiAKTCAxMjQuNDA3MDUzIDI5MS44MjAzNjcgCkwgMTMwLjkzMjc3MyAyOTAuNzIyMjk1IApMIDEzNS44MjcwNjMgMjg5LjY4NTAyMyAKTCAxMzkuMDg5OTIyIDI4OC44NDk4MDUgCkwgMTQyLjM1Mjc4MiAyODcuNzYxNDUzIApMIDE0Ny4yNDcwNzIgMjg1LjgxNDY3NyAKTCAxNDguODc4NTAyIDI4NS4zMTM4ODEgCkwgMTUwLjUwOTkzMSAyODQuOTcxNDI2IApMIDE1My43NzI3OTEgMjg0LjYzODAwNiAKTCAxNTcuMDM1NjUxIDI4NC4yMTU2NzggCkwgMTU4LjY2NzA4MSAyODMuNzkxNjA5IApMIDE2MC4yOTg1MTEgMjgzLjIwNzk0MSAKTCAxNjMuNTYxMzcgMjgxLjcxOTg1MyAKTCAxNjguNDU1NjYgMjc5LjM5NDQ3NyAKTCAxNzEuNzE4NTIgMjc3Ljg2NjQyNSAKTCAxNzMuMzQ5OTUgMjc2Ljk3NDgxMiAKTCAxNzQuOTgxMzggMjc1LjkzNzA4MyAKTCAxNzguMjQ0MjM5IDI3My40ODg1MTkgCkwgMTgxLjUwNzA5OSAyNzAuOTk5NTU3IApMIDE4NC43Njk5NTkgMjY4LjgzMzk4MiAKTCAxODguMDMyODE5IDI2Ni42MzI1MjEgCkwgMTg5LjY2NDI0OSAyNjUuMjcxMDc5IApMIDE5MS4yOTU2NzggMjYzLjYxMjU1OCAKTCAxOTIuOTI3MTA4IDI2MS42MjA2MjQgCkwgMTk5LjQ1MjgyOCAyNTIuNjE2ODc4IApMIDIwMS4wODQyNTggMjUxLjA3MTQyMiAKTCAyMDIuNzE1Njg4IDI0OS45MjE4NzYgCkwgMjA0LjM0NzExNyAyNDguOTE2ODAyIApMIDIwNS45Nzg1NDcgMjQ3LjY3MjY1NSAKTCAyMDcuNjA5OTc3IDI0NS43ODI5NCAKTCAyMDkuMjQxNDA3IDI0Mi45MjUyNzEgCkwgMjEwLjg3MjgzNyAyMzguOTM2NDAxIApMIDIxMi41MDQyNjcgMjMzLjg0ODI5OCAKTCAyMTQuMTM1Njk3IDIyNy44ODcxMDcgCkwgMjE5LjAyOTk4NiAyMDguOTIyOTY4IApMIDIyMC42NjE0MTYgMjAzLjY5NzE4MyAKTCAyMjIuMjkyODQ2IDE5OS41MDQzNzIgCkwgMjIzLjkyNDI3NiAxOTYuMzgxOTggCkwgMjI1LjU1NTcwNiAxOTQuMTYzNDU5IApMIDIyOC44MTg1NjYgMTkwLjY4MzY0MiAKTCAyMzAuNDQ5OTk1IDE4OC4wNTkzMzQgCkwgMjMyLjA4MTQyNSAxODMuNzk2Mzk5IApMIDIzMy43MTI4NTUgMTc3LjI3MjExNSAKTCAyMzUuMzQ0Mjg1IDE2OC4yNjI5MzUgCkwgMjM2Ljk3NTcxNSAxNTcuMTEzNTY2IApMIDI0MC4yMzg1NzUgMTMyLjUzMjM1MSAKTCAyNDEuODcwMDA1IDEyMS43OTY2MTMgCkwgMjQzLjUwMTQzNCAxMTMuNTA5Njc5IApMIDI0NS4xMzI4NjQgMTA3Ljk1MzQxOCAKTCAyNDYuNzY0Mjk0IDEwNC43NDM4OTggCkwgMjQ4LjM5NTcyNCAxMDMuMDkxNDQzIApMIDI1MS42NTg1ODQgMTAxLjIxODQ4NyAKTCAyNTMuMjkwMDE0IDk5Ljk2MzM4NCAKTCAyNTQuOTIxNDQ0IDk4LjMyMDA1NSAKTCAyNTYuNTUyODczIDk2LjQ4OTYzMiAKTCAyNTguMTg0MzAzIDk0LjgyODAxMyAKTCAyNTkuODE1NzMzIDkzLjcxNjk3NSAKTCAyNjEuNDQ3MTYzIDkzLjQyNzQ3MSAKTCAyNjMuMDc4NTkzIDkzLjk5MzY2MyAKTCAyNjYuMzQxNDUzIDk2LjE0Mjc2IApMIDI2Ny45NzI4ODMgOTYuMTYxNjkzIApMIDI2OS42MDQzMTIgOTQuMjc1ODIzIApMIDI3MS4yMzU3NDIgODkuOTU4MzQ1IApMIDI3Mi44NjcxNzIgODMuMzU1OTU1IApMIDI3Ni4xMzAwMzIgNjcuMzAwNTg3IApMIDI3Ny43NjE0NjIgNjAuNTU5OTg3IApMIDI3OS4zOTI4OTIgNTYuMDEzMDE5IApMIDI4MS4wMjQzMjIgNTMuODM4MDIgCkwgMjgyLjY1NTc1MSA1My41NjggCkwgMjg0LjI4NzE4MSA1NC4zNjE0MTEgCkwgMjg1LjkxODYxMSA1NS4zNDM4OTQgCkwgMjg3LjU1MDA0MSA1NS45MDgwMDMgCkwgMjg5LjE4MTQ3MSA1NS44OTQ2NjkgCkwgMjkwLjgxMjkwMSA1NS42MTE1NTQgCkwgMjkyLjQ0NDMzMSA1NS42OTQyNzEgCkwgMjk0LjA3NTc2MSA1Ni44NzQ0NzggCkwgMjk1LjcwNzE5IDU5LjczODEyNSAKTCAyOTcuMzM4NjIgNjQuNTMzMTQxIApMIDI5OC45NzAwNSA3MS4wNjM5NTcgCkwgMzAzLjg2NDM0IDkzLjc1OTQ5OSAKTCAzMDUuNDk1NzcgOTkuNTU1NjAyIApMIDMwNy4xMjcyIDEwMy42MDU3OTcgCkwgMzA4Ljc1ODYzIDEwNS44OTUyNjkgCkwgMzEwLjM5MDA1OSAxMDYuNzA2NjMgCkwgMzEyLjAyMTQ4OSAxMDYuNTY4NzEyIApMIDMxMy42NTI5MTkgMTA2LjE5MTg2NiAKTCAzMTUuMjg0MzQ5IDEwNi4zNDI2MjggCkwgMzE2LjkxNTc3OSAxMDcuNjQ3ODM0IApMIDMxOC41NDcyMDkgMTEwLjM5NDkyNCAKTCAzMjAuMTc4NjM5IDExNC40MzM4MyAKTCAzMjUuMDcyOTI4IDEyOC41MjMzOTEgCkwgMzI2LjcwNDM1OCAxMzIuMDIzNzg2IApMIDMyOC4zMzU3ODggMTM0LjU1OTMxNSAKTCAzMjkuOTY3MjE4IDEzNi4yMzU2MTEgCkwgMzMxLjU5ODY0OCAxMzcuMjI3Mjk2IApMIDMzMy4yMzAwNzggMTM3LjcxNTk3NCAKTCAzMzYuNDkyOTM3IDEzOC4yNTUwMTggCkwgMzM4LjEyNDM2NyAxMzkuMjUwMjIyIApMIDMzOS43NTU3OTcgMTQxLjU2MDUyOSAKTCAzNDEuMzg3MjI3IDE0NS42NTM1MTEgCkwgMzQzLjAxODY1NyAxNTEuNTY0NTM1IApMIDM0Ni4yODE1MTcgMTY2LjU1MTQ4NyAKTCAzNDcuOTEyOTQ3IDE3My45ODI0NDUgCkwgMzQ5LjU0NDM3NiAxODAuNjYyODcyIApMIDM1Mi44MDcyMzYgMTkyLjM2MjIxMyAKTCAzNTYuMDcwMDk2IDIwNC4xOTM5NTUgCkwgMzU5LjMzMjk1NiAyMTUuODk5ODM0IApMIDM2MC45NjQzODYgMjIxLjAzMTE1NCAKTCAzNjQuMjI3MjQ1IDIzMC4wNzk4MjMgCkwgMzcyLjM4NDM5NSAyNTEuOTQ5Mjc4IApMIDM3NC4wMTU4MjUgMjU1LjQ3MjU4MiAKTCAzNzUuNjQ3MjU0IDI1OC41ODEyOTggCkwgMzc4LjkxMDExNCAyNjMuOTUxNjcxIApMIDM4My44MDQ0MDQgMjcxLjE1MTg5NSAKTCAzODcuMDY3MjY0IDI3NS42NTAwODQgCkwgMzkwLjMzMDEyMyAyNzkuNzg0Mjk3IApMIDM5OC40ODcyNzMgMjg5LjU2ODg5NSAKTCAzOTguNDg3MjczIDI4OS41Njg4OTUgCiIgY2xpcC1wYXRoPSJ1cmwoI3A4Nzk3NmIzYTIyKSIgc3R5bGU9ImZpbGw6IG5vbmU7IHN0cm9rZTogIzFmNzdiNDsgc3Ryb2tlLXdpZHRoOiAxLjU7IHN0cm9rZS1saW5lY2FwOiBzcXVhcmUiLz4KICAgPC9nPgogICA8ZyBpZD0icGF0Y2hfMyI+CiAgICA8cGF0aCBkPSJNIDU3LjYgMzA3LjU4NCAKTCA1Ny42IDQxLjQ3MiAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF80Ij4KICAgIDxwYXRoIGQ9Ik0gNDE0LjcyIDMwNy41ODQgCkwgNDE0LjcyIDQxLjQ3MiAKIiBzdHlsZT0iZmlsbDogbm9uZTsgc3Ryb2tlOiAjMDAwMDAwOyBzdHJva2Utd2lkdGg6IDAuODsgc3Ryb2tlLWxpbmVqb2luOiBtaXRlcjsgc3Ryb2tlLWxpbmVjYXA6IHNxdWFyZSIvPgogICA8L2c+CiAgIDxnIGlkPSJwYXRjaF81Ij4KICAgIDxwYXRoIGQ9Ik0gNTcuNiAzMDcuNTg0IApMIDQxNC43MiAzMDcuNTg0IAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICAgPGcgaWQ9InBhdGNoXzYiPgogICAgPHBhdGggZD0iTSA1Ny42IDQxLjQ3MiAKTCA0MTQuNzIgNDEuNDcyIAoiIHN0eWxlPSJmaWxsOiBub25lOyBzdHJva2U6ICMwMDAwMDA7IHN0cm9rZS13aWR0aDogMC44OyBzdHJva2UtbGluZWpvaW46IG1pdGVyOyBzdHJva2UtbGluZWNhcDogc3F1YXJlIi8+CiAgIDwvZz4KICA8L2c+CiA8L2c+CiA8ZGVmcz4KICA8Y2xpcFBhdGggaWQ9InA4Nzk3NmIzYTIyIj4KICAgPHJlY3QgeD0iNTcuNiIgeT0iNDEuNDcyIiB3aWR0aD0iMzU3LjEyIiBoZWlnaHQ9IjI2Ni4xMTIiLz4KICA8L2NsaXBQYXRoPgogPC9kZWZzPgo8L3N2Zz4K" alt="image" /></p>

<p>These graphs look about the same as Liu's, but with minor differences.
It is difficult, though, to make a direct comparison. Liu also uses
Gaussian kernel smoothing, but does not provide any details about it.
For example, we do not know the bandwidth used to produce Liu's graphs.</p>

<h2 id="amazon-reviews">Amazon reviews</h2>

<p><a href="https://doi.org/10.1214/aos/1032526949">Liu 1996</a> only covers agents
with two possible actions, such as coins and thumbtacks. The IDP,
though, can handle agents whose range of possible actions is arbitrary.</p>

<p><strong><em>To be continued...</em></strong></p>

<h2 id="video-game-leaderboards">Video game leaderboards</h2>

<p><strong><em>COMING SOON</em></strong></p>
</div>

                        <input id="mod-idp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-idp-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sa">r</span><span class="sd">&#39;&#39;&#39;Tools for working with iterated Dirichlet processes.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd"># Module description</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">Consider a situation in which there are several agents, all from the</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">same population. Each agent undertakes a sequence of actions. These</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">actions are chosen according to the agent&#39;s particular tendencies.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">Although different agents have different tendencies, there may be</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">patterns in the population.</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">We observe a certain set of agents over a certain amount of time. Based</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">on these observations, we want to make probabilistic forecasts about two</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">things:</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">* The future behavior of the agents we have observed.</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">* The behavior of a new (unobserved) agent from the population.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">An iterated Dirichlet process is a mathematical tool that can model</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">this. The file, `idp-paper-9.pdf`, gives the mathematical details. (In</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">this rest of this documentation, we refer to this file as the &quot;Paper.&quot;)</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">This module, `idp`, is a Python implementation of the iterated Dirichlet</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">process (IDP).</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd"># Examples</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">## Pressed penny machines</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">Imagine a pressed penny machine, like those found in museums or tourist</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">attractions. For a fee, the machine presses a penny into a commemorative</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">souvenir. Now imagine the machine is broken, so that it mangles all the</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">pennies we feed it. Each pressed penny it creates is mangled in its own</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">way. Each has its own probability of landing on heads when flipped. In</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">this situation, the agents are the pennies and the actions are the heads</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">and tails that they produce.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">Now suppose we create seven mangled pennies and flip each one 5 times.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">Suppose that the first four coins each result in 4 heads out of 5 flips.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">The fifth coin results in 1 head, the sixth coin results in 4 heads, and</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">the seventh coin results in 3 heads. If we flip the fifth coin one more</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">time, what is the probability that it will land on heads? Looking only</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">at the past flips of the fifth coin, it seems biased towards tails.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">Overall, though, the machine seems to make coins that are biased towards</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">heads. All seven coins could be heads-biased, and the fifth coin just</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">had an unlucky run. How should we balance these competing intuitions to</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">arrive at a probability?</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">One way to answer this is to model the situation with an IDP. We can do</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">this with the `IDPModel` class as follows:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">```python</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">&gt;&gt;&gt; from idp import IDPModel</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">&gt;&gt;&gt; idpModel = IDPModel(1, 1, 0.5,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">...     [[5 - x, x] for x in [4, 4, 4, 4, 1, 4, 3]])</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">```</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">Next, we run 10,000 weighted simulations and use them to estimate the</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">probability that the fifth coin, if flipped again, will land on heads:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">```python</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">&gt;&gt;&gt; idpModel.addWeightedSims(10000)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">&gt;&gt;&gt; idpModel.postProb(4)</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">np.float64(0.44196003938121636)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">```</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">Likewise, we can estimate the same probability for the first and seventh</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">coins:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">```python</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">&gt;&gt;&gt; idpModel.postProb(0)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">np.float64(0.7236483548829938)</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">&gt;&gt;&gt; idpModel.postProb(6)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">np.float64(0.6806816746246023)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">```</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">We can also estimate the probability that a new coin from the machine</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">will land on heads when flipped. For this, we can use any argument</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">larger than the highest index in our observed data.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">```python</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">&gt;&gt;&gt; idpModel.postProb(7)</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">np.float64(0.6559370622554825)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">&gt;&gt;&gt; idpModel.postProb(47586)</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">np.float64(0.6559370622554825)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">```</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">If the new coin from the machine has probability of heads $\theta$, then</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">$\theta$ is a random variable taking values in $[0, 1]$. The following</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">will plot the cumulative distribution function of $\theta$:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">```python</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">&gt;&gt;&gt; import numpy as np</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">&gt;&gt;&gt; import matplotlib.pyplot as plt</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">&gt;&gt;&gt; t = np.linspace(0, 1, 200)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">&gt;&gt;&gt; plt.plot(t, idpModel.meanRDGcdf(t))</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">&gt;&gt;&gt; plt.show()</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">```</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">![image](images/coins_cdf.svg)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">The random variable $\theta$ has a discrete component, so it does not</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">have a probability density function. But we can plot an approximate</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">density as follows:</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">```python</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">&gt;&gt;&gt; plt.plot(t, idpModel.meanRDGpdf(t))</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">&gt;&gt;&gt; plt.show()</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">```</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">![image](images/coins_pdf_default.svg)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">The approximate density is computed by smoothing out the discrete point</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="sd">masses. The degree of smoothing is determined by a parameter called the</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">&quot;bandwidth&quot;. (See `IDPModel.meanRDGpdf` for details.) This bandwidth is</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">computed automatically. We can view the bandwidth that was used most</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">recently, and we can also set the bandwidth manually.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">```python</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">&gt;&gt;&gt; idpModel.bandwidth</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">np.float64(0.11679260408842912)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">&gt;&gt;&gt; plt.plot(t, idpModel.meanRDGpdf(t, bandwidth=0.001))</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">&gt;&gt;&gt; plt.show()</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">```</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">![image](images/coins_pdf_coarse.svg)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">## Flipping thumbtacks</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">Imagine a box of 320 thumbtacks. We flick each thumbtack 9 times. If it</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">lands point up, we call it a success. Point down is a failure. Because</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="sd">of the imperfections, each thumbtack has its own probability of success.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">The file, `tacks.csv`, contains the success and failure counts for this</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">experiment. The data in `tacks.csv` is exactly the data considered in</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">[Liu 1996](https://doi.org/10.1214/aos/1032526949). (This data</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">originally came from an experiment by Beckett and Diaconis in 1994. In</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">the original experiment, there were not 320 thumbtacks. Rather, there</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">were 16 thumbtacks, 2 flickers, and 10 surfaces.)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">To study this situation, we first create the model and perform 10,000</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">simulations. We then look at the approximate density of the posterior</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">probability of success.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">```python</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">&gt;&gt;&gt; import csv</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">&gt;&gt;&gt; with open(&#39;tacks.csv&#39;) as f:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">...     sheet = list(csv.reader(f))</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">...     rowCounts = [[int(value) for value in row] for row in sheet]</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">&gt;&gt;&gt; idpModel = IDPModel(1, 2, 0.5, rowCounts)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a><span class="sd">&gt;&gt;&gt; idpModel.addWeightedSims(10000) # took ~3m on a Macbook</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">&gt;&gt;&gt; plt.plot(t, idpModel.meanRDGpdf(t))</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">&gt;&gt;&gt; idpModel.bandwidth</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">np.float64(0.11170697606064083)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">&gt;&gt;&gt; plt.show()</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">```</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">![image](images/tacks_pdf_1.svg)</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">Here, we use a row concentration parameter of $2$ and a base measure</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">that assigns probability $1/2$ to both $0$ and $1$. This matches the</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">distribution used by Liu. What we call the column concentration</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="sd">parameter is denoted by $c$ in Liu&#39;s analysis. Liu considers the cases</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">$c = 0.1$, $c = 1$, $c = 5$, and $c = 10$. The above image is our result</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">for $c = 1$. For $c = 10$, we have the following:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">```python</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">&gt;&gt;&gt; idpModel = IDPModel(10, 2, 0.5, rowCounts)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">&gt;&gt;&gt; idpModel.addWeightedSims(10000) # took ~3m on a Macbook</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">&gt;&gt;&gt; plt.plot(t, idpModel.meanRDGpdf(t))</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">&gt;&gt;&gt; idpModel.bandwidth</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">np.float64(0.10303529320118705)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">&gt;&gt;&gt; plt.show()</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">```</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">![image](images/tacks_pdf_10.svg)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">These graphs look about the same as Liu&#39;s, but with minor differences.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">It is difficult, though, to make a direct comparison. Liu also uses</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">Gaussian kernel smoothing, but does not provide any details about it.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">For example, we do not know the bandwidth used to produce Liu&#39;s graphs.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">## Amazon reviews</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">[Liu 1996](https://doi.org/10.1214/aos/1032526949) only covers agents</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">with two possible actions, such as coins and thumbtacks. The IDP,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">though, can handle agents whose range of possible actions is arbitrary.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">***To be continued...***</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">## Video game leaderboards</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">***COMING SOON***</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">&#39;&#39;&#39;</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">choices</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gammaln</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span><span class="p">,</span> <span class="n">dirichlet</span><span class="p">,</span> <span class="n">gaussian_kde</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDFDiscrete</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IDPModel&#39;</span><span class="p">,</span> <span class="s1">&#39;WeightedSim&#39;</span><span class="p">]</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="k">def</span> <span class="nf">_betaFuncMult</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="sd">&#39;&#39;&#39;Computes and returns the value of the multivariate beta function,</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="sd">    evaluated at the given list of arguments.</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a><span class="sd">    **Arguments:**</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">    * **alpha** (`list`[`float`]): The list of arguments for the</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        multivariate beta function.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">gammaln</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span> <span class="o">-</span> <span class="n">gammaln</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">alpha</span><span class="p">)))</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="k">class</span> <span class="nc">IDPModel</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;An IDP model on the state space $S = \\{0, ..., L - 1\\}$.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">    The IDP model consists of both an IDP and some observed data. See</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">    Section 9 of the Paper for details.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colConc</span><span class="p">,</span> <span class="n">rowConc</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">):</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>        <span class="sd">&#39;&#39;&#39;The constructor first uses the given arguments to set the</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        corresponding properties. If a property returns a tuple or a</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        tuple of tuples, then the argument can be passed any</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">        `array-like` object, such as a list or a list of lists.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        For the `baseMeas` property, the corresponding argument can be</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">        passed a single floating point value `p`, in which case the</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        property will be set to `(1 - p, p)`.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="c1"># `baseMeas` and `rowCounts` are stored as ndarrays rather than</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="c1"># lists, since vector addition fails for lists but works for</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>        <span class="c1"># ndarrays. This is important in the constructor of the</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="c1"># `WeightedSim` class.</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">]</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>        <span class="n">rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="s1">&#39;colConc&#39;</span><span class="p">:</span> <span class="n">colConc</span><span class="p">,</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="s1">&#39;rowConc&#39;</span><span class="p">:</span> <span class="n">rowConc</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="s1">&#39;baseMeas&#39;</span><span class="p">:</span> <span class="n">baseMeas</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="p">}</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">rowCounts</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>    <span class="nd">@property</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>    <span class="k">def</span> <span class="nf">colConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The column concentration parameter. Should be</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        positive. Denoted by $\kappa$ in Section 9 of the Paper.</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>    <span class="nd">@property</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>    <span class="k">def</span> <span class="nf">rowConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The row concentration parameter. Should be</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        positive. Denoted by $\varepsilon$ in Section 9 of the Paper.</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>    <span class="nd">@property</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>    <span class="k">def</span> <span class="nf">baseMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The base probability vector. Should be a</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        list of positive numbers that sum to 1. Denoted by</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        $\boldsymbol{p} = (p_0, \ldots, p_{L - 1})$ in Section 9 of the</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        Paper, where $p_\ell = \varrho(\{\ell\})$.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">])</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>    <span class="nd">@property</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>    <span class="k">def</span> <span class="nf">rowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`int`)): The row counts for the observed</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        data. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        `rowCounts`[`row`][`state`] is denoted by $\overline{y}_{m\ell}$</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        in Section 9 of the Paper. It is the number of observed</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">        instances of `state` in the given row of data.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="nd">@property</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">likelihoods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The prior likelihoods. If `row` equals</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        $m - 1$, then `likelihoods`[`row`] is denoted by</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        $\varrho_N(A_m)$ in Section 9 of the Paper. It is the prior</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        probability of seeing the row counts for the given row. This</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        property is computed by the constructor, and should not be</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        changed.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">):</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="n">rowConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>            <span class="n">denom</span> <span class="o">=</span> <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">):]:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>                    <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>                <span class="p">)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>    <span class="nd">@property</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The scale factor to use for weighted simulations.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        Denoted by $\log c$ in Section 9 of the Paper. Defaults to 0.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        Altering this value runs the `WeightedSim.updateScale` method on</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">        every simulation in the `weightedSims` property. If a</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">        `ValueError` occurs in this process, then no changes will be</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        made, neither to the `scale` property, nor to any of the</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        simulations in the `weightedSims` property.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>    <span class="nd">@scale</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="n">oldVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateScale</span><span class="p">()</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">oldVal</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="k">raise</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>    <span class="nd">@property</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>    <span class="k">def</span> <span class="nf">weightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`WeightedSim`): A tuple of distinct (and therefore</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        independent) `WeightedSim` instances. `weightedSims`[k] is</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">        denoted by $(t^k, \boldsymbol{\theta}_M^{*, k})$ in Section 9 of</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        the Paper, and has total weight $V^{(k)}$. This property is</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">        empty if the `addWeightedSims` method has never been run.</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>    <span class="nd">@property</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>    <span class="k">def</span> <span class="nf">bandwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The bandwidth used most recently by the `meanRDGpdf`</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        method. Is `None` if this method has never been used.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>    <span class="k">def</span> <span class="nf">addRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="sd">&#39;&#39;&#39;Adds new row counts to the `rowCounts` property and runs the</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">        `WeightedSim.updateRowCounts` method on every simulation in the</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        `weightedSims` property. If a `ValueError` occurs in this</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        process, then no changes will be made, neither to the</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        `rowCounts` property, nor to any of the simulations in the</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        * **newRowCounts** (`array_like`): The additional row counts to</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">            be added. Should be an array-like object (such as a list of</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">            lists) with the same number of columns (states) as</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">            `rowCounts`.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="n">oldRowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">))</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">oldRowCounts</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>            <span class="k">raise</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>    <span class="k">def</span> <span class="nf">delRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numRows</span><span class="p">):</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="sd">&#39;&#39;&#39;Deletes the last `numRows` rows of the `rowCounts` property,</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        then runs the `WeightedSim.updateRowCounts` method on every</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        simulation in the `weightedSims` property.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        * **numRows** (`int`): The number of rows to delete.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[:</span><span class="o">-</span><span class="n">numRows</span><span class="p">]</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>    <span class="k">def</span> <span class="nf">addWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>        <span class="sd">&#39;&#39;&#39;Creates new `WeightedSim` instances and adds them to the</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        </span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        * **num** (`int`): The number of distinct `WeightedSim`</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">            instances to create. If zero or negative, no instances are</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">            created.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">+=</span> <span class="p">[</span><span class="n">WeightedSim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>    <span class="k">def</span> <span class="nf">clearWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="sd">&#39;&#39;&#39;Deletes all weighted simulations contained in the</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>    <span class="k">def</span> <span class="nf">postProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Computes and returns the posterior probability of seeing the</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a><span class="sd">        given state on a new trial in the given row. If `row` is</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        $m - 1$, `state` is $\ell$ , and the length of `rowCounts` is</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        $M$, then the value returned by this method is denoted in the</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        Paper by $P(\xi_{m, N_m + \ell} = 1 \mid Y = y)$ in the case</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        $m \le M$, and by $P(\xi_{M + 1, 1} = \ell \mid Y = y)$ in the</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        case $m &gt; M$. This method implements (9.4) and (9.5) in the</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        Paper.</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">        * **row** (`int`): The index of the row whose posterior</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">            probability should be computed.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        * **state** (`int`): The state whose posterior probability</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">            should be computed.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">        * `float`: The posterior probability of seeing the given state.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">        **Raises:**</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        * **ValueError**: If the `weightedSims` property is empty.</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No weighted simulations found&#39;</span><span class="p">)</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">numRows</span><span class="p">:</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="n">colConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>            <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">))</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>    <span class="k">def</span> <span class="nf">_postProbLow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="sd">&#39;&#39;&#39;This method is the same as `postProb`, except it requires</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        `row` to be less than the length of `rowCounts`.</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span> <span class="o">*</span> <span class="n">weightedSim</span><span class="o">.</span><span class="n">rowDistSims</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>        <span class="p">)</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>    <span class="k">def</span> <span class="nf">meanRDGcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;The mean of the row distribution generator (RDG) for a state</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        $\ell$ is a probability distribution on $[0, 1]$. More</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        specifically, using the notation in the Paper, it is the</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        conditional distribution of $\theta_{M + 1, \ell}$ given</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        $Y = y$, and an expression for it is given in (9.6) in the</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        Paper.</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        This method evaluates the cumulative distribution function (cdf)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">        of the mean of the RDG for the given state at the given point.</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        That is, it gives the cdf for the random probability of seeing</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">        the given state in a new trial.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the cdf.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        * **state** (`int`): The state for which the cdf is to be</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">            computed.</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        * `float`: The value of the cdf at the given point.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="n">sampleCDF</span> <span class="o">=</span> <span class="n">ECDFDiscrete</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">sampleCDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="nf">_prior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="sd">&#39;&#39;&#39;Returns the prior distribution of the mean RDG for the given</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        state.</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>        <span class="k">return</span> <span class="n">beta</span><span class="p">(</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">],</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">])</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">_makeSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="sd">&#39;&#39;&#39;Creates and returns a weighted list of simulated row</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        distributions evaluated at the given state. Used to create the</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        empirical distribution of the mean RDG.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>        <span class="c1"># The `sample` vector is ordered as</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="c1"># \[</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, 1}, \ldots, \theta_{M \ell}^{*, 1},</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, 2}, \ldots, \theta_{M \ell}^{*, 2},</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="c1">#   \ldots,</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, K}, \ldots, \theta_{M \ell}^{*, K}</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="c1"># \]</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">rowDistSims</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="c1"># outer loop</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">)</span>  <span class="c1"># inner loop</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="p">])</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="p">[</span><span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span><span class="p">]</span> <span class="o">*</span> <span class="n">numRows</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="p">])</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>    <span class="k">def</span> <span class="nf">meanRDGpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;This method evaluates an approximate density (pdf) for the</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        mean of the RDG for the given state. (See `meanRDGcdf` for an</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        explanation of the RDG.) The mean of the RDG has a discrete</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        component, and therefore has no density. This method creates an</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        approximate density using Gaussian kernel density estimation</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        (KDE). More specifically, it treats the point mass $\delta_x$ as</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        having a Gaussian density with mean $x$ and standard deviation</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">        $h$, where $h$ is the &quot;bandwidth&quot; of the estimate.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        **Arguments:**</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="sd">            approximate pdf.</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="sd">        * **state** (`int`): The state for which the pdf is to be</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a><span class="sd">            computed.</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="sd">        * **bandwidth** (`float`): The bandwidth to use in the Gaussian</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">            KDE. If omitted, the bandwidth will be calculated using</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a><span class="sd">            Scott&#39;s Rule. The calculated value can be retrieved using</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">            the `bandwidth` property. This argument is passed directly</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">            to the `gaussian_kde` function in the `scipy.stats` module.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">            See that documentation for further details.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">        **Returns:**</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        * `float`: The value of the approximate pdf at the given point.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>        <span class="n">samplePDF</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="n">samplePDF</span><span class="o">.</span><span class="n">factor</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">samplePDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="k">class</span> <span class="nc">WeightedSim</span><span class="p">:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;A weighted simulation for an `IDPModel` instance.</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a><span class="sd">    In the Paper, a weighted simulation is determined by the pair $(t,</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="sd">    \boldsymbol{\theta}_M^*)$ and has total weight $V$.</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idpModel</span><span class="p">):</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Uses the given argument to set the corresponding property,</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">        then runs the `updateRowCounts` method.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span> <span class="o">=</span> <span class="n">idpModel</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="c1"># stored copy to detect changes</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># the natural logarithm of the total weight</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>    <span class="nd">@property</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>    <span class="k">def</span> <span class="nf">idpModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>        <span class="sd">&#39;&#39;&#39;`IDPModel`: The IDP model for which the weighted simulation</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a><span class="sd">        is being created.</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>    <span class="nd">@property</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>    <span class="k">def</span> <span class="nf">rowWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>        <span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): The triangular array of row</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        weights for the weighted simulation. Denoted by $t$ in Section 9</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a><span class="sd">        of the Paper.</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">)</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>    <span class="nd">@property</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>    <span class="k">def</span> <span class="nf">rowDistSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): A tuple of simulated row</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        distributions. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        `rowDistSims`[`row`][`state`] is denoted by $\theta_{m\ell}^*</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">        = u_m^*(\{\ell\})$ in Section 9 of the Paper.</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>    <span class="nd">@property</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>    <span class="k">def</span> <span class="nf">totalWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The total weight of the simulation. Denoted by $V$</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="sd">        in Section 9 of the Paper.</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>    <span class="k">def</span> <span class="nf">updateRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `rowWeights`, `rowDistSims`, and `totalWeight`</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">        properties, if necessary, so that the number of rows in</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">        `rowDistSims` is the same as the number of rows in the</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">        `IDPModel.rowCounts` property of the associated `idpModel`</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="sd">        instance.</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a><span class="sd">        **Raises:**</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="sd">        * **ValueError**: If the computed value for the `totalWeight`</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a>        <span class="c1"># If $L$ is the number of states in the IDP, then the case</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a>        <span class="c1"># $L = 2$ is separated from the case $2 &lt; L &lt; \infty$ to speed</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a>        <span class="c1"># up code execution.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a>        <span class="n">numStates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a>        <span class="c1"># expand properties if row counts have been added</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a>        <span class="n">numOldSims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">[</span><span class="n">numOldSims</span><span class="p">:]):</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">numOldSims</span> <span class="o">+</span> <span class="n">_</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a>            <span class="c1"># build `rowWeights[m]`</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>                    <span class="p">)</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>                    <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numStates</span><span class="p">):</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>                        <span class="n">weight</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">state</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>            <span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>            <span class="c1"># build `rowDistSims[m]`</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>            <span class="n">choice</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>            <span class="k">if</span> <span class="n">choice</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>                    <span class="n">rowDistSim</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>                    <span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rowDistSim</span><span class="p">,</span> <span class="n">rowDistSim</span><span class="p">])</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>                        <span class="c1"># vector sum fails for lists, works for ndarray</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>                        <span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">counts</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a>                        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>                    <span class="p">)</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a>            <span class="c1"># build `totalWeight`</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a>            <span class="c1">#</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a>            <span class="c1"># The m-th iteration of the `for` loop multiplies the</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a>            <span class="c1"># previous value of `totalWeight` by the (m + 1)-th factor</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a>            <span class="c1"># in the definition of $V$ in Section 9 of the Paper.</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>            <span class="p">)</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>        <span class="c1"># check that total weight is not out of bounds</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>            <span class="n">adj</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>                <span class="s1">&#39;Simulation weight out of bounds.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>                <span class="sa">f</span><span class="s1">&#39;Try adjusting scale factor by </span><span class="si">{</span><span class="n">adj</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>            <span class="p">)</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>        <span class="c1"># trim properties if row counts have been removed</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>        <span class="k">if</span> <span class="n">numOldSims</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">):</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>                <span class="n">numOldSims</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>            <span class="p">):</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">-=</span> <span class="p">(</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>                <span class="p">)</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>    <span class="k">def</span> <span class="nf">updateScale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `totalWeight` property, if necessary, to account</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a><span class="sd">        for a change in the `IDPModel.scale` property of the associated</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a><span class="sd">        `idpModel` instance.</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a><span class="sd">        **Raises:**</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a><span class="sd">        * **ValueError**: If the new value for the `totalWeight`</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a>        <span class="k">if</span> <span class="n">diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span> <span class="o">*</span> <span class="n">diff</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a>                    <span class="s1">&#39;Resulting simulation weight is out of bounds&#39;</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a>                <span class="p">)</span>
</span></pre></div>


            </section>
                <section id="IDPModel">
                            <input id="IDPModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">IDPModel</span>:

                <label class="view-source-button" for="IDPModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel-209"><a href="#IDPModel-209"><span class="linenos">209</span></a><span class="k">class</span> <span class="nc">IDPModel</span><span class="p">:</span>
</span><span id="IDPModel-210"><a href="#IDPModel-210"><span class="linenos">210</span></a>    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;An IDP model on the state space $S = \\{0, ..., L - 1\\}$.</span>
</span><span id="IDPModel-211"><a href="#IDPModel-211"><span class="linenos">211</span></a>
</span><span id="IDPModel-212"><a href="#IDPModel-212"><span class="linenos">212</span></a><span class="sd">    The IDP model consists of both an IDP and some observed data. See</span>
</span><span id="IDPModel-213"><a href="#IDPModel-213"><span class="linenos">213</span></a><span class="sd">    Section 9 of the Paper for details.</span>
</span><span id="IDPModel-214"><a href="#IDPModel-214"><span class="linenos">214</span></a>
</span><span id="IDPModel-215"><a href="#IDPModel-215"><span class="linenos">215</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="IDPModel-216"><a href="#IDPModel-216"><span class="linenos">216</span></a>
</span><span id="IDPModel-217"><a href="#IDPModel-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colConc</span><span class="p">,</span> <span class="n">rowConc</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">):</span>
</span><span id="IDPModel-218"><a href="#IDPModel-218"><span class="linenos">218</span></a>        <span class="sd">&#39;&#39;&#39;The constructor first uses the given arguments to set the</span>
</span><span id="IDPModel-219"><a href="#IDPModel-219"><span class="linenos">219</span></a><span class="sd">        corresponding properties. If a property returns a tuple or a</span>
</span><span id="IDPModel-220"><a href="#IDPModel-220"><span class="linenos">220</span></a><span class="sd">        tuple of tuples, then the argument can be passed any</span>
</span><span id="IDPModel-221"><a href="#IDPModel-221"><span class="linenos">221</span></a><span class="sd">        `array-like` object, such as a list or a list of lists.</span>
</span><span id="IDPModel-222"><a href="#IDPModel-222"><span class="linenos">222</span></a>
</span><span id="IDPModel-223"><a href="#IDPModel-223"><span class="linenos">223</span></a><span class="sd">        For the `baseMeas` property, the corresponding argument can be</span>
</span><span id="IDPModel-224"><a href="#IDPModel-224"><span class="linenos">224</span></a><span class="sd">        passed a single floating point value `p`, in which case the</span>
</span><span id="IDPModel-225"><a href="#IDPModel-225"><span class="linenos">225</span></a><span class="sd">        property will be set to `(1 - p, p)`.</span>
</span><span id="IDPModel-226"><a href="#IDPModel-226"><span class="linenos">226</span></a>
</span><span id="IDPModel-227"><a href="#IDPModel-227"><span class="linenos">227</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-228"><a href="#IDPModel-228"><span class="linenos">228</span></a>        <span class="c1"># `baseMeas` and `rowCounts` are stored as ndarrays rather than</span>
</span><span id="IDPModel-229"><a href="#IDPModel-229"><span class="linenos">229</span></a>        <span class="c1"># lists, since vector addition fails for lists but works for</span>
</span><span id="IDPModel-230"><a href="#IDPModel-230"><span class="linenos">230</span></a>        <span class="c1"># ndarrays. This is important in the constructor of the</span>
</span><span id="IDPModel-231"><a href="#IDPModel-231"><span class="linenos">231</span></a>        <span class="c1"># `WeightedSim` class.</span>
</span><span id="IDPModel-232"><a href="#IDPModel-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="IDPModel-233"><a href="#IDPModel-233"><span class="linenos">233</span></a>
</span><span id="IDPModel-234"><a href="#IDPModel-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="IDPModel-235"><a href="#IDPModel-235"><span class="linenos">235</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">]</span>
</span><span id="IDPModel-236"><a href="#IDPModel-236"><span class="linenos">236</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="IDPModel-237"><a href="#IDPModel-237"><span class="linenos">237</span></a>        <span class="n">rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-238"><a href="#IDPModel-238"><span class="linenos">238</span></a>
</span><span id="IDPModel-239"><a href="#IDPModel-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="IDPModel-240"><a href="#IDPModel-240"><span class="linenos">240</span></a>            <span class="s1">&#39;colConc&#39;</span><span class="p">:</span> <span class="n">colConc</span><span class="p">,</span>
</span><span id="IDPModel-241"><a href="#IDPModel-241"><span class="linenos">241</span></a>            <span class="s1">&#39;rowConc&#39;</span><span class="p">:</span> <span class="n">rowConc</span><span class="p">,</span>
</span><span id="IDPModel-242"><a href="#IDPModel-242"><span class="linenos">242</span></a>            <span class="s1">&#39;baseMeas&#39;</span><span class="p">:</span> <span class="n">baseMeas</span>
</span><span id="IDPModel-243"><a href="#IDPModel-243"><span class="linenos">243</span></a>        <span class="p">}</span>
</span><span id="IDPModel-244"><a href="#IDPModel-244"><span class="linenos">244</span></a>
</span><span id="IDPModel-245"><a href="#IDPModel-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">rowCounts</span>
</span><span id="IDPModel-246"><a href="#IDPModel-246"><span class="linenos">246</span></a>
</span><span id="IDPModel-247"><a href="#IDPModel-247"><span class="linenos">247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="IDPModel-248"><a href="#IDPModel-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="IDPModel-249"><a href="#IDPModel-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="IDPModel-250"><a href="#IDPModel-250"><span class="linenos">250</span></a>
</span><span id="IDPModel-251"><a href="#IDPModel-251"><span class="linenos">251</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-252"><a href="#IDPModel-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">colConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-253"><a href="#IDPModel-253"><span class="linenos">253</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The column concentration parameter. Should be</span>
</span><span id="IDPModel-254"><a href="#IDPModel-254"><span class="linenos">254</span></a><span class="sd">        positive. Denoted by $\kappa$ in Section 9 of the Paper.</span>
</span><span id="IDPModel-255"><a href="#IDPModel-255"><span class="linenos">255</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-256"><a href="#IDPModel-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-257"><a href="#IDPModel-257"><span class="linenos">257</span></a>
</span><span id="IDPModel-258"><a href="#IDPModel-258"><span class="linenos">258</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-259"><a href="#IDPModel-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">rowConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-260"><a href="#IDPModel-260"><span class="linenos">260</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The row concentration parameter. Should be</span>
</span><span id="IDPModel-261"><a href="#IDPModel-261"><span class="linenos">261</span></a><span class="sd">        positive. Denoted by $\varepsilon$ in Section 9 of the Paper.</span>
</span><span id="IDPModel-262"><a href="#IDPModel-262"><span class="linenos">262</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-263"><a href="#IDPModel-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-264"><a href="#IDPModel-264"><span class="linenos">264</span></a>
</span><span id="IDPModel-265"><a href="#IDPModel-265"><span class="linenos">265</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-266"><a href="#IDPModel-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">baseMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-267"><a href="#IDPModel-267"><span class="linenos">267</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The base probability vector. Should be a</span>
</span><span id="IDPModel-268"><a href="#IDPModel-268"><span class="linenos">268</span></a><span class="sd">        list of positive numbers that sum to 1. Denoted by</span>
</span><span id="IDPModel-269"><a href="#IDPModel-269"><span class="linenos">269</span></a><span class="sd">        $\boldsymbol{p} = (p_0, \ldots, p_{L - 1})$ in Section 9 of the</span>
</span><span id="IDPModel-270"><a href="#IDPModel-270"><span class="linenos">270</span></a><span class="sd">        Paper, where $p_\ell = \varrho(\{\ell\})$.</span>
</span><span id="IDPModel-271"><a href="#IDPModel-271"><span class="linenos">271</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-272"><a href="#IDPModel-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">])</span>
</span><span id="IDPModel-273"><a href="#IDPModel-273"><span class="linenos">273</span></a>
</span><span id="IDPModel-274"><a href="#IDPModel-274"><span class="linenos">274</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-275"><a href="#IDPModel-275"><span class="linenos">275</span></a>    <span class="k">def</span> <span class="nf">rowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-276"><a href="#IDPModel-276"><span class="linenos">276</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`int`)): The row counts for the observed</span>
</span><span id="IDPModel-277"><a href="#IDPModel-277"><span class="linenos">277</span></a><span class="sd">        data. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="IDPModel-278"><a href="#IDPModel-278"><span class="linenos">278</span></a><span class="sd">        `rowCounts`[`row`][`state`] is denoted by $\overline{y}_{m\ell}$</span>
</span><span id="IDPModel-279"><a href="#IDPModel-279"><span class="linenos">279</span></a><span class="sd">        in Section 9 of the Paper. It is the number of observed</span>
</span><span id="IDPModel-280"><a href="#IDPModel-280"><span class="linenos">280</span></a><span class="sd">        instances of `state` in the given row of data.</span>
</span><span id="IDPModel-281"><a href="#IDPModel-281"><span class="linenos">281</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-282"><a href="#IDPModel-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-283"><a href="#IDPModel-283"><span class="linenos">283</span></a>
</span><span id="IDPModel-284"><a href="#IDPModel-284"><span class="linenos">284</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-285"><a href="#IDPModel-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">likelihoods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-286"><a href="#IDPModel-286"><span class="linenos">286</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The prior likelihoods. If `row` equals</span>
</span><span id="IDPModel-287"><a href="#IDPModel-287"><span class="linenos">287</span></a><span class="sd">        $m - 1$, then `likelihoods`[`row`] is denoted by</span>
</span><span id="IDPModel-288"><a href="#IDPModel-288"><span class="linenos">288</span></a><span class="sd">        $\varrho_N(A_m)$ in Section 9 of the Paper. It is the prior</span>
</span><span id="IDPModel-289"><a href="#IDPModel-289"><span class="linenos">289</span></a><span class="sd">        probability of seeing the row counts for the given row. This</span>
</span><span id="IDPModel-290"><a href="#IDPModel-290"><span class="linenos">290</span></a><span class="sd">        property is computed by the constructor, and should not be</span>
</span><span id="IDPModel-291"><a href="#IDPModel-291"><span class="linenos">291</span></a><span class="sd">        changed.</span>
</span><span id="IDPModel-292"><a href="#IDPModel-292"><span class="linenos">292</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-293"><a href="#IDPModel-293"><span class="linenos">293</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">):</span>
</span><span id="IDPModel-294"><a href="#IDPModel-294"><span class="linenos">294</span></a>            <span class="n">rowConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-295"><a href="#IDPModel-295"><span class="linenos">295</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="IDPModel-296"><a href="#IDPModel-296"><span class="linenos">296</span></a>            <span class="n">denom</span> <span class="o">=</span> <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">)</span>
</span><span id="IDPModel-297"><a href="#IDPModel-297"><span class="linenos">297</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">):]:</span>
</span><span id="IDPModel-298"><a href="#IDPModel-298"><span class="linenos">298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="IDPModel-299"><a href="#IDPModel-299"><span class="linenos">299</span></a>                    <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="IDPModel-300"><a href="#IDPModel-300"><span class="linenos">300</span></a>                <span class="p">)</span>
</span><span id="IDPModel-301"><a href="#IDPModel-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span>
</span><span id="IDPModel-302"><a href="#IDPModel-302"><span class="linenos">302</span></a>
</span><span id="IDPModel-303"><a href="#IDPModel-303"><span class="linenos">303</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-304"><a href="#IDPModel-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-305"><a href="#IDPModel-305"><span class="linenos">305</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The scale factor to use for weighted simulations.</span>
</span><span id="IDPModel-306"><a href="#IDPModel-306"><span class="linenos">306</span></a><span class="sd">        Denoted by $\log c$ in Section 9 of the Paper. Defaults to 0.</span>
</span><span id="IDPModel-307"><a href="#IDPModel-307"><span class="linenos">307</span></a><span class="sd">        Altering this value runs the `WeightedSim.updateScale` method on</span>
</span><span id="IDPModel-308"><a href="#IDPModel-308"><span class="linenos">308</span></a><span class="sd">        every simulation in the `weightedSims` property. If a</span>
</span><span id="IDPModel-309"><a href="#IDPModel-309"><span class="linenos">309</span></a><span class="sd">        `ValueError` occurs in this process, then no changes will be</span>
</span><span id="IDPModel-310"><a href="#IDPModel-310"><span class="linenos">310</span></a><span class="sd">        made, neither to the `scale` property, nor to any of the</span>
</span><span id="IDPModel-311"><a href="#IDPModel-311"><span class="linenos">311</span></a><span class="sd">        simulations in the `weightedSims` property.</span>
</span><span id="IDPModel-312"><a href="#IDPModel-312"><span class="linenos">312</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-313"><a href="#IDPModel-313"><span class="linenos">313</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="IDPModel-314"><a href="#IDPModel-314"><span class="linenos">314</span></a>
</span><span id="IDPModel-315"><a href="#IDPModel-315"><span class="linenos">315</span></a>    <span class="nd">@scale</span><span class="o">.</span><span class="n">setter</span>
</span><span id="IDPModel-316"><a href="#IDPModel-316"><span class="linenos">316</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="IDPModel-317"><a href="#IDPModel-317"><span class="linenos">317</span></a>        <span class="n">oldVal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="IDPModel-318"><a href="#IDPModel-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="IDPModel-319"><a href="#IDPModel-319"><span class="linenos">319</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="IDPModel-320"><a href="#IDPModel-320"><span class="linenos">320</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel-321"><a href="#IDPModel-321"><span class="linenos">321</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateScale</span><span class="p">()</span>
</span><span id="IDPModel-322"><a href="#IDPModel-322"><span class="linenos">322</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="IDPModel-323"><a href="#IDPModel-323"><span class="linenos">323</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">oldVal</span>
</span><span id="IDPModel-324"><a href="#IDPModel-324"><span class="linenos">324</span></a>            <span class="k">raise</span>
</span><span id="IDPModel-325"><a href="#IDPModel-325"><span class="linenos">325</span></a>
</span><span id="IDPModel-326"><a href="#IDPModel-326"><span class="linenos">326</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-327"><a href="#IDPModel-327"><span class="linenos">327</span></a>    <span class="k">def</span> <span class="nf">weightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-328"><a href="#IDPModel-328"><span class="linenos">328</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`WeightedSim`): A tuple of distinct (and therefore</span>
</span><span id="IDPModel-329"><a href="#IDPModel-329"><span class="linenos">329</span></a><span class="sd">        independent) `WeightedSim` instances. `weightedSims`[k] is</span>
</span><span id="IDPModel-330"><a href="#IDPModel-330"><span class="linenos">330</span></a><span class="sd">        denoted by $(t^k, \boldsymbol{\theta}_M^{*, k})$ in Section 9 of</span>
</span><span id="IDPModel-331"><a href="#IDPModel-331"><span class="linenos">331</span></a><span class="sd">        the Paper, and has total weight $V^{(k)}$. This property is</span>
</span><span id="IDPModel-332"><a href="#IDPModel-332"><span class="linenos">332</span></a><span class="sd">        empty if the `addWeightedSims` method has never been run.</span>
</span><span id="IDPModel-333"><a href="#IDPModel-333"><span class="linenos">333</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-334"><a href="#IDPModel-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">)</span>
</span><span id="IDPModel-335"><a href="#IDPModel-335"><span class="linenos">335</span></a>
</span><span id="IDPModel-336"><a href="#IDPModel-336"><span class="linenos">336</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel-337"><a href="#IDPModel-337"><span class="linenos">337</span></a>    <span class="k">def</span> <span class="nf">bandwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-338"><a href="#IDPModel-338"><span class="linenos">338</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The bandwidth used most recently by the `meanRDGpdf`</span>
</span><span id="IDPModel-339"><a href="#IDPModel-339"><span class="linenos">339</span></a><span class="sd">        method. Is `None` if this method has never been used.</span>
</span><span id="IDPModel-340"><a href="#IDPModel-340"><span class="linenos">340</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-341"><a href="#IDPModel-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span>
</span><span id="IDPModel-342"><a href="#IDPModel-342"><span class="linenos">342</span></a>
</span><span id="IDPModel-343"><a href="#IDPModel-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">addRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">):</span>
</span><span id="IDPModel-344"><a href="#IDPModel-344"><span class="linenos">344</span></a>        <span class="sd">&#39;&#39;&#39;Adds new row counts to the `rowCounts` property and runs the</span>
</span><span id="IDPModel-345"><a href="#IDPModel-345"><span class="linenos">345</span></a><span class="sd">        `WeightedSim.updateRowCounts` method on every simulation in the</span>
</span><span id="IDPModel-346"><a href="#IDPModel-346"><span class="linenos">346</span></a><span class="sd">        `weightedSims` property. If a `ValueError` occurs in this</span>
</span><span id="IDPModel-347"><a href="#IDPModel-347"><span class="linenos">347</span></a><span class="sd">        process, then no changes will be made, neither to the</span>
</span><span id="IDPModel-348"><a href="#IDPModel-348"><span class="linenos">348</span></a><span class="sd">        `rowCounts` property, nor to any of the simulations in the</span>
</span><span id="IDPModel-349"><a href="#IDPModel-349"><span class="linenos">349</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel-350"><a href="#IDPModel-350"><span class="linenos">350</span></a>
</span><span id="IDPModel-351"><a href="#IDPModel-351"><span class="linenos">351</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-352"><a href="#IDPModel-352"><span class="linenos">352</span></a>
</span><span id="IDPModel-353"><a href="#IDPModel-353"><span class="linenos">353</span></a><span class="sd">        * **newRowCounts** (`array_like`): The additional row counts to</span>
</span><span id="IDPModel-354"><a href="#IDPModel-354"><span class="linenos">354</span></a><span class="sd">            be added. Should be an array-like object (such as a list of</span>
</span><span id="IDPModel-355"><a href="#IDPModel-355"><span class="linenos">355</span></a><span class="sd">            lists) with the same number of columns (states) as</span>
</span><span id="IDPModel-356"><a href="#IDPModel-356"><span class="linenos">356</span></a><span class="sd">            `rowCounts`.</span>
</span><span id="IDPModel-357"><a href="#IDPModel-357"><span class="linenos">357</span></a>
</span><span id="IDPModel-358"><a href="#IDPModel-358"><span class="linenos">358</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-359"><a href="#IDPModel-359"><span class="linenos">359</span></a>        <span class="n">oldRowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span>
</span><span id="IDPModel-360"><a href="#IDPModel-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">))</span>
</span><span id="IDPModel-361"><a href="#IDPModel-361"><span class="linenos">361</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="IDPModel-362"><a href="#IDPModel-362"><span class="linenos">362</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel-363"><a href="#IDPModel-363"><span class="linenos">363</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="IDPModel-364"><a href="#IDPModel-364"><span class="linenos">364</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="IDPModel-365"><a href="#IDPModel-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">oldRowCounts</span>
</span><span id="IDPModel-366"><a href="#IDPModel-366"><span class="linenos">366</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel-367"><a href="#IDPModel-367"><span class="linenos">367</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="IDPModel-368"><a href="#IDPModel-368"><span class="linenos">368</span></a>            <span class="k">raise</span>
</span><span id="IDPModel-369"><a href="#IDPModel-369"><span class="linenos">369</span></a>
</span><span id="IDPModel-370"><a href="#IDPModel-370"><span class="linenos">370</span></a>    <span class="k">def</span> <span class="nf">delRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numRows</span><span class="p">):</span>
</span><span id="IDPModel-371"><a href="#IDPModel-371"><span class="linenos">371</span></a>        <span class="sd">&#39;&#39;&#39;Deletes the last `numRows` rows of the `rowCounts` property,</span>
</span><span id="IDPModel-372"><a href="#IDPModel-372"><span class="linenos">372</span></a><span class="sd">        then runs the `WeightedSim.updateRowCounts` method on every</span>
</span><span id="IDPModel-373"><a href="#IDPModel-373"><span class="linenos">373</span></a><span class="sd">        simulation in the `weightedSims` property.</span>
</span><span id="IDPModel-374"><a href="#IDPModel-374"><span class="linenos">374</span></a>
</span><span id="IDPModel-375"><a href="#IDPModel-375"><span class="linenos">375</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-376"><a href="#IDPModel-376"><span class="linenos">376</span></a>
</span><span id="IDPModel-377"><a href="#IDPModel-377"><span class="linenos">377</span></a><span class="sd">        * **numRows** (`int`): The number of rows to delete.</span>
</span><span id="IDPModel-378"><a href="#IDPModel-378"><span class="linenos">378</span></a>
</span><span id="IDPModel-379"><a href="#IDPModel-379"><span class="linenos">379</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-380"><a href="#IDPModel-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[:</span><span class="o">-</span><span class="n">numRows</span><span class="p">]</span>
</span><span id="IDPModel-381"><a href="#IDPModel-381"><span class="linenos">381</span></a>        <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel-382"><a href="#IDPModel-382"><span class="linenos">382</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="IDPModel-383"><a href="#IDPModel-383"><span class="linenos">383</span></a>
</span><span id="IDPModel-384"><a href="#IDPModel-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">addWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
</span><span id="IDPModel-385"><a href="#IDPModel-385"><span class="linenos">385</span></a>        <span class="sd">&#39;&#39;&#39;Creates new `WeightedSim` instances and adds them to the</span>
</span><span id="IDPModel-386"><a href="#IDPModel-386"><span class="linenos">386</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel-387"><a href="#IDPModel-387"><span class="linenos">387</span></a>
</span><span id="IDPModel-388"><a href="#IDPModel-388"><span class="linenos">388</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-389"><a href="#IDPModel-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="IDPModel-390"><a href="#IDPModel-390"><span class="linenos">390</span></a><span class="sd">        * **num** (`int`): The number of distinct `WeightedSim`</span>
</span><span id="IDPModel-391"><a href="#IDPModel-391"><span class="linenos">391</span></a><span class="sd">            instances to create. If zero or negative, no instances are</span>
</span><span id="IDPModel-392"><a href="#IDPModel-392"><span class="linenos">392</span></a><span class="sd">            created.</span>
</span><span id="IDPModel-393"><a href="#IDPModel-393"><span class="linenos">393</span></a>
</span><span id="IDPModel-394"><a href="#IDPModel-394"><span class="linenos">394</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-395"><a href="#IDPModel-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IDPModel-396"><a href="#IDPModel-396"><span class="linenos">396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">+=</span> <span class="p">[</span><span class="n">WeightedSim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
</span><span id="IDPModel-397"><a href="#IDPModel-397"><span class="linenos">397</span></a>
</span><span id="IDPModel-398"><a href="#IDPModel-398"><span class="linenos">398</span></a>    <span class="k">def</span> <span class="nf">clearWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel-399"><a href="#IDPModel-399"><span class="linenos">399</span></a>        <span class="sd">&#39;&#39;&#39;Deletes all weighted simulations contained in the</span>
</span><span id="IDPModel-400"><a href="#IDPModel-400"><span class="linenos">400</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel-401"><a href="#IDPModel-401"><span class="linenos">401</span></a>
</span><span id="IDPModel-402"><a href="#IDPModel-402"><span class="linenos">402</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-403"><a href="#IDPModel-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="IDPModel-404"><a href="#IDPModel-404"><span class="linenos">404</span></a>
</span><span id="IDPModel-405"><a href="#IDPModel-405"><span class="linenos">405</span></a>    <span class="k">def</span> <span class="nf">postProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="IDPModel-406"><a href="#IDPModel-406"><span class="linenos">406</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Computes and returns the posterior probability of seeing the</span>
</span><span id="IDPModel-407"><a href="#IDPModel-407"><span class="linenos">407</span></a><span class="sd">        given state on a new trial in the given row. If `row` is</span>
</span><span id="IDPModel-408"><a href="#IDPModel-408"><span class="linenos">408</span></a><span class="sd">        $m - 1$, `state` is $\ell$ , and the length of `rowCounts` is</span>
</span><span id="IDPModel-409"><a href="#IDPModel-409"><span class="linenos">409</span></a><span class="sd">        $M$, then the value returned by this method is denoted in the</span>
</span><span id="IDPModel-410"><a href="#IDPModel-410"><span class="linenos">410</span></a><span class="sd">        Paper by $P(\xi_{m, N_m + \ell} = 1 \mid Y = y)$ in the case</span>
</span><span id="IDPModel-411"><a href="#IDPModel-411"><span class="linenos">411</span></a><span class="sd">        $m \le M$, and by $P(\xi_{M + 1, 1} = \ell \mid Y = y)$ in the</span>
</span><span id="IDPModel-412"><a href="#IDPModel-412"><span class="linenos">412</span></a><span class="sd">        case $m &gt; M$. This method implements (9.4) and (9.5) in the</span>
</span><span id="IDPModel-413"><a href="#IDPModel-413"><span class="linenos">413</span></a><span class="sd">        Paper.</span>
</span><span id="IDPModel-414"><a href="#IDPModel-414"><span class="linenos">414</span></a>
</span><span id="IDPModel-415"><a href="#IDPModel-415"><span class="linenos">415</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-416"><a href="#IDPModel-416"><span class="linenos">416</span></a>
</span><span id="IDPModel-417"><a href="#IDPModel-417"><span class="linenos">417</span></a><span class="sd">        * **row** (`int`): The index of the row whose posterior</span>
</span><span id="IDPModel-418"><a href="#IDPModel-418"><span class="linenos">418</span></a><span class="sd">            probability should be computed.</span>
</span><span id="IDPModel-419"><a href="#IDPModel-419"><span class="linenos">419</span></a><span class="sd">        * **state** (`int`): The state whose posterior probability</span>
</span><span id="IDPModel-420"><a href="#IDPModel-420"><span class="linenos">420</span></a><span class="sd">            should be computed.</span>
</span><span id="IDPModel-421"><a href="#IDPModel-421"><span class="linenos">421</span></a>
</span><span id="IDPModel-422"><a href="#IDPModel-422"><span class="linenos">422</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel-423"><a href="#IDPModel-423"><span class="linenos">423</span></a>
</span><span id="IDPModel-424"><a href="#IDPModel-424"><span class="linenos">424</span></a><span class="sd">        * `float`: The posterior probability of seeing the given state.</span>
</span><span id="IDPModel-425"><a href="#IDPModel-425"><span class="linenos">425</span></a>
</span><span id="IDPModel-426"><a href="#IDPModel-426"><span class="linenos">426</span></a><span class="sd">        **Raises:**</span>
</span><span id="IDPModel-427"><a href="#IDPModel-427"><span class="linenos">427</span></a>
</span><span id="IDPModel-428"><a href="#IDPModel-428"><span class="linenos">428</span></a><span class="sd">        * **ValueError**: If the `weightedSims` property is empty.</span>
</span><span id="IDPModel-429"><a href="#IDPModel-429"><span class="linenos">429</span></a>
</span><span id="IDPModel-430"><a href="#IDPModel-430"><span class="linenos">430</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-431"><a href="#IDPModel-431"><span class="linenos">431</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel-432"><a href="#IDPModel-432"><span class="linenos">432</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No weighted simulations found&#39;</span><span class="p">)</span>
</span><span id="IDPModel-433"><a href="#IDPModel-433"><span class="linenos">433</span></a>
</span><span id="IDPModel-434"><a href="#IDPModel-434"><span class="linenos">434</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-435"><a href="#IDPModel-435"><span class="linenos">435</span></a>        <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">numRows</span><span class="p">:</span>
</span><span id="IDPModel-436"><a href="#IDPModel-436"><span class="linenos">436</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel-437"><a href="#IDPModel-437"><span class="linenos">437</span></a>
</span><span id="IDPModel-438"><a href="#IDPModel-438"><span class="linenos">438</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-439"><a href="#IDPModel-439"><span class="linenos">439</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="IDPModel-440"><a href="#IDPModel-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel-441"><a href="#IDPModel-441"><span class="linenos">441</span></a>            <span class="n">colConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="IDPModel-442"><a href="#IDPModel-442"><span class="linenos">442</span></a>            <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">))</span>
</span><span id="IDPModel-443"><a href="#IDPModel-443"><span class="linenos">443</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">)</span>
</span><span id="IDPModel-444"><a href="#IDPModel-444"><span class="linenos">444</span></a>
</span><span id="IDPModel-445"><a href="#IDPModel-445"><span class="linenos">445</span></a>    <span class="k">def</span> <span class="nf">_postProbLow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="IDPModel-446"><a href="#IDPModel-446"><span class="linenos">446</span></a>        <span class="sd">&#39;&#39;&#39;This method is the same as `postProb`, except it requires</span>
</span><span id="IDPModel-447"><a href="#IDPModel-447"><span class="linenos">447</span></a><span class="sd">        `row` to be less than the length of `rowCounts`.</span>
</span><span id="IDPModel-448"><a href="#IDPModel-448"><span class="linenos">448</span></a>
</span><span id="IDPModel-449"><a href="#IDPModel-449"><span class="linenos">449</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-450"><a href="#IDPModel-450"><span class="linenos">450</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="IDPModel-451"><a href="#IDPModel-451"><span class="linenos">451</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span> <span class="o">*</span> <span class="n">weightedSim</span><span class="o">.</span><span class="n">rowDistSims</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">state</span><span class="p">]</span>
</span><span id="IDPModel-452"><a href="#IDPModel-452"><span class="linenos">452</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="IDPModel-453"><a href="#IDPModel-453"><span class="linenos">453</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span>
</span><span id="IDPModel-454"><a href="#IDPModel-454"><span class="linenos">454</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span>
</span><span id="IDPModel-455"><a href="#IDPModel-455"><span class="linenos">455</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="IDPModel-456"><a href="#IDPModel-456"><span class="linenos">456</span></a>        <span class="p">)</span>
</span><span id="IDPModel-457"><a href="#IDPModel-457"><span class="linenos">457</span></a>
</span><span id="IDPModel-458"><a href="#IDPModel-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">meanRDGcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="IDPModel-459"><a href="#IDPModel-459"><span class="linenos">459</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;The mean of the row distribution generator (RDG) for a state</span>
</span><span id="IDPModel-460"><a href="#IDPModel-460"><span class="linenos">460</span></a><span class="sd">        $\ell$ is a probability distribution on $[0, 1]$. More</span>
</span><span id="IDPModel-461"><a href="#IDPModel-461"><span class="linenos">461</span></a><span class="sd">        specifically, using the notation in the Paper, it is the</span>
</span><span id="IDPModel-462"><a href="#IDPModel-462"><span class="linenos">462</span></a><span class="sd">        conditional distribution of $\theta_{M + 1, \ell}$ given</span>
</span><span id="IDPModel-463"><a href="#IDPModel-463"><span class="linenos">463</span></a><span class="sd">        $Y = y$, and an expression for it is given in (9.6) in the</span>
</span><span id="IDPModel-464"><a href="#IDPModel-464"><span class="linenos">464</span></a><span class="sd">        Paper.</span>
</span><span id="IDPModel-465"><a href="#IDPModel-465"><span class="linenos">465</span></a>
</span><span id="IDPModel-466"><a href="#IDPModel-466"><span class="linenos">466</span></a><span class="sd">        This method evaluates the cumulative distribution function (cdf)</span>
</span><span id="IDPModel-467"><a href="#IDPModel-467"><span class="linenos">467</span></a><span class="sd">        of the mean of the RDG for the given state at the given point.</span>
</span><span id="IDPModel-468"><a href="#IDPModel-468"><span class="linenos">468</span></a><span class="sd">        That is, it gives the cdf for the random probability of seeing</span>
</span><span id="IDPModel-469"><a href="#IDPModel-469"><span class="linenos">469</span></a><span class="sd">        the given state in a new trial.</span>
</span><span id="IDPModel-470"><a href="#IDPModel-470"><span class="linenos">470</span></a>
</span><span id="IDPModel-471"><a href="#IDPModel-471"><span class="linenos">471</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-472"><a href="#IDPModel-472"><span class="linenos">472</span></a>
</span><span id="IDPModel-473"><a href="#IDPModel-473"><span class="linenos">473</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the cdf.</span>
</span><span id="IDPModel-474"><a href="#IDPModel-474"><span class="linenos">474</span></a><span class="sd">        * **state** (`int`): The state for which the cdf is to be</span>
</span><span id="IDPModel-475"><a href="#IDPModel-475"><span class="linenos">475</span></a><span class="sd">            computed.</span>
</span><span id="IDPModel-476"><a href="#IDPModel-476"><span class="linenos">476</span></a>
</span><span id="IDPModel-477"><a href="#IDPModel-477"><span class="linenos">477</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel-478"><a href="#IDPModel-478"><span class="linenos">478</span></a>
</span><span id="IDPModel-479"><a href="#IDPModel-479"><span class="linenos">479</span></a><span class="sd">        * `float`: The value of the cdf at the given point.</span>
</span><span id="IDPModel-480"><a href="#IDPModel-480"><span class="linenos">480</span></a>
</span><span id="IDPModel-481"><a href="#IDPModel-481"><span class="linenos">481</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-482"><a href="#IDPModel-482"><span class="linenos">482</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-483"><a href="#IDPModel-483"><span class="linenos">483</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-484"><a href="#IDPModel-484"><span class="linenos">484</span></a>
</span><span id="IDPModel-485"><a href="#IDPModel-485"><span class="linenos">485</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel-486"><a href="#IDPModel-486"><span class="linenos">486</span></a>        <span class="n">sampleCDF</span> <span class="o">=</span> <span class="n">ECDFDiscrete</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="IDPModel-487"><a href="#IDPModel-487"><span class="linenos">487</span></a>
</span><span id="IDPModel-488"><a href="#IDPModel-488"><span class="linenos">488</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel-489"><a href="#IDPModel-489"><span class="linenos">489</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="IDPModel-490"><a href="#IDPModel-490"><span class="linenos">490</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">sampleCDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="IDPModel-491"><a href="#IDPModel-491"><span class="linenos">491</span></a>        <span class="p">)</span>
</span><span id="IDPModel-492"><a href="#IDPModel-492"><span class="linenos">492</span></a>
</span><span id="IDPModel-493"><a href="#IDPModel-493"><span class="linenos">493</span></a>    <span class="k">def</span> <span class="nf">_prior</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="IDPModel-494"><a href="#IDPModel-494"><span class="linenos">494</span></a>        <span class="sd">&#39;&#39;&#39;Returns the prior distribution of the mean RDG for the given</span>
</span><span id="IDPModel-495"><a href="#IDPModel-495"><span class="linenos">495</span></a><span class="sd">        state.</span>
</span><span id="IDPModel-496"><a href="#IDPModel-496"><span class="linenos">496</span></a>
</span><span id="IDPModel-497"><a href="#IDPModel-497"><span class="linenos">497</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-498"><a href="#IDPModel-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="n">beta</span><span class="p">(</span>
</span><span id="IDPModel-499"><a href="#IDPModel-499"><span class="linenos">499</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">],</span>
</span><span id="IDPModel-500"><a href="#IDPModel-500"><span class="linenos">500</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">][</span><span class="n">state</span><span class="p">])</span>
</span><span id="IDPModel-501"><a href="#IDPModel-501"><span class="linenos">501</span></a>        <span class="p">)</span>
</span><span id="IDPModel-502"><a href="#IDPModel-502"><span class="linenos">502</span></a>
</span><span id="IDPModel-503"><a href="#IDPModel-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">_makeSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
</span><span id="IDPModel-504"><a href="#IDPModel-504"><span class="linenos">504</span></a>        <span class="sd">&#39;&#39;&#39;Creates and returns a weighted list of simulated row</span>
</span><span id="IDPModel-505"><a href="#IDPModel-505"><span class="linenos">505</span></a><span class="sd">        distributions evaluated at the given state. Used to create the</span>
</span><span id="IDPModel-506"><a href="#IDPModel-506"><span class="linenos">506</span></a><span class="sd">        empirical distribution of the mean RDG.</span>
</span><span id="IDPModel-507"><a href="#IDPModel-507"><span class="linenos">507</span></a>
</span><span id="IDPModel-508"><a href="#IDPModel-508"><span class="linenos">508</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-509"><a href="#IDPModel-509"><span class="linenos">509</span></a>        <span class="c1"># The `sample` vector is ordered as</span>
</span><span id="IDPModel-510"><a href="#IDPModel-510"><span class="linenos">510</span></a>        <span class="c1"># \[</span>
</span><span id="IDPModel-511"><a href="#IDPModel-511"><span class="linenos">511</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, 1}, \ldots, \theta_{M \ell}^{*, 1},</span>
</span><span id="IDPModel-512"><a href="#IDPModel-512"><span class="linenos">512</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, 2}, \ldots, \theta_{M \ell}^{*, 2},</span>
</span><span id="IDPModel-513"><a href="#IDPModel-513"><span class="linenos">513</span></a>        <span class="c1">#   \ldots,</span>
</span><span id="IDPModel-514"><a href="#IDPModel-514"><span class="linenos">514</span></a>        <span class="c1">#   \theta_{1 \ell}^{*, K}, \ldots, \theta_{M \ell}^{*, K}</span>
</span><span id="IDPModel-515"><a href="#IDPModel-515"><span class="linenos">515</span></a>        <span class="c1"># \]</span>
</span><span id="IDPModel-516"><a href="#IDPModel-516"><span class="linenos">516</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-517"><a href="#IDPModel-517"><span class="linenos">517</span></a>        <span class="n">sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="IDPModel-518"><a href="#IDPModel-518"><span class="linenos">518</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">rowDistSims</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">state</span><span class="p">]</span>
</span><span id="IDPModel-519"><a href="#IDPModel-519"><span class="linenos">519</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="c1"># outer loop</span>
</span><span id="IDPModel-520"><a href="#IDPModel-520"><span class="linenos">520</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">)</span>  <span class="c1"># inner loop</span>
</span><span id="IDPModel-521"><a href="#IDPModel-521"><span class="linenos">521</span></a>        <span class="p">])</span>
</span><span id="IDPModel-522"><a href="#IDPModel-522"><span class="linenos">522</span></a>        <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
</span><span id="IDPModel-523"><a href="#IDPModel-523"><span class="linenos">523</span></a>            <span class="p">[</span><span class="n">weightedSim</span><span class="o">.</span><span class="n">totalWeight</span><span class="p">]</span> <span class="o">*</span> <span class="n">numRows</span>
</span><span id="IDPModel-524"><a href="#IDPModel-524"><span class="linenos">524</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span>
</span><span id="IDPModel-525"><a href="#IDPModel-525"><span class="linenos">525</span></a>        <span class="p">])</span>
</span><span id="IDPModel-526"><a href="#IDPModel-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span>
</span><span id="IDPModel-527"><a href="#IDPModel-527"><span class="linenos">527</span></a>
</span><span id="IDPModel-528"><a href="#IDPModel-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">meanRDGpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IDPModel-529"><a href="#IDPModel-529"><span class="linenos">529</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;This method evaluates an approximate density (pdf) for the</span>
</span><span id="IDPModel-530"><a href="#IDPModel-530"><span class="linenos">530</span></a><span class="sd">        mean of the RDG for the given state. (See `meanRDGcdf` for an</span>
</span><span id="IDPModel-531"><a href="#IDPModel-531"><span class="linenos">531</span></a><span class="sd">        explanation of the RDG.) The mean of the RDG has a discrete</span>
</span><span id="IDPModel-532"><a href="#IDPModel-532"><span class="linenos">532</span></a><span class="sd">        component, and therefore has no density. This method creates an</span>
</span><span id="IDPModel-533"><a href="#IDPModel-533"><span class="linenos">533</span></a><span class="sd">        approximate density using Gaussian kernel density estimation</span>
</span><span id="IDPModel-534"><a href="#IDPModel-534"><span class="linenos">534</span></a><span class="sd">        (KDE). More specifically, it treats the point mass $\delta_x$ as</span>
</span><span id="IDPModel-535"><a href="#IDPModel-535"><span class="linenos">535</span></a><span class="sd">        having a Gaussian density with mean $x$ and standard deviation</span>
</span><span id="IDPModel-536"><a href="#IDPModel-536"><span class="linenos">536</span></a><span class="sd">        $h$, where $h$ is the &quot;bandwidth&quot; of the estimate.</span>
</span><span id="IDPModel-537"><a href="#IDPModel-537"><span class="linenos">537</span></a>
</span><span id="IDPModel-538"><a href="#IDPModel-538"><span class="linenos">538</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel-539"><a href="#IDPModel-539"><span class="linenos">539</span></a>
</span><span id="IDPModel-540"><a href="#IDPModel-540"><span class="linenos">540</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the</span>
</span><span id="IDPModel-541"><a href="#IDPModel-541"><span class="linenos">541</span></a><span class="sd">            approximate pdf.</span>
</span><span id="IDPModel-542"><a href="#IDPModel-542"><span class="linenos">542</span></a><span class="sd">        * **state** (`int`): The state for which the pdf is to be</span>
</span><span id="IDPModel-543"><a href="#IDPModel-543"><span class="linenos">543</span></a><span class="sd">            computed.</span>
</span><span id="IDPModel-544"><a href="#IDPModel-544"><span class="linenos">544</span></a><span class="sd">        * **bandwidth** (`float`): The bandwidth to use in the Gaussian</span>
</span><span id="IDPModel-545"><a href="#IDPModel-545"><span class="linenos">545</span></a><span class="sd">            KDE. If omitted, the bandwidth will be calculated using</span>
</span><span id="IDPModel-546"><a href="#IDPModel-546"><span class="linenos">546</span></a><span class="sd">            Scott&#39;s Rule. The calculated value can be retrieved using</span>
</span><span id="IDPModel-547"><a href="#IDPModel-547"><span class="linenos">547</span></a><span class="sd">            the `bandwidth` property. This argument is passed directly</span>
</span><span id="IDPModel-548"><a href="#IDPModel-548"><span class="linenos">548</span></a><span class="sd">            to the `gaussian_kde` function in the `scipy.stats` module.</span>
</span><span id="IDPModel-549"><a href="#IDPModel-549"><span class="linenos">549</span></a><span class="sd">            See that documentation for further details.</span>
</span><span id="IDPModel-550"><a href="#IDPModel-550"><span class="linenos">550</span></a>
</span><span id="IDPModel-551"><a href="#IDPModel-551"><span class="linenos">551</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel-552"><a href="#IDPModel-552"><span class="linenos">552</span></a>
</span><span id="IDPModel-553"><a href="#IDPModel-553"><span class="linenos">553</span></a><span class="sd">        * `float`: The value of the approximate pdf at the given point.</span>
</span><span id="IDPModel-554"><a href="#IDPModel-554"><span class="linenos">554</span></a>
</span><span id="IDPModel-555"><a href="#IDPModel-555"><span class="linenos">555</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel-556"><a href="#IDPModel-556"><span class="linenos">556</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel-557"><a href="#IDPModel-557"><span class="linenos">557</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel-558"><a href="#IDPModel-558"><span class="linenos">558</span></a>
</span><span id="IDPModel-559"><a href="#IDPModel-559"><span class="linenos">559</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel-560"><a href="#IDPModel-560"><span class="linenos">560</span></a>        <span class="n">samplePDF</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="IDPModel-561"><a href="#IDPModel-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="n">samplePDF</span><span class="o">.</span><span class="n">factor</span>
</span><span id="IDPModel-562"><a href="#IDPModel-562"><span class="linenos">562</span></a>
</span><span id="IDPModel-563"><a href="#IDPModel-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel-564"><a href="#IDPModel-564"><span class="linenos">564</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="IDPModel-565"><a href="#IDPModel-565"><span class="linenos">565</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">samplePDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="IDPModel-566"><a href="#IDPModel-566"><span class="linenos">566</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>An IDP model on the state space $S = \{0, ..., L - 1\}$.</p>

<p>The IDP model consists of both an IDP and some observed data. See
Section 9 of the Paper for details.</p>
</div>


                            <div id="IDPModel.__init__" class="classattr">
                                        <input id="IDPModel.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">IDPModel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">colConc</span>, </span><span class="param"><span class="n">rowConc</span>, </span><span class="param"><span class="n">baseMeas</span>, </span><span class="param"><span class="n">rowCounts</span></span>)</span>

                <label class="view-source-button" for="IDPModel.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.__init__-217"><a href="#IDPModel.__init__-217"><span class="linenos">217</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colConc</span><span class="p">,</span> <span class="n">rowConc</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">rowCounts</span><span class="p">):</span>
</span><span id="IDPModel.__init__-218"><a href="#IDPModel.__init__-218"><span class="linenos">218</span></a>        <span class="sd">&#39;&#39;&#39;The constructor first uses the given arguments to set the</span>
</span><span id="IDPModel.__init__-219"><a href="#IDPModel.__init__-219"><span class="linenos">219</span></a><span class="sd">        corresponding properties. If a property returns a tuple or a</span>
</span><span id="IDPModel.__init__-220"><a href="#IDPModel.__init__-220"><span class="linenos">220</span></a><span class="sd">        tuple of tuples, then the argument can be passed any</span>
</span><span id="IDPModel.__init__-221"><a href="#IDPModel.__init__-221"><span class="linenos">221</span></a><span class="sd">        `array-like` object, such as a list or a list of lists.</span>
</span><span id="IDPModel.__init__-222"><a href="#IDPModel.__init__-222"><span class="linenos">222</span></a>
</span><span id="IDPModel.__init__-223"><a href="#IDPModel.__init__-223"><span class="linenos">223</span></a><span class="sd">        For the `baseMeas` property, the corresponding argument can be</span>
</span><span id="IDPModel.__init__-224"><a href="#IDPModel.__init__-224"><span class="linenos">224</span></a><span class="sd">        passed a single floating point value `p`, in which case the</span>
</span><span id="IDPModel.__init__-225"><a href="#IDPModel.__init__-225"><span class="linenos">225</span></a><span class="sd">        property will be set to `(1 - p, p)`.</span>
</span><span id="IDPModel.__init__-226"><a href="#IDPModel.__init__-226"><span class="linenos">226</span></a>
</span><span id="IDPModel.__init__-227"><a href="#IDPModel.__init__-227"><span class="linenos">227</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.__init__-228"><a href="#IDPModel.__init__-228"><span class="linenos">228</span></a>        <span class="c1"># `baseMeas` and `rowCounts` are stored as ndarrays rather than</span>
</span><span id="IDPModel.__init__-229"><a href="#IDPModel.__init__-229"><span class="linenos">229</span></a>        <span class="c1"># lists, since vector addition fails for lists but works for</span>
</span><span id="IDPModel.__init__-230"><a href="#IDPModel.__init__-230"><span class="linenos">230</span></a>        <span class="c1"># ndarrays. This is important in the constructor of the</span>
</span><span id="IDPModel.__init__-231"><a href="#IDPModel.__init__-231"><span class="linenos">231</span></a>        <span class="c1"># `WeightedSim` class.</span>
</span><span id="IDPModel.__init__-232"><a href="#IDPModel.__init__-232"><span class="linenos">232</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="IDPModel.__init__-233"><a href="#IDPModel.__init__-233"><span class="linenos">233</span></a>
</span><span id="IDPModel.__init__-234"><a href="#IDPModel.__init__-234"><span class="linenos">234</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="IDPModel.__init__-235"><a href="#IDPModel.__init__-235"><span class="linenos">235</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">baseMeas</span><span class="p">,</span> <span class="n">baseMeas</span><span class="p">]</span>
</span><span id="IDPModel.__init__-236"><a href="#IDPModel.__init__-236"><span class="linenos">236</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="IDPModel.__init__-237"><a href="#IDPModel.__init__-237"><span class="linenos">237</span></a>        <span class="n">rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="IDPModel.__init__-238"><a href="#IDPModel.__init__-238"><span class="linenos">238</span></a>
</span><span id="IDPModel.__init__-239"><a href="#IDPModel.__init__-239"><span class="linenos">239</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="IDPModel.__init__-240"><a href="#IDPModel.__init__-240"><span class="linenos">240</span></a>            <span class="s1">&#39;colConc&#39;</span><span class="p">:</span> <span class="n">colConc</span><span class="p">,</span>
</span><span id="IDPModel.__init__-241"><a href="#IDPModel.__init__-241"><span class="linenos">241</span></a>            <span class="s1">&#39;rowConc&#39;</span><span class="p">:</span> <span class="n">rowConc</span><span class="p">,</span>
</span><span id="IDPModel.__init__-242"><a href="#IDPModel.__init__-242"><span class="linenos">242</span></a>            <span class="s1">&#39;baseMeas&#39;</span><span class="p">:</span> <span class="n">baseMeas</span>
</span><span id="IDPModel.__init__-243"><a href="#IDPModel.__init__-243"><span class="linenos">243</span></a>        <span class="p">}</span>
</span><span id="IDPModel.__init__-244"><a href="#IDPModel.__init__-244"><span class="linenos">244</span></a>
</span><span id="IDPModel.__init__-245"><a href="#IDPModel.__init__-245"><span class="linenos">245</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">rowCounts</span>
</span><span id="IDPModel.__init__-246"><a href="#IDPModel.__init__-246"><span class="linenos">246</span></a>
</span><span id="IDPModel.__init__-247"><a href="#IDPModel.__init__-247"><span class="linenos">247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="IDPModel.__init__-248"><a href="#IDPModel.__init__-248"><span class="linenos">248</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="IDPModel.__init__-249"><a href="#IDPModel.__init__-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>The constructor first uses the given arguments to set the
corresponding properties. If a property returns a tuple or a
tuple of tuples, then the argument can be passed any
<code>array-like</code> object, such as a list or a list of lists.</p>

<p>For the <code><a href="#IDPModel.baseMeas">baseMeas</a></code> property, the corresponding argument can be
passed a single floating point value <code>p</code>, in which case the
property will be set to <code>(1 - p, p)</code>.</p>
</div>


                            </div>
                            <div id="IDPModel.colConc" class="classattr">
                                        <input id="IDPModel.colConc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">colConc</span>

                <label class="view-source-button" for="IDPModel.colConc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.colConc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.colConc-251"><a href="#IDPModel.colConc-251"><span class="linenos">251</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.colConc-252"><a href="#IDPModel.colConc-252"><span class="linenos">252</span></a>    <span class="k">def</span> <span class="nf">colConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.colConc-253"><a href="#IDPModel.colConc-253"><span class="linenos">253</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The column concentration parameter. Should be</span>
</span><span id="IDPModel.colConc-254"><a href="#IDPModel.colConc-254"><span class="linenos">254</span></a><span class="sd">        positive. Denoted by $\kappa$ in Section 9 of the Paper.</span>
</span><span id="IDPModel.colConc-255"><a href="#IDPModel.colConc-255"><span class="linenos">255</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.colConc-256"><a href="#IDPModel.colConc-256"><span class="linenos">256</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p><code>float</code>: The column concentration parameter. Should be
positive. Denoted by $\kappa$ in Section 9 of the Paper.</p>
</div>


                            </div>
                            <div id="IDPModel.rowConc" class="classattr">
                                        <input id="IDPModel.rowConc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rowConc</span>

                <label class="view-source-button" for="IDPModel.rowConc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.rowConc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.rowConc-258"><a href="#IDPModel.rowConc-258"><span class="linenos">258</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.rowConc-259"><a href="#IDPModel.rowConc-259"><span class="linenos">259</span></a>    <span class="k">def</span> <span class="nf">rowConc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.rowConc-260"><a href="#IDPModel.rowConc-260"><span class="linenos">260</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The row concentration parameter. Should be</span>
</span><span id="IDPModel.rowConc-261"><a href="#IDPModel.rowConc-261"><span class="linenos">261</span></a><span class="sd">        positive. Denoted by $\varepsilon$ in Section 9 of the Paper.</span>
</span><span id="IDPModel.rowConc-262"><a href="#IDPModel.rowConc-262"><span class="linenos">262</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.rowConc-263"><a href="#IDPModel.rowConc-263"><span class="linenos">263</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p><code>float</code>: The row concentration parameter. Should be
positive. Denoted by $\varepsilon$ in Section 9 of the Paper.</p>
</div>


                            </div>
                            <div id="IDPModel.baseMeas" class="classattr">
                                        <input id="IDPModel.baseMeas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">baseMeas</span>

                <label class="view-source-button" for="IDPModel.baseMeas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.baseMeas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.baseMeas-265"><a href="#IDPModel.baseMeas-265"><span class="linenos">265</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.baseMeas-266"><a href="#IDPModel.baseMeas-266"><span class="linenos">266</span></a>    <span class="k">def</span> <span class="nf">baseMeas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.baseMeas-267"><a href="#IDPModel.baseMeas-267"><span class="linenos">267</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The base probability vector. Should be a</span>
</span><span id="IDPModel.baseMeas-268"><a href="#IDPModel.baseMeas-268"><span class="linenos">268</span></a><span class="sd">        list of positive numbers that sum to 1. Denoted by</span>
</span><span id="IDPModel.baseMeas-269"><a href="#IDPModel.baseMeas-269"><span class="linenos">269</span></a><span class="sd">        $\boldsymbol{p} = (p_0, \ldots, p_{L - 1})$ in Section 9 of the</span>
</span><span id="IDPModel.baseMeas-270"><a href="#IDPModel.baseMeas-270"><span class="linenos">270</span></a><span class="sd">        Paper, where $p_\ell = \varrho(\{\ell\})$.</span>
</span><span id="IDPModel.baseMeas-271"><a href="#IDPModel.baseMeas-271"><span class="linenos">271</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.baseMeas-272"><a href="#IDPModel.baseMeas-272"><span class="linenos">272</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code>float</code>): The base probability vector. Should be a
list of positive numbers that sum to 1. Denoted by
$\boldsymbol{p} = (p_0, \ldots, p_{L - 1})$ in Section 9 of the
Paper, where $p_\ell = \varrho({\ell})$.</p>
</div>


                            </div>
                            <div id="IDPModel.rowCounts" class="classattr">
                                        <input id="IDPModel.rowCounts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rowCounts</span>

                <label class="view-source-button" for="IDPModel.rowCounts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.rowCounts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.rowCounts-274"><a href="#IDPModel.rowCounts-274"><span class="linenos">274</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.rowCounts-275"><a href="#IDPModel.rowCounts-275"><span class="linenos">275</span></a>    <span class="k">def</span> <span class="nf">rowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.rowCounts-276"><a href="#IDPModel.rowCounts-276"><span class="linenos">276</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`int`)): The row counts for the observed</span>
</span><span id="IDPModel.rowCounts-277"><a href="#IDPModel.rowCounts-277"><span class="linenos">277</span></a><span class="sd">        data. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="IDPModel.rowCounts-278"><a href="#IDPModel.rowCounts-278"><span class="linenos">278</span></a><span class="sd">        `rowCounts`[`row`][`state`] is denoted by $\overline{y}_{m\ell}$</span>
</span><span id="IDPModel.rowCounts-279"><a href="#IDPModel.rowCounts-279"><span class="linenos">279</span></a><span class="sd">        in Section 9 of the Paper. It is the number of observed</span>
</span><span id="IDPModel.rowCounts-280"><a href="#IDPModel.rowCounts-280"><span class="linenos">280</span></a><span class="sd">        instances of `state` in the given row of data.</span>
</span><span id="IDPModel.rowCounts-281"><a href="#IDPModel.rowCounts-281"><span class="linenos">281</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.rowCounts-282"><a href="#IDPModel.rowCounts-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code>tuple</code>(<code>int</code>)): The row counts for the observed
data. If <code>row</code> is $m - 1$ and <code>state</code> is $\ell$, then
<code><a href="#IDPModel.rowCounts">rowCounts</a></code>[<code>row</code>][<code>state</code>] is denoted by $\overline{y}_{m\ell}$
in Section 9 of the Paper. It is the number of observed
instances of <code>state</code> in the given row of data.</p>
</div>


                            </div>
                            <div id="IDPModel.likelihoods" class="classattr">
                                        <input id="IDPModel.likelihoods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">likelihoods</span>

                <label class="view-source-button" for="IDPModel.likelihoods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.likelihoods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.likelihoods-284"><a href="#IDPModel.likelihoods-284"><span class="linenos">284</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.likelihoods-285"><a href="#IDPModel.likelihoods-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">likelihoods</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.likelihoods-286"><a href="#IDPModel.likelihoods-286"><span class="linenos">286</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`float`): The prior likelihoods. If `row` equals</span>
</span><span id="IDPModel.likelihoods-287"><a href="#IDPModel.likelihoods-287"><span class="linenos">287</span></a><span class="sd">        $m - 1$, then `likelihoods`[`row`] is denoted by</span>
</span><span id="IDPModel.likelihoods-288"><a href="#IDPModel.likelihoods-288"><span class="linenos">288</span></a><span class="sd">        $\varrho_N(A_m)$ in Section 9 of the Paper. It is the prior</span>
</span><span id="IDPModel.likelihoods-289"><a href="#IDPModel.likelihoods-289"><span class="linenos">289</span></a><span class="sd">        probability of seeing the row counts for the given row. This</span>
</span><span id="IDPModel.likelihoods-290"><a href="#IDPModel.likelihoods-290"><span class="linenos">290</span></a><span class="sd">        property is computed by the constructor, and should not be</span>
</span><span id="IDPModel.likelihoods-291"><a href="#IDPModel.likelihoods-291"><span class="linenos">291</span></a><span class="sd">        changed.</span>
</span><span id="IDPModel.likelihoods-292"><a href="#IDPModel.likelihoods-292"><span class="linenos">292</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.likelihoods-293"><a href="#IDPModel.likelihoods-293"><span class="linenos">293</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">):</span>
</span><span id="IDPModel.likelihoods-294"><a href="#IDPModel.likelihoods-294"><span class="linenos">294</span></a>            <span class="n">rowConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;rowConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel.likelihoods-295"><a href="#IDPModel.likelihoods-295"><span class="linenos">295</span></a>            <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="IDPModel.likelihoods-296"><a href="#IDPModel.likelihoods-296"><span class="linenos">296</span></a>            <span class="n">denom</span> <span class="o">=</span> <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">)</span>
</span><span id="IDPModel.likelihoods-297"><a href="#IDPModel.likelihoods-297"><span class="linenos">297</span></a>            <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">):]:</span>
</span><span id="IDPModel.likelihoods-298"><a href="#IDPModel.likelihoods-298"><span class="linenos">298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="IDPModel.likelihoods-299"><a href="#IDPModel.likelihoods-299"><span class="linenos">299</span></a>                    <span class="n">_betaFuncMult</span><span class="p">(</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">row</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="IDPModel.likelihoods-300"><a href="#IDPModel.likelihoods-300"><span class="linenos">300</span></a>                <span class="p">)</span>
</span><span id="IDPModel.likelihoods-301"><a href="#IDPModel.likelihoods-301"><span class="linenos">301</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_likelihoods</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code>float</code>): The prior likelihoods. If <code>row</code> equals
$m - 1$, then <code><a href="#IDPModel.likelihoods">likelihoods</a></code>[<code>row</code>] is denoted by
$\varrho_N(A_m)$ in Section 9 of the Paper. It is the prior
probability of seeing the row counts for the given row. This
property is computed by the constructor, and should not be
changed.</p>
</div>


                            </div>
                            <div id="IDPModel.scale" class="classattr">
                                        <input id="IDPModel.scale-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">scale</span>

                <label class="view-source-button" for="IDPModel.scale-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.scale"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.scale-303"><a href="#IDPModel.scale-303"><span class="linenos">303</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.scale-304"><a href="#IDPModel.scale-304"><span class="linenos">304</span></a>    <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.scale-305"><a href="#IDPModel.scale-305"><span class="linenos">305</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`float`: The scale factor to use for weighted simulations.</span>
</span><span id="IDPModel.scale-306"><a href="#IDPModel.scale-306"><span class="linenos">306</span></a><span class="sd">        Denoted by $\log c$ in Section 9 of the Paper. Defaults to 0.</span>
</span><span id="IDPModel.scale-307"><a href="#IDPModel.scale-307"><span class="linenos">307</span></a><span class="sd">        Altering this value runs the `WeightedSim.updateScale` method on</span>
</span><span id="IDPModel.scale-308"><a href="#IDPModel.scale-308"><span class="linenos">308</span></a><span class="sd">        every simulation in the `weightedSims` property. If a</span>
</span><span id="IDPModel.scale-309"><a href="#IDPModel.scale-309"><span class="linenos">309</span></a><span class="sd">        `ValueError` occurs in this process, then no changes will be</span>
</span><span id="IDPModel.scale-310"><a href="#IDPModel.scale-310"><span class="linenos">310</span></a><span class="sd">        made, neither to the `scale` property, nor to any of the</span>
</span><span id="IDPModel.scale-311"><a href="#IDPModel.scale-311"><span class="linenos">311</span></a><span class="sd">        simulations in the `weightedSims` property.</span>
</span><span id="IDPModel.scale-312"><a href="#IDPModel.scale-312"><span class="linenos">312</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.scale-313"><a href="#IDPModel.scale-313"><span class="linenos">313</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span></pre></div>


            <div class="docstring"><p><code>float</code>: The scale factor to use for weighted simulations.
Denoted by $\log c$ in Section 9 of the Paper. Defaults to 0.
Altering this value runs the <code><a href="#WeightedSim.updateScale">WeightedSim.updateScale</a></code> method on
every simulation in the <code><a href="#IDPModel.weightedSims">weightedSims</a></code> property. If a
<code>ValueError</code> occurs in this process, then no changes will be
made, neither to the <code><a href="#IDPModel.scale">scale</a></code> property, nor to any of the
simulations in the <code><a href="#IDPModel.weightedSims">weightedSims</a></code> property.</p>
</div>


                            </div>
                            <div id="IDPModel.weightedSims" class="classattr">
                                        <input id="IDPModel.weightedSims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">weightedSims</span>

                <label class="view-source-button" for="IDPModel.weightedSims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.weightedSims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.weightedSims-326"><a href="#IDPModel.weightedSims-326"><span class="linenos">326</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.weightedSims-327"><a href="#IDPModel.weightedSims-327"><span class="linenos">327</span></a>    <span class="k">def</span> <span class="nf">weightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.weightedSims-328"><a href="#IDPModel.weightedSims-328"><span class="linenos">328</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`WeightedSim`): A tuple of distinct (and therefore</span>
</span><span id="IDPModel.weightedSims-329"><a href="#IDPModel.weightedSims-329"><span class="linenos">329</span></a><span class="sd">        independent) `WeightedSim` instances. `weightedSims`[k] is</span>
</span><span id="IDPModel.weightedSims-330"><a href="#IDPModel.weightedSims-330"><span class="linenos">330</span></a><span class="sd">        denoted by $(t^k, \boldsymbol{\theta}_M^{*, k})$ in Section 9 of</span>
</span><span id="IDPModel.weightedSims-331"><a href="#IDPModel.weightedSims-331"><span class="linenos">331</span></a><span class="sd">        the Paper, and has total weight $V^{(k)}$. This property is</span>
</span><span id="IDPModel.weightedSims-332"><a href="#IDPModel.weightedSims-332"><span class="linenos">332</span></a><span class="sd">        empty if the `addWeightedSims` method has never been run.</span>
</span><span id="IDPModel.weightedSims-333"><a href="#IDPModel.weightedSims-333"><span class="linenos">333</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.weightedSims-334"><a href="#IDPModel.weightedSims-334"><span class="linenos">334</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code><a href="#WeightedSim">WeightedSim</a></code>): A tuple of distinct (and therefore
independent) <code><a href="#WeightedSim">WeightedSim</a></code> instances. <code><a href="#IDPModel.weightedSims">weightedSims</a></code>[k] is
denoted by $(t^k, \boldsymbol{\theta}_M^{*, k})$ in Section 9 of
the Paper, and has total weight $V^{(k)}$. This property is
empty if the <code><a href="#IDPModel.addWeightedSims">addWeightedSims</a></code> method has never been run.</p>
</div>


                            </div>
                            <div id="IDPModel.bandwidth" class="classattr">
                                        <input id="IDPModel.bandwidth-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">bandwidth</span>

                <label class="view-source-button" for="IDPModel.bandwidth-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.bandwidth"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.bandwidth-336"><a href="#IDPModel.bandwidth-336"><span class="linenos">336</span></a>    <span class="nd">@property</span>
</span><span id="IDPModel.bandwidth-337"><a href="#IDPModel.bandwidth-337"><span class="linenos">337</span></a>    <span class="k">def</span> <span class="nf">bandwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.bandwidth-338"><a href="#IDPModel.bandwidth-338"><span class="linenos">338</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The bandwidth used most recently by the `meanRDGpdf`</span>
</span><span id="IDPModel.bandwidth-339"><a href="#IDPModel.bandwidth-339"><span class="linenos">339</span></a><span class="sd">        method. Is `None` if this method has never been used.</span>
</span><span id="IDPModel.bandwidth-340"><a href="#IDPModel.bandwidth-340"><span class="linenos">340</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.bandwidth-341"><a href="#IDPModel.bandwidth-341"><span class="linenos">341</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span>
</span></pre></div>


            <div class="docstring"><p><code>float</code>: The bandwidth used most recently by the <code><a href="#IDPModel.meanRDGpdf">meanRDGpdf</a></code>
method. Is <code>None</code> if this method has never been used.</p>
</div>


                            </div>
                            <div id="IDPModel.addRowCounts" class="classattr">
                                        <input id="IDPModel.addRowCounts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addRowCounts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">newRowCounts</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.addRowCounts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.addRowCounts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.addRowCounts-343"><a href="#IDPModel.addRowCounts-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">addRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">):</span>
</span><span id="IDPModel.addRowCounts-344"><a href="#IDPModel.addRowCounts-344"><span class="linenos">344</span></a>        <span class="sd">&#39;&#39;&#39;Adds new row counts to the `rowCounts` property and runs the</span>
</span><span id="IDPModel.addRowCounts-345"><a href="#IDPModel.addRowCounts-345"><span class="linenos">345</span></a><span class="sd">        `WeightedSim.updateRowCounts` method on every simulation in the</span>
</span><span id="IDPModel.addRowCounts-346"><a href="#IDPModel.addRowCounts-346"><span class="linenos">346</span></a><span class="sd">        `weightedSims` property. If a `ValueError` occurs in this</span>
</span><span id="IDPModel.addRowCounts-347"><a href="#IDPModel.addRowCounts-347"><span class="linenos">347</span></a><span class="sd">        process, then no changes will be made, neither to the</span>
</span><span id="IDPModel.addRowCounts-348"><a href="#IDPModel.addRowCounts-348"><span class="linenos">348</span></a><span class="sd">        `rowCounts` property, nor to any of the simulations in the</span>
</span><span id="IDPModel.addRowCounts-349"><a href="#IDPModel.addRowCounts-349"><span class="linenos">349</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel.addRowCounts-350"><a href="#IDPModel.addRowCounts-350"><span class="linenos">350</span></a>
</span><span id="IDPModel.addRowCounts-351"><a href="#IDPModel.addRowCounts-351"><span class="linenos">351</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.addRowCounts-352"><a href="#IDPModel.addRowCounts-352"><span class="linenos">352</span></a>
</span><span id="IDPModel.addRowCounts-353"><a href="#IDPModel.addRowCounts-353"><span class="linenos">353</span></a><span class="sd">        * **newRowCounts** (`array_like`): The additional row counts to</span>
</span><span id="IDPModel.addRowCounts-354"><a href="#IDPModel.addRowCounts-354"><span class="linenos">354</span></a><span class="sd">            be added. Should be an array-like object (such as a list of</span>
</span><span id="IDPModel.addRowCounts-355"><a href="#IDPModel.addRowCounts-355"><span class="linenos">355</span></a><span class="sd">            lists) with the same number of columns (states) as</span>
</span><span id="IDPModel.addRowCounts-356"><a href="#IDPModel.addRowCounts-356"><span class="linenos">356</span></a><span class="sd">            `rowCounts`.</span>
</span><span id="IDPModel.addRowCounts-357"><a href="#IDPModel.addRowCounts-357"><span class="linenos">357</span></a>
</span><span id="IDPModel.addRowCounts-358"><a href="#IDPModel.addRowCounts-358"><span class="linenos">358</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.addRowCounts-359"><a href="#IDPModel.addRowCounts-359"><span class="linenos">359</span></a>        <span class="n">oldRowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span>
</span><span id="IDPModel.addRowCounts-360"><a href="#IDPModel.addRowCounts-360"><span class="linenos">360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">,</span> <span class="n">newRowCounts</span><span class="p">))</span>
</span><span id="IDPModel.addRowCounts-361"><a href="#IDPModel.addRowCounts-361"><span class="linenos">361</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="IDPModel.addRowCounts-362"><a href="#IDPModel.addRowCounts-362"><span class="linenos">362</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel.addRowCounts-363"><a href="#IDPModel.addRowCounts-363"><span class="linenos">363</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="IDPModel.addRowCounts-364"><a href="#IDPModel.addRowCounts-364"><span class="linenos">364</span></a>        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="IDPModel.addRowCounts-365"><a href="#IDPModel.addRowCounts-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="n">oldRowCounts</span>
</span><span id="IDPModel.addRowCounts-366"><a href="#IDPModel.addRowCounts-366"><span class="linenos">366</span></a>            <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel.addRowCounts-367"><a href="#IDPModel.addRowCounts-367"><span class="linenos">367</span></a>                <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="IDPModel.addRowCounts-368"><a href="#IDPModel.addRowCounts-368"><span class="linenos">368</span></a>            <span class="k">raise</span>
</span></pre></div>


            <div class="docstring"><p>Adds new row counts to the <code><a href="#IDPModel.rowCounts">rowCounts</a></code> property and runs the
<code><a href="#WeightedSim.updateRowCounts">WeightedSim.updateRowCounts</a></code> method on every simulation in the
<code><a href="#IDPModel.weightedSims">weightedSims</a></code> property. If a <code>ValueError</code> occurs in this
process, then no changes will be made, neither to the
<code><a href="#IDPModel.rowCounts">rowCounts</a></code> property, nor to any of the simulations in the
<code><a href="#IDPModel.weightedSims">weightedSims</a></code> property.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>newRowCounts</strong> (<code>array_like</code>): The additional row counts to
be added. Should be an array-like object (such as a list of
lists) with the same number of columns (states) as
<code><a href="#IDPModel.rowCounts">rowCounts</a></code>.</li>
</ul>
</div>


                            </div>
                            <div id="IDPModel.delRowCounts" class="classattr">
                                        <input id="IDPModel.delRowCounts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">delRowCounts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">numRows</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.delRowCounts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.delRowCounts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.delRowCounts-370"><a href="#IDPModel.delRowCounts-370"><span class="linenos">370</span></a>    <span class="k">def</span> <span class="nf">delRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numRows</span><span class="p">):</span>
</span><span id="IDPModel.delRowCounts-371"><a href="#IDPModel.delRowCounts-371"><span class="linenos">371</span></a>        <span class="sd">&#39;&#39;&#39;Deletes the last `numRows` rows of the `rowCounts` property,</span>
</span><span id="IDPModel.delRowCounts-372"><a href="#IDPModel.delRowCounts-372"><span class="linenos">372</span></a><span class="sd">        then runs the `WeightedSim.updateRowCounts` method on every</span>
</span><span id="IDPModel.delRowCounts-373"><a href="#IDPModel.delRowCounts-373"><span class="linenos">373</span></a><span class="sd">        simulation in the `weightedSims` property.</span>
</span><span id="IDPModel.delRowCounts-374"><a href="#IDPModel.delRowCounts-374"><span class="linenos">374</span></a>
</span><span id="IDPModel.delRowCounts-375"><a href="#IDPModel.delRowCounts-375"><span class="linenos">375</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.delRowCounts-376"><a href="#IDPModel.delRowCounts-376"><span class="linenos">376</span></a>
</span><span id="IDPModel.delRowCounts-377"><a href="#IDPModel.delRowCounts-377"><span class="linenos">377</span></a><span class="sd">        * **numRows** (`int`): The number of rows to delete.</span>
</span><span id="IDPModel.delRowCounts-378"><a href="#IDPModel.delRowCounts-378"><span class="linenos">378</span></a>
</span><span id="IDPModel.delRowCounts-379"><a href="#IDPModel.delRowCounts-379"><span class="linenos">379</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.delRowCounts-380"><a href="#IDPModel.delRowCounts-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">[:</span><span class="o">-</span><span class="n">numRows</span><span class="p">]</span>
</span><span id="IDPModel.delRowCounts-381"><a href="#IDPModel.delRowCounts-381"><span class="linenos">381</span></a>        <span class="k">for</span> <span class="n">weightedSim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel.delRowCounts-382"><a href="#IDPModel.delRowCounts-382"><span class="linenos">382</span></a>            <span class="n">weightedSim</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Deletes the last <code>numRows</code> rows of the <code><a href="#IDPModel.rowCounts">rowCounts</a></code> property,
then runs the <code><a href="#WeightedSim.updateRowCounts">WeightedSim.updateRowCounts</a></code> method on every
simulation in the <code><a href="#IDPModel.weightedSims">weightedSims</a></code> property.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>numRows</strong> (<code>int</code>): The number of rows to delete.</li>
</ul>
</div>


                            </div>
                            <div id="IDPModel.addWeightedSims" class="classattr">
                                        <input id="IDPModel.addWeightedSims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">addWeightedSims</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">num</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.addWeightedSims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.addWeightedSims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.addWeightedSims-384"><a href="#IDPModel.addWeightedSims-384"><span class="linenos">384</span></a>    <span class="k">def</span> <span class="nf">addWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
</span><span id="IDPModel.addWeightedSims-385"><a href="#IDPModel.addWeightedSims-385"><span class="linenos">385</span></a>        <span class="sd">&#39;&#39;&#39;Creates new `WeightedSim` instances and adds them to the</span>
</span><span id="IDPModel.addWeightedSims-386"><a href="#IDPModel.addWeightedSims-386"><span class="linenos">386</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel.addWeightedSims-387"><a href="#IDPModel.addWeightedSims-387"><span class="linenos">387</span></a>
</span><span id="IDPModel.addWeightedSims-388"><a href="#IDPModel.addWeightedSims-388"><span class="linenos">388</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.addWeightedSims-389"><a href="#IDPModel.addWeightedSims-389"><span class="linenos">389</span></a><span class="sd">        </span>
</span><span id="IDPModel.addWeightedSims-390"><a href="#IDPModel.addWeightedSims-390"><span class="linenos">390</span></a><span class="sd">        * **num** (`int`): The number of distinct `WeightedSim`</span>
</span><span id="IDPModel.addWeightedSims-391"><a href="#IDPModel.addWeightedSims-391"><span class="linenos">391</span></a><span class="sd">            instances to create. If zero or negative, no instances are</span>
</span><span id="IDPModel.addWeightedSims-392"><a href="#IDPModel.addWeightedSims-392"><span class="linenos">392</span></a><span class="sd">            created.</span>
</span><span id="IDPModel.addWeightedSims-393"><a href="#IDPModel.addWeightedSims-393"><span class="linenos">393</span></a>
</span><span id="IDPModel.addWeightedSims-394"><a href="#IDPModel.addWeightedSims-394"><span class="linenos">394</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.addWeightedSims-395"><a href="#IDPModel.addWeightedSims-395"><span class="linenos">395</span></a>        <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="IDPModel.addWeightedSims-396"><a href="#IDPModel.addWeightedSims-396"><span class="linenos">396</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">+=</span> <span class="p">[</span><span class="n">WeightedSim</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
</span></pre></div>


            <div class="docstring"><p>Creates new <code><a href="#WeightedSim">WeightedSim</a></code> instances and adds them to the
<code><a href="#IDPModel.weightedSims">weightedSims</a></code> property.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>num</strong> (<code>int</code>): The number of distinct <code><a href="#WeightedSim">WeightedSim</a></code>
instances to create. If zero or negative, no instances are
created.</li>
</ul>
</div>


                            </div>
                            <div id="IDPModel.clearWeightedSims" class="classattr">
                                        <input id="IDPModel.clearWeightedSims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clearWeightedSims</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.clearWeightedSims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.clearWeightedSims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.clearWeightedSims-398"><a href="#IDPModel.clearWeightedSims-398"><span class="linenos">398</span></a>    <span class="k">def</span> <span class="nf">clearWeightedSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="IDPModel.clearWeightedSims-399"><a href="#IDPModel.clearWeightedSims-399"><span class="linenos">399</span></a>        <span class="sd">&#39;&#39;&#39;Deletes all weighted simulations contained in the</span>
</span><span id="IDPModel.clearWeightedSims-400"><a href="#IDPModel.clearWeightedSims-400"><span class="linenos">400</span></a><span class="sd">        `weightedSims` property.</span>
</span><span id="IDPModel.clearWeightedSims-401"><a href="#IDPModel.clearWeightedSims-401"><span class="linenos">401</span></a>
</span><span id="IDPModel.clearWeightedSims-402"><a href="#IDPModel.clearWeightedSims-402"><span class="linenos">402</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.clearWeightedSims-403"><a href="#IDPModel.clearWeightedSims-403"><span class="linenos">403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span> <span class="o">=</span> <span class="p">[]</span>
</span></pre></div>


            <div class="docstring"><p>Deletes all weighted simulations contained in the
<code><a href="#IDPModel.weightedSims">weightedSims</a></code> property.</p>
</div>


                            </div>
                            <div id="IDPModel.postProb" class="classattr">
                                        <input id="IDPModel.postProb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">postProb</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">row</span>, </span><span class="param"><span class="n">state</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.postProb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.postProb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.postProb-405"><a href="#IDPModel.postProb-405"><span class="linenos">405</span></a>    <span class="k">def</span> <span class="nf">postProb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="IDPModel.postProb-406"><a href="#IDPModel.postProb-406"><span class="linenos">406</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Computes and returns the posterior probability of seeing the</span>
</span><span id="IDPModel.postProb-407"><a href="#IDPModel.postProb-407"><span class="linenos">407</span></a><span class="sd">        given state on a new trial in the given row. If `row` is</span>
</span><span id="IDPModel.postProb-408"><a href="#IDPModel.postProb-408"><span class="linenos">408</span></a><span class="sd">        $m - 1$, `state` is $\ell$ , and the length of `rowCounts` is</span>
</span><span id="IDPModel.postProb-409"><a href="#IDPModel.postProb-409"><span class="linenos">409</span></a><span class="sd">        $M$, then the value returned by this method is denoted in the</span>
</span><span id="IDPModel.postProb-410"><a href="#IDPModel.postProb-410"><span class="linenos">410</span></a><span class="sd">        Paper by $P(\xi_{m, N_m + \ell} = 1 \mid Y = y)$ in the case</span>
</span><span id="IDPModel.postProb-411"><a href="#IDPModel.postProb-411"><span class="linenos">411</span></a><span class="sd">        $m \le M$, and by $P(\xi_{M + 1, 1} = \ell \mid Y = y)$ in the</span>
</span><span id="IDPModel.postProb-412"><a href="#IDPModel.postProb-412"><span class="linenos">412</span></a><span class="sd">        case $m &gt; M$. This method implements (9.4) and (9.5) in the</span>
</span><span id="IDPModel.postProb-413"><a href="#IDPModel.postProb-413"><span class="linenos">413</span></a><span class="sd">        Paper.</span>
</span><span id="IDPModel.postProb-414"><a href="#IDPModel.postProb-414"><span class="linenos">414</span></a>
</span><span id="IDPModel.postProb-415"><a href="#IDPModel.postProb-415"><span class="linenos">415</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.postProb-416"><a href="#IDPModel.postProb-416"><span class="linenos">416</span></a>
</span><span id="IDPModel.postProb-417"><a href="#IDPModel.postProb-417"><span class="linenos">417</span></a><span class="sd">        * **row** (`int`): The index of the row whose posterior</span>
</span><span id="IDPModel.postProb-418"><a href="#IDPModel.postProb-418"><span class="linenos">418</span></a><span class="sd">            probability should be computed.</span>
</span><span id="IDPModel.postProb-419"><a href="#IDPModel.postProb-419"><span class="linenos">419</span></a><span class="sd">        * **state** (`int`): The state whose posterior probability</span>
</span><span id="IDPModel.postProb-420"><a href="#IDPModel.postProb-420"><span class="linenos">420</span></a><span class="sd">            should be computed.</span>
</span><span id="IDPModel.postProb-421"><a href="#IDPModel.postProb-421"><span class="linenos">421</span></a>
</span><span id="IDPModel.postProb-422"><a href="#IDPModel.postProb-422"><span class="linenos">422</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel.postProb-423"><a href="#IDPModel.postProb-423"><span class="linenos">423</span></a>
</span><span id="IDPModel.postProb-424"><a href="#IDPModel.postProb-424"><span class="linenos">424</span></a><span class="sd">        * `float`: The posterior probability of seeing the given state.</span>
</span><span id="IDPModel.postProb-425"><a href="#IDPModel.postProb-425"><span class="linenos">425</span></a>
</span><span id="IDPModel.postProb-426"><a href="#IDPModel.postProb-426"><span class="linenos">426</span></a><span class="sd">        **Raises:**</span>
</span><span id="IDPModel.postProb-427"><a href="#IDPModel.postProb-427"><span class="linenos">427</span></a>
</span><span id="IDPModel.postProb-428"><a href="#IDPModel.postProb-428"><span class="linenos">428</span></a><span class="sd">        * **ValueError**: If the `weightedSims` property is empty.</span>
</span><span id="IDPModel.postProb-429"><a href="#IDPModel.postProb-429"><span class="linenos">429</span></a>
</span><span id="IDPModel.postProb-430"><a href="#IDPModel.postProb-430"><span class="linenos">430</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.postProb-431"><a href="#IDPModel.postProb-431"><span class="linenos">431</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weightedSims</span><span class="p">:</span>
</span><span id="IDPModel.postProb-432"><a href="#IDPModel.postProb-432"><span class="linenos">432</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;No weighted simulations found&#39;</span><span class="p">)</span>
</span><span id="IDPModel.postProb-433"><a href="#IDPModel.postProb-433"><span class="linenos">433</span></a>
</span><span id="IDPModel.postProb-434"><a href="#IDPModel.postProb-434"><span class="linenos">434</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel.postProb-435"><a href="#IDPModel.postProb-435"><span class="linenos">435</span></a>        <span class="k">if</span> <span class="n">row</span> <span class="o">&lt;</span> <span class="n">numRows</span><span class="p">:</span>
</span><span id="IDPModel.postProb-436"><a href="#IDPModel.postProb-436"><span class="linenos">436</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel.postProb-437"><a href="#IDPModel.postProb-437"><span class="linenos">437</span></a>
</span><span id="IDPModel.postProb-438"><a href="#IDPModel.postProb-438"><span class="linenos">438</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel.postProb-439"><a href="#IDPModel.postProb-439"><span class="linenos">439</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;baseMeas&#39;</span><span class="p">]</span>
</span><span id="IDPModel.postProb-440"><a href="#IDPModel.postProb-440"><span class="linenos">440</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel.postProb-441"><a href="#IDPModel.postProb-441"><span class="linenos">441</span></a>            <span class="n">colConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="IDPModel.postProb-442"><a href="#IDPModel.postProb-442"><span class="linenos">442</span></a>            <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_postProbLow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">))</span>
</span><span id="IDPModel.postProb-443"><a href="#IDPModel.postProb-443"><span class="linenos">443</span></a>        <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Computes and returns the posterior probability of seeing the
given state on a new trial in the given row. If <code>row</code> is
$m - 1$, <code>state</code> is $\ell$ , and the length of <code><a href="#IDPModel.rowCounts">rowCounts</a></code> is
$M$, then the value returned by this method is denoted in the
Paper by $P(\xi_{m, N_m + \ell} = 1 \mid Y = y)$ in the case
$m \le M$, and by $P(\xi_{M + 1, 1} = \ell \mid Y = y)$ in the
case $m &gt; M$. This method implements (9.4) and (9.5) in the
Paper.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>row</strong> (<code>int</code>): The index of the row whose posterior
probability should be computed.</li>
<li><strong>state</strong> (<code>int</code>): The state whose posterior probability
should be computed.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>float</code>: The posterior probability of seeing the given state.</li>
</ul>

<p><strong>Raises:</strong></p>

<ul>
<li><strong>ValueError</strong>: If the <code><a href="#IDPModel.weightedSims">weightedSims</a></code> property is empty.</li>
</ul>
</div>


                            </div>
                            <div id="IDPModel.meanRDGcdf" class="classattr">
                                        <input id="IDPModel.meanRDGcdf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">meanRDGcdf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">state</span><span class="o">=</span><span class="mi">1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.meanRDGcdf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.meanRDGcdf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.meanRDGcdf-458"><a href="#IDPModel.meanRDGcdf-458"><span class="linenos">458</span></a>    <span class="k">def</span> <span class="nf">meanRDGcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
</span><span id="IDPModel.meanRDGcdf-459"><a href="#IDPModel.meanRDGcdf-459"><span class="linenos">459</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;The mean of the row distribution generator (RDG) for a state</span>
</span><span id="IDPModel.meanRDGcdf-460"><a href="#IDPModel.meanRDGcdf-460"><span class="linenos">460</span></a><span class="sd">        $\ell$ is a probability distribution on $[0, 1]$. More</span>
</span><span id="IDPModel.meanRDGcdf-461"><a href="#IDPModel.meanRDGcdf-461"><span class="linenos">461</span></a><span class="sd">        specifically, using the notation in the Paper, it is the</span>
</span><span id="IDPModel.meanRDGcdf-462"><a href="#IDPModel.meanRDGcdf-462"><span class="linenos">462</span></a><span class="sd">        conditional distribution of $\theta_{M + 1, \ell}$ given</span>
</span><span id="IDPModel.meanRDGcdf-463"><a href="#IDPModel.meanRDGcdf-463"><span class="linenos">463</span></a><span class="sd">        $Y = y$, and an expression for it is given in (9.6) in the</span>
</span><span id="IDPModel.meanRDGcdf-464"><a href="#IDPModel.meanRDGcdf-464"><span class="linenos">464</span></a><span class="sd">        Paper.</span>
</span><span id="IDPModel.meanRDGcdf-465"><a href="#IDPModel.meanRDGcdf-465"><span class="linenos">465</span></a>
</span><span id="IDPModel.meanRDGcdf-466"><a href="#IDPModel.meanRDGcdf-466"><span class="linenos">466</span></a><span class="sd">        This method evaluates the cumulative distribution function (cdf)</span>
</span><span id="IDPModel.meanRDGcdf-467"><a href="#IDPModel.meanRDGcdf-467"><span class="linenos">467</span></a><span class="sd">        of the mean of the RDG for the given state at the given point.</span>
</span><span id="IDPModel.meanRDGcdf-468"><a href="#IDPModel.meanRDGcdf-468"><span class="linenos">468</span></a><span class="sd">        That is, it gives the cdf for the random probability of seeing</span>
</span><span id="IDPModel.meanRDGcdf-469"><a href="#IDPModel.meanRDGcdf-469"><span class="linenos">469</span></a><span class="sd">        the given state in a new trial.</span>
</span><span id="IDPModel.meanRDGcdf-470"><a href="#IDPModel.meanRDGcdf-470"><span class="linenos">470</span></a>
</span><span id="IDPModel.meanRDGcdf-471"><a href="#IDPModel.meanRDGcdf-471"><span class="linenos">471</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.meanRDGcdf-472"><a href="#IDPModel.meanRDGcdf-472"><span class="linenos">472</span></a>
</span><span id="IDPModel.meanRDGcdf-473"><a href="#IDPModel.meanRDGcdf-473"><span class="linenos">473</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the cdf.</span>
</span><span id="IDPModel.meanRDGcdf-474"><a href="#IDPModel.meanRDGcdf-474"><span class="linenos">474</span></a><span class="sd">        * **state** (`int`): The state for which the cdf is to be</span>
</span><span id="IDPModel.meanRDGcdf-475"><a href="#IDPModel.meanRDGcdf-475"><span class="linenos">475</span></a><span class="sd">            computed.</span>
</span><span id="IDPModel.meanRDGcdf-476"><a href="#IDPModel.meanRDGcdf-476"><span class="linenos">476</span></a>
</span><span id="IDPModel.meanRDGcdf-477"><a href="#IDPModel.meanRDGcdf-477"><span class="linenos">477</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel.meanRDGcdf-478"><a href="#IDPModel.meanRDGcdf-478"><span class="linenos">478</span></a>
</span><span id="IDPModel.meanRDGcdf-479"><a href="#IDPModel.meanRDGcdf-479"><span class="linenos">479</span></a><span class="sd">        * `float`: The value of the cdf at the given point.</span>
</span><span id="IDPModel.meanRDGcdf-480"><a href="#IDPModel.meanRDGcdf-480"><span class="linenos">480</span></a>
</span><span id="IDPModel.meanRDGcdf-481"><a href="#IDPModel.meanRDGcdf-481"><span class="linenos">481</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.meanRDGcdf-482"><a href="#IDPModel.meanRDGcdf-482"><span class="linenos">482</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel.meanRDGcdf-483"><a href="#IDPModel.meanRDGcdf-483"><span class="linenos">483</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGcdf-484"><a href="#IDPModel.meanRDGcdf-484"><span class="linenos">484</span></a>
</span><span id="IDPModel.meanRDGcdf-485"><a href="#IDPModel.meanRDGcdf-485"><span class="linenos">485</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGcdf-486"><a href="#IDPModel.meanRDGcdf-486"><span class="linenos">486</span></a>        <span class="n">sampleCDF</span> <span class="o">=</span> <span class="n">ECDFDiscrete</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGcdf-487"><a href="#IDPModel.meanRDGcdf-487"><span class="linenos">487</span></a>
</span><span id="IDPModel.meanRDGcdf-488"><a href="#IDPModel.meanRDGcdf-488"><span class="linenos">488</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel.meanRDGcdf-489"><a href="#IDPModel.meanRDGcdf-489"><span class="linenos">489</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="IDPModel.meanRDGcdf-490"><a href="#IDPModel.meanRDGcdf-490"><span class="linenos">490</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">sampleCDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGcdf-491"><a href="#IDPModel.meanRDGcdf-491"><span class="linenos">491</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>The mean of the row distribution generator (RDG) for a state
$\ell$ is a probability distribution on $[0, 1]$. More
specifically, using the notation in the Paper, it is the
conditional distribution of $\theta_{M + 1, \ell}$ given
$Y = y$, and an expression for it is given in (9.6) in the
Paper.</p>

<p>This method evaluates the cumulative distribution function (cdf)
of the mean of the RDG for the given state at the given point.
That is, it gives the cdf for the random probability of seeing
the given state in a new trial.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>t</strong> (<code>float</code>): The point at which to evaluate the cdf.</li>
<li><strong>state</strong> (<code>int</code>): The state for which the cdf is to be
computed.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>float</code>: The value of the cdf at the given point.</li>
</ul>
</div>


                            </div>
                            <div id="IDPModel.meanRDGpdf" class="classattr">
                                        <input id="IDPModel.meanRDGpdf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">meanRDGpdf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">t</span>, </span><span class="param"><span class="n">state</span><span class="o">=</span><span class="mi">1</span>, </span><span class="param"><span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IDPModel.meanRDGpdf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IDPModel.meanRDGpdf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IDPModel.meanRDGpdf-528"><a href="#IDPModel.meanRDGpdf-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">meanRDGpdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IDPModel.meanRDGpdf-529"><a href="#IDPModel.meanRDGpdf-529"><span class="linenos">529</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;This method evaluates an approximate density (pdf) for the</span>
</span><span id="IDPModel.meanRDGpdf-530"><a href="#IDPModel.meanRDGpdf-530"><span class="linenos">530</span></a><span class="sd">        mean of the RDG for the given state. (See `meanRDGcdf` for an</span>
</span><span id="IDPModel.meanRDGpdf-531"><a href="#IDPModel.meanRDGpdf-531"><span class="linenos">531</span></a><span class="sd">        explanation of the RDG.) The mean of the RDG has a discrete</span>
</span><span id="IDPModel.meanRDGpdf-532"><a href="#IDPModel.meanRDGpdf-532"><span class="linenos">532</span></a><span class="sd">        component, and therefore has no density. This method creates an</span>
</span><span id="IDPModel.meanRDGpdf-533"><a href="#IDPModel.meanRDGpdf-533"><span class="linenos">533</span></a><span class="sd">        approximate density using Gaussian kernel density estimation</span>
</span><span id="IDPModel.meanRDGpdf-534"><a href="#IDPModel.meanRDGpdf-534"><span class="linenos">534</span></a><span class="sd">        (KDE). More specifically, it treats the point mass $\delta_x$ as</span>
</span><span id="IDPModel.meanRDGpdf-535"><a href="#IDPModel.meanRDGpdf-535"><span class="linenos">535</span></a><span class="sd">        having a Gaussian density with mean $x$ and standard deviation</span>
</span><span id="IDPModel.meanRDGpdf-536"><a href="#IDPModel.meanRDGpdf-536"><span class="linenos">536</span></a><span class="sd">        $h$, where $h$ is the &quot;bandwidth&quot; of the estimate.</span>
</span><span id="IDPModel.meanRDGpdf-537"><a href="#IDPModel.meanRDGpdf-537"><span class="linenos">537</span></a>
</span><span id="IDPModel.meanRDGpdf-538"><a href="#IDPModel.meanRDGpdf-538"><span class="linenos">538</span></a><span class="sd">        **Arguments:**</span>
</span><span id="IDPModel.meanRDGpdf-539"><a href="#IDPModel.meanRDGpdf-539"><span class="linenos">539</span></a>
</span><span id="IDPModel.meanRDGpdf-540"><a href="#IDPModel.meanRDGpdf-540"><span class="linenos">540</span></a><span class="sd">        * **t** (`float`): The point at which to evaluate the</span>
</span><span id="IDPModel.meanRDGpdf-541"><a href="#IDPModel.meanRDGpdf-541"><span class="linenos">541</span></a><span class="sd">            approximate pdf.</span>
</span><span id="IDPModel.meanRDGpdf-542"><a href="#IDPModel.meanRDGpdf-542"><span class="linenos">542</span></a><span class="sd">        * **state** (`int`): The state for which the pdf is to be</span>
</span><span id="IDPModel.meanRDGpdf-543"><a href="#IDPModel.meanRDGpdf-543"><span class="linenos">543</span></a><span class="sd">            computed.</span>
</span><span id="IDPModel.meanRDGpdf-544"><a href="#IDPModel.meanRDGpdf-544"><span class="linenos">544</span></a><span class="sd">        * **bandwidth** (`float`): The bandwidth to use in the Gaussian</span>
</span><span id="IDPModel.meanRDGpdf-545"><a href="#IDPModel.meanRDGpdf-545"><span class="linenos">545</span></a><span class="sd">            KDE. If omitted, the bandwidth will be calculated using</span>
</span><span id="IDPModel.meanRDGpdf-546"><a href="#IDPModel.meanRDGpdf-546"><span class="linenos">546</span></a><span class="sd">            Scott&#39;s Rule. The calculated value can be retrieved using</span>
</span><span id="IDPModel.meanRDGpdf-547"><a href="#IDPModel.meanRDGpdf-547"><span class="linenos">547</span></a><span class="sd">            the `bandwidth` property. This argument is passed directly</span>
</span><span id="IDPModel.meanRDGpdf-548"><a href="#IDPModel.meanRDGpdf-548"><span class="linenos">548</span></a><span class="sd">            to the `gaussian_kde` function in the `scipy.stats` module.</span>
</span><span id="IDPModel.meanRDGpdf-549"><a href="#IDPModel.meanRDGpdf-549"><span class="linenos">549</span></a><span class="sd">            See that documentation for further details.</span>
</span><span id="IDPModel.meanRDGpdf-550"><a href="#IDPModel.meanRDGpdf-550"><span class="linenos">550</span></a>
</span><span id="IDPModel.meanRDGpdf-551"><a href="#IDPModel.meanRDGpdf-551"><span class="linenos">551</span></a><span class="sd">        **Returns:**</span>
</span><span id="IDPModel.meanRDGpdf-552"><a href="#IDPModel.meanRDGpdf-552"><span class="linenos">552</span></a>
</span><span id="IDPModel.meanRDGpdf-553"><a href="#IDPModel.meanRDGpdf-553"><span class="linenos">553</span></a><span class="sd">        * `float`: The value of the approximate pdf at the given point.</span>
</span><span id="IDPModel.meanRDGpdf-554"><a href="#IDPModel.meanRDGpdf-554"><span class="linenos">554</span></a>
</span><span id="IDPModel.meanRDGpdf-555"><a href="#IDPModel.meanRDGpdf-555"><span class="linenos">555</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="IDPModel.meanRDGpdf-556"><a href="#IDPModel.meanRDGpdf-556"><span class="linenos">556</span></a>        <span class="n">colConc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idp</span><span class="p">[</span><span class="s1">&#39;colConc&#39;</span><span class="p">]</span>
</span><span id="IDPModel.meanRDGpdf-557"><a href="#IDPModel.meanRDGpdf-557"><span class="linenos">557</span></a>        <span class="n">numRows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowCounts</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGpdf-558"><a href="#IDPModel.meanRDGpdf-558"><span class="linenos">558</span></a>
</span><span id="IDPModel.meanRDGpdf-559"><a href="#IDPModel.meanRDGpdf-559"><span class="linenos">559</span></a>        <span class="n">sample</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_makeSample</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGpdf-560"><a href="#IDPModel.meanRDGpdf-560"><span class="linenos">560</span></a>        <span class="n">samplePDF</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">bandwidth</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGpdf-561"><a href="#IDPModel.meanRDGpdf-561"><span class="linenos">561</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_bandwidth</span> <span class="o">=</span> <span class="n">samplePDF</span><span class="o">.</span><span class="n">factor</span>
</span><span id="IDPModel.meanRDGpdf-562"><a href="#IDPModel.meanRDGpdf-562"><span class="linenos">562</span></a>
</span><span id="IDPModel.meanRDGpdf-563"><a href="#IDPModel.meanRDGpdf-563"><span class="linenos">563</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="IDPModel.meanRDGpdf-564"><a href="#IDPModel.meanRDGpdf-564"><span class="linenos">564</span></a>            <span class="p">(</span><span class="n">colConc</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prior</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span>
</span><span id="IDPModel.meanRDGpdf-565"><a href="#IDPModel.meanRDGpdf-565"><span class="linenos">565</span></a>            <span class="p">(</span><span class="n">numRows</span> <span class="o">/</span> <span class="p">(</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">numRows</span><span class="p">))</span> <span class="o">*</span> <span class="n">samplePDF</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</span><span id="IDPModel.meanRDGpdf-566"><a href="#IDPModel.meanRDGpdf-566"><span class="linenos">566</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This method evaluates an approximate density (pdf) for the
mean of the RDG for the given state. (See <code><a href="#IDPModel.meanRDGcdf">meanRDGcdf</a></code> for an
explanation of the RDG.) The mean of the RDG has a discrete
component, and therefore has no density. This method creates an
approximate density using Gaussian kernel density estimation
(KDE). More specifically, it treats the point mass $\delta_x$ as
having a Gaussian density with mean $x$ and standard deviation
$h$, where $h$ is the "bandwidth" of the estimate.</p>

<p><strong>Arguments:</strong></p>

<ul>
<li><strong>t</strong> (<code>float</code>): The point at which to evaluate the
approximate pdf.</li>
<li><strong>state</strong> (<code>int</code>): The state for which the pdf is to be
computed.</li>
<li><strong>bandwidth</strong> (<code>float</code>): The bandwidth to use in the Gaussian
KDE. If omitted, the bandwidth will be calculated using
Scott's Rule. The calculated value can be retrieved using
the <code><a href="#IDPModel.bandwidth">bandwidth</a></code> property. This argument is passed directly
to the <code>gaussian_kde</code> function in the <code>scipy.stats</code> module.
See that documentation for further details.</li>
</ul>

<p><strong>Returns:</strong></p>

<ul>
<li><code>float</code>: The value of the approximate pdf at the given point.</li>
</ul>
</div>


                            </div>
                </section>
                <section id="WeightedSim">
                            <input id="WeightedSim-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">WeightedSim</span>:

                <label class="view-source-button" for="WeightedSim-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim-568"><a href="#WeightedSim-568"><span class="linenos">568</span></a><span class="k">class</span> <span class="nc">WeightedSim</span><span class="p">:</span>
</span><span id="WeightedSim-569"><a href="#WeightedSim-569"><span class="linenos">569</span></a>    <span class="sa">r</span><span class="sd">&#39;&#39;&#39;A weighted simulation for an `IDPModel` instance.</span>
</span><span id="WeightedSim-570"><a href="#WeightedSim-570"><span class="linenos">570</span></a>
</span><span id="WeightedSim-571"><a href="#WeightedSim-571"><span class="linenos">571</span></a><span class="sd">    In the Paper, a weighted simulation is determined by the pair $(t,</span>
</span><span id="WeightedSim-572"><a href="#WeightedSim-572"><span class="linenos">572</span></a><span class="sd">    \boldsymbol{\theta}_M^*)$ and has total weight $V$.</span>
</span><span id="WeightedSim-573"><a href="#WeightedSim-573"><span class="linenos">573</span></a>
</span><span id="WeightedSim-574"><a href="#WeightedSim-574"><span class="linenos">574</span></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="WeightedSim-575"><a href="#WeightedSim-575"><span class="linenos">575</span></a>
</span><span id="WeightedSim-576"><a href="#WeightedSim-576"><span class="linenos">576</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idpModel</span><span class="p">):</span>
</span><span id="WeightedSim-577"><a href="#WeightedSim-577"><span class="linenos">577</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Uses the given argument to set the corresponding property,</span>
</span><span id="WeightedSim-578"><a href="#WeightedSim-578"><span class="linenos">578</span></a><span class="sd">        then runs the `updateRowCounts` method.</span>
</span><span id="WeightedSim-579"><a href="#WeightedSim-579"><span class="linenos">579</span></a>
</span><span id="WeightedSim-580"><a href="#WeightedSim-580"><span class="linenos">580</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-581"><a href="#WeightedSim-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span> <span class="o">=</span> <span class="n">idpModel</span>
</span><span id="WeightedSim-582"><a href="#WeightedSim-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="c1"># stored copy to detect changes</span>
</span><span id="WeightedSim-583"><a href="#WeightedSim-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WeightedSim-584"><a href="#WeightedSim-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WeightedSim-585"><a href="#WeightedSim-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># the natural logarithm of the total weight</span>
</span><span id="WeightedSim-586"><a href="#WeightedSim-586"><span class="linenos">586</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span><span id="WeightedSim-587"><a href="#WeightedSim-587"><span class="linenos">587</span></a>
</span><span id="WeightedSim-588"><a href="#WeightedSim-588"><span class="linenos">588</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim-589"><a href="#WeightedSim-589"><span class="linenos">589</span></a>    <span class="k">def</span> <span class="nf">idpModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-590"><a href="#WeightedSim-590"><span class="linenos">590</span></a>        <span class="sd">&#39;&#39;&#39;`IDPModel`: The IDP model for which the weighted simulation</span>
</span><span id="WeightedSim-591"><a href="#WeightedSim-591"><span class="linenos">591</span></a><span class="sd">        is being created.</span>
</span><span id="WeightedSim-592"><a href="#WeightedSim-592"><span class="linenos">592</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-593"><a href="#WeightedSim-593"><span class="linenos">593</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span>
</span><span id="WeightedSim-594"><a href="#WeightedSim-594"><span class="linenos">594</span></a>
</span><span id="WeightedSim-595"><a href="#WeightedSim-595"><span class="linenos">595</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim-596"><a href="#WeightedSim-596"><span class="linenos">596</span></a>    <span class="k">def</span> <span class="nf">rowWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-597"><a href="#WeightedSim-597"><span class="linenos">597</span></a>        <span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): The triangular array of row</span>
</span><span id="WeightedSim-598"><a href="#WeightedSim-598"><span class="linenos">598</span></a><span class="sd">        weights for the weighted simulation. Denoted by $t$ in Section 9</span>
</span><span id="WeightedSim-599"><a href="#WeightedSim-599"><span class="linenos">599</span></a><span class="sd">        of the Paper.</span>
</span><span id="WeightedSim-600"><a href="#WeightedSim-600"><span class="linenos">600</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-601"><a href="#WeightedSim-601"><span class="linenos">601</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">)</span>
</span><span id="WeightedSim-602"><a href="#WeightedSim-602"><span class="linenos">602</span></a>
</span><span id="WeightedSim-603"><a href="#WeightedSim-603"><span class="linenos">603</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim-604"><a href="#WeightedSim-604"><span class="linenos">604</span></a>    <span class="k">def</span> <span class="nf">rowDistSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-605"><a href="#WeightedSim-605"><span class="linenos">605</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): A tuple of simulated row</span>
</span><span id="WeightedSim-606"><a href="#WeightedSim-606"><span class="linenos">606</span></a><span class="sd">        distributions. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="WeightedSim-607"><a href="#WeightedSim-607"><span class="linenos">607</span></a><span class="sd">        `rowDistSims`[`row`][`state`] is denoted by $\theta_{m\ell}^*</span>
</span><span id="WeightedSim-608"><a href="#WeightedSim-608"><span class="linenos">608</span></a><span class="sd">        = u_m^*(\{\ell\})$ in Section 9 of the Paper.</span>
</span><span id="WeightedSim-609"><a href="#WeightedSim-609"><span class="linenos">609</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-610"><a href="#WeightedSim-610"><span class="linenos">610</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span><span id="WeightedSim-611"><a href="#WeightedSim-611"><span class="linenos">611</span></a>
</span><span id="WeightedSim-612"><a href="#WeightedSim-612"><span class="linenos">612</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim-613"><a href="#WeightedSim-613"><span class="linenos">613</span></a>    <span class="k">def</span> <span class="nf">totalWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-614"><a href="#WeightedSim-614"><span class="linenos">614</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The total weight of the simulation. Denoted by $V$</span>
</span><span id="WeightedSim-615"><a href="#WeightedSim-615"><span class="linenos">615</span></a><span class="sd">        in Section 9 of the Paper.</span>
</span><span id="WeightedSim-616"><a href="#WeightedSim-616"><span class="linenos">616</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-617"><a href="#WeightedSim-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span>
</span><span id="WeightedSim-618"><a href="#WeightedSim-618"><span class="linenos">618</span></a>
</span><span id="WeightedSim-619"><a href="#WeightedSim-619"><span class="linenos">619</span></a>    <span class="k">def</span> <span class="nf">updateRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-620"><a href="#WeightedSim-620"><span class="linenos">620</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `rowWeights`, `rowDistSims`, and `totalWeight`</span>
</span><span id="WeightedSim-621"><a href="#WeightedSim-621"><span class="linenos">621</span></a><span class="sd">        properties, if necessary, so that the number of rows in</span>
</span><span id="WeightedSim-622"><a href="#WeightedSim-622"><span class="linenos">622</span></a><span class="sd">        `rowDistSims` is the same as the number of rows in the</span>
</span><span id="WeightedSim-623"><a href="#WeightedSim-623"><span class="linenos">623</span></a><span class="sd">        `IDPModel.rowCounts` property of the associated `idpModel`</span>
</span><span id="WeightedSim-624"><a href="#WeightedSim-624"><span class="linenos">624</span></a><span class="sd">        instance.</span>
</span><span id="WeightedSim-625"><a href="#WeightedSim-625"><span class="linenos">625</span></a>
</span><span id="WeightedSim-626"><a href="#WeightedSim-626"><span class="linenos">626</span></a><span class="sd">        **Raises:**</span>
</span><span id="WeightedSim-627"><a href="#WeightedSim-627"><span class="linenos">627</span></a>
</span><span id="WeightedSim-628"><a href="#WeightedSim-628"><span class="linenos">628</span></a><span class="sd">        * **ValueError**: If the computed value for the `totalWeight`</span>
</span><span id="WeightedSim-629"><a href="#WeightedSim-629"><span class="linenos">629</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="WeightedSim-630"><a href="#WeightedSim-630"><span class="linenos">630</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="WeightedSim-631"><a href="#WeightedSim-631"><span class="linenos">631</span></a>
</span><span id="WeightedSim-632"><a href="#WeightedSim-632"><span class="linenos">632</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-633"><a href="#WeightedSim-633"><span class="linenos">633</span></a>        <span class="c1"># If $L$ is the number of states in the IDP, then the case</span>
</span><span id="WeightedSim-634"><a href="#WeightedSim-634"><span class="linenos">634</span></a>        <span class="c1"># $L = 2$ is separated from the case $2 &lt; L &lt; \infty$ to speed</span>
</span><span id="WeightedSim-635"><a href="#WeightedSim-635"><span class="linenos">635</span></a>        <span class="c1"># up code execution.</span>
</span><span id="WeightedSim-636"><a href="#WeightedSim-636"><span class="linenos">636</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="WeightedSim-637"><a href="#WeightedSim-637"><span class="linenos">637</span></a>        <span class="n">numStates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="WeightedSim-638"><a href="#WeightedSim-638"><span class="linenos">638</span></a>
</span><span id="WeightedSim-639"><a href="#WeightedSim-639"><span class="linenos">639</span></a>        <span class="c1"># expand properties if row counts have been added</span>
</span><span id="WeightedSim-640"><a href="#WeightedSim-640"><span class="linenos">640</span></a>        <span class="n">numOldSims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span><span id="WeightedSim-641"><a href="#WeightedSim-641"><span class="linenos">641</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">[</span><span class="n">numOldSims</span><span class="p">:]):</span>
</span><span id="WeightedSim-642"><a href="#WeightedSim-642"><span class="linenos">642</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">numOldSims</span> <span class="o">+</span> <span class="n">_</span>
</span><span id="WeightedSim-643"><a href="#WeightedSim-643"><span class="linenos">643</span></a>
</span><span id="WeightedSim-644"><a href="#WeightedSim-644"><span class="linenos">644</span></a>            <span class="c1"># build `rowWeights[m]`</span>
</span><span id="WeightedSim-645"><a href="#WeightedSim-645"><span class="linenos">645</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
</span><span id="WeightedSim-646"><a href="#WeightedSim-646"><span class="linenos">646</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="WeightedSim-647"><a href="#WeightedSim-647"><span class="linenos">647</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="WeightedSim-648"><a href="#WeightedSim-648"><span class="linenos">648</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim-649"><a href="#WeightedSim-649"><span class="linenos">649</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span>
</span><span id="WeightedSim-650"><a href="#WeightedSim-650"><span class="linenos">650</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="WeightedSim-651"><a href="#WeightedSim-651"><span class="linenos">651</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim-652"><a href="#WeightedSim-652"><span class="linenos">652</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim-653"><a href="#WeightedSim-653"><span class="linenos">653</span></a>                    <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim-654"><a href="#WeightedSim-654"><span class="linenos">654</span></a>                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numStates</span><span class="p">):</span>
</span><span id="WeightedSim-655"><a href="#WeightedSim-655"><span class="linenos">655</span></a>                        <span class="n">weight</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">state</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="WeightedSim-656"><a href="#WeightedSim-656"><span class="linenos">656</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
</span><span id="WeightedSim-657"><a href="#WeightedSim-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim-658"><a href="#WeightedSim-658"><span class="linenos">658</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</span><span id="WeightedSim-659"><a href="#WeightedSim-659"><span class="linenos">659</span></a>            <span class="p">)</span>
</span><span id="WeightedSim-660"><a href="#WeightedSim-660"><span class="linenos">660</span></a>
</span><span id="WeightedSim-661"><a href="#WeightedSim-661"><span class="linenos">661</span></a>            <span class="c1"># build `rowDistSims[m]`</span>
</span><span id="WeightedSim-662"><a href="#WeightedSim-662"><span class="linenos">662</span></a>            <span class="n">choice</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim-663"><a href="#WeightedSim-663"><span class="linenos">663</span></a>            <span class="k">if</span> <span class="n">choice</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
</span><span id="WeightedSim-664"><a href="#WeightedSim-664"><span class="linenos">664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
</span><span id="WeightedSim-665"><a href="#WeightedSim-665"><span class="linenos">665</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim-666"><a href="#WeightedSim-666"><span class="linenos">666</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="WeightedSim-667"><a href="#WeightedSim-667"><span class="linenos">667</span></a>                    <span class="n">rowDistSim</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="WeightedSim-668"><a href="#WeightedSim-668"><span class="linenos">668</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="WeightedSim-669"><a href="#WeightedSim-669"><span class="linenos">669</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim-670"><a href="#WeightedSim-670"><span class="linenos">670</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim-671"><a href="#WeightedSim-671"><span class="linenos">671</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rowDistSim</span><span class="p">,</span> <span class="n">rowDistSim</span><span class="p">])</span>
</span><span id="WeightedSim-672"><a href="#WeightedSim-672"><span class="linenos">672</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim-673"><a href="#WeightedSim-673"><span class="linenos">673</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim-674"><a href="#WeightedSim-674"><span class="linenos">674</span></a>                        <span class="c1"># vector sum fails for lists, works for ndarray</span>
</span><span id="WeightedSim-675"><a href="#WeightedSim-675"><span class="linenos">675</span></a>                        <span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="WeightedSim-676"><a href="#WeightedSim-676"><span class="linenos">676</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">counts</span>
</span><span id="WeightedSim-677"><a href="#WeightedSim-677"><span class="linenos">677</span></a>                        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim-678"><a href="#WeightedSim-678"><span class="linenos">678</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim-679"><a href="#WeightedSim-679"><span class="linenos">679</span></a>
</span><span id="WeightedSim-680"><a href="#WeightedSim-680"><span class="linenos">680</span></a>            <span class="c1"># build `totalWeight`</span>
</span><span id="WeightedSim-681"><a href="#WeightedSim-681"><span class="linenos">681</span></a>            <span class="c1">#</span>
</span><span id="WeightedSim-682"><a href="#WeightedSim-682"><span class="linenos">682</span></a>            <span class="c1"># The m-th iteration of the `for` loop multiplies the</span>
</span><span id="WeightedSim-683"><a href="#WeightedSim-683"><span class="linenos">683</span></a>            <span class="c1"># previous value of `totalWeight` by the (m + 1)-th factor</span>
</span><span id="WeightedSim-684"><a href="#WeightedSim-684"><span class="linenos">684</span></a>            <span class="c1"># in the definition of $V$ in Section 9 of the Paper.</span>
</span><span id="WeightedSim-685"><a href="#WeightedSim-685"><span class="linenos">685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="WeightedSim-686"><a href="#WeightedSim-686"><span class="linenos">686</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="WeightedSim-687"><a href="#WeightedSim-687"><span class="linenos">687</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="WeightedSim-688"><a href="#WeightedSim-688"><span class="linenos">688</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="WeightedSim-689"><a href="#WeightedSim-689"><span class="linenos">689</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="WeightedSim-690"><a href="#WeightedSim-690"><span class="linenos">690</span></a>            <span class="p">)</span>
</span><span id="WeightedSim-691"><a href="#WeightedSim-691"><span class="linenos">691</span></a>
</span><span id="WeightedSim-692"><a href="#WeightedSim-692"><span class="linenos">692</span></a>        <span class="c1"># check that total weight is not out of bounds</span>
</span><span id="WeightedSim-693"><a href="#WeightedSim-693"><span class="linenos">693</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="WeightedSim-694"><a href="#WeightedSim-694"><span class="linenos">694</span></a>            <span class="n">adj</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="WeightedSim-695"><a href="#WeightedSim-695"><span class="linenos">695</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WeightedSim-696"><a href="#WeightedSim-696"><span class="linenos">696</span></a>                <span class="s1">&#39;Simulation weight out of bounds.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
</span><span id="WeightedSim-697"><a href="#WeightedSim-697"><span class="linenos">697</span></a>                <span class="sa">f</span><span class="s1">&#39;Try adjusting scale factor by </span><span class="si">{</span><span class="n">adj</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WeightedSim-698"><a href="#WeightedSim-698"><span class="linenos">698</span></a>            <span class="p">)</span>
</span><span id="WeightedSim-699"><a href="#WeightedSim-699"><span class="linenos">699</span></a>
</span><span id="WeightedSim-700"><a href="#WeightedSim-700"><span class="linenos">700</span></a>        <span class="c1"># trim properties if row counts have been removed</span>
</span><span id="WeightedSim-701"><a href="#WeightedSim-701"><span class="linenos">701</span></a>        <span class="k">if</span> <span class="n">numOldSims</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">):</span>
</span><span id="WeightedSim-702"><a href="#WeightedSim-702"><span class="linenos">702</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="WeightedSim-703"><a href="#WeightedSim-703"><span class="linenos">703</span></a>                <span class="n">numOldSims</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="WeightedSim-704"><a href="#WeightedSim-704"><span class="linenos">704</span></a>            <span class="p">):</span>
</span><span id="WeightedSim-705"><a href="#WeightedSim-705"><span class="linenos">705</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">-=</span> <span class="p">(</span>
</span><span id="WeightedSim-706"><a href="#WeightedSim-706"><span class="linenos">706</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="WeightedSim-707"><a href="#WeightedSim-707"><span class="linenos">707</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="WeightedSim-708"><a href="#WeightedSim-708"><span class="linenos">708</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="WeightedSim-709"><a href="#WeightedSim-709"><span class="linenos">709</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="WeightedSim-710"><a href="#WeightedSim-710"><span class="linenos">710</span></a>                <span class="p">)</span>
</span><span id="WeightedSim-711"><a href="#WeightedSim-711"><span class="linenos">711</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="WeightedSim-712"><a href="#WeightedSim-712"><span class="linenos">712</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="WeightedSim-713"><a href="#WeightedSim-713"><span class="linenos">713</span></a>
</span><span id="WeightedSim-714"><a href="#WeightedSim-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">updateScale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim-715"><a href="#WeightedSim-715"><span class="linenos">715</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `totalWeight` property, if necessary, to account</span>
</span><span id="WeightedSim-716"><a href="#WeightedSim-716"><span class="linenos">716</span></a><span class="sd">        for a change in the `IDPModel.scale` property of the associated</span>
</span><span id="WeightedSim-717"><a href="#WeightedSim-717"><span class="linenos">717</span></a><span class="sd">        `idpModel` instance.</span>
</span><span id="WeightedSim-718"><a href="#WeightedSim-718"><span class="linenos">718</span></a>
</span><span id="WeightedSim-719"><a href="#WeightedSim-719"><span class="linenos">719</span></a><span class="sd">        **Raises:**</span>
</span><span id="WeightedSim-720"><a href="#WeightedSim-720"><span class="linenos">720</span></a>
</span><span id="WeightedSim-721"><a href="#WeightedSim-721"><span class="linenos">721</span></a><span class="sd">        * **ValueError**: If the new value for the `totalWeight`</span>
</span><span id="WeightedSim-722"><a href="#WeightedSim-722"><span class="linenos">722</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="WeightedSim-723"><a href="#WeightedSim-723"><span class="linenos">723</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="WeightedSim-724"><a href="#WeightedSim-724"><span class="linenos">724</span></a>
</span><span id="WeightedSim-725"><a href="#WeightedSim-725"><span class="linenos">725</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim-726"><a href="#WeightedSim-726"><span class="linenos">726</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="WeightedSim-727"><a href="#WeightedSim-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="n">diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WeightedSim-728"><a href="#WeightedSim-728"><span class="linenos">728</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span> <span class="o">*</span> <span class="n">diff</span>
</span><span id="WeightedSim-729"><a href="#WeightedSim-729"><span class="linenos">729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span>
</span><span id="WeightedSim-730"><a href="#WeightedSim-730"><span class="linenos">730</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="WeightedSim-731"><a href="#WeightedSim-731"><span class="linenos">731</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WeightedSim-732"><a href="#WeightedSim-732"><span class="linenos">732</span></a>                    <span class="s1">&#39;Resulting simulation weight is out of bounds&#39;</span>
</span><span id="WeightedSim-733"><a href="#WeightedSim-733"><span class="linenos">733</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A weighted simulation for an <code><a href="#IDPModel">IDPModel</a></code> instance.</p>

<p>In the Paper, a weighted simulation is determined by the pair $(t,
\boldsymbol{\theta}_M^*)$ and has total weight $V$.</p>
</div>


                            <div id="WeightedSim.__init__" class="classattr">
                                        <input id="WeightedSim.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">WeightedSim</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">idpModel</span></span>)</span>

                <label class="view-source-button" for="WeightedSim.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.__init__-576"><a href="#WeightedSim.__init__-576"><span class="linenos">576</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idpModel</span><span class="p">):</span>
</span><span id="WeightedSim.__init__-577"><a href="#WeightedSim.__init__-577"><span class="linenos">577</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;Uses the given argument to set the corresponding property,</span>
</span><span id="WeightedSim.__init__-578"><a href="#WeightedSim.__init__-578"><span class="linenos">578</span></a><span class="sd">        then runs the `updateRowCounts` method.</span>
</span><span id="WeightedSim.__init__-579"><a href="#WeightedSim.__init__-579"><span class="linenos">579</span></a>
</span><span id="WeightedSim.__init__-580"><a href="#WeightedSim.__init__-580"><span class="linenos">580</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.__init__-581"><a href="#WeightedSim.__init__-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span> <span class="o">=</span> <span class="n">idpModel</span>
</span><span id="WeightedSim.__init__-582"><a href="#WeightedSim.__init__-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="n">idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="c1"># stored copy to detect changes</span>
</span><span id="WeightedSim.__init__-583"><a href="#WeightedSim.__init__-583"><span class="linenos">583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WeightedSim.__init__-584"><a href="#WeightedSim.__init__-584"><span class="linenos">584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="WeightedSim.__init__-585"><a href="#WeightedSim.__init__-585"><span class="linenos">585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># the natural logarithm of the total weight</span>
</span><span id="WeightedSim.__init__-586"><a href="#WeightedSim.__init__-586"><span class="linenos">586</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">updateRowCounts</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Uses the given argument to set the corresponding property,
then runs the <code><a href="#WeightedSim.updateRowCounts">updateRowCounts</a></code> method.</p>
</div>


                            </div>
                            <div id="WeightedSim.idpModel" class="classattr">
                                        <input id="WeightedSim.idpModel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">idpModel</span>

                <label class="view-source-button" for="WeightedSim.idpModel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.idpModel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.idpModel-588"><a href="#WeightedSim.idpModel-588"><span class="linenos">588</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim.idpModel-589"><a href="#WeightedSim.idpModel-589"><span class="linenos">589</span></a>    <span class="k">def</span> <span class="nf">idpModel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.idpModel-590"><a href="#WeightedSim.idpModel-590"><span class="linenos">590</span></a>        <span class="sd">&#39;&#39;&#39;`IDPModel`: The IDP model for which the weighted simulation</span>
</span><span id="WeightedSim.idpModel-591"><a href="#WeightedSim.idpModel-591"><span class="linenos">591</span></a><span class="sd">        is being created.</span>
</span><span id="WeightedSim.idpModel-592"><a href="#WeightedSim.idpModel-592"><span class="linenos">592</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.idpModel-593"><a href="#WeightedSim.idpModel-593"><span class="linenos">593</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span>
</span></pre></div>


            <div class="docstring"><p><code><a href="#IDPModel">IDPModel</a></code>: The IDP model for which the weighted simulation
is being created.</p>
</div>


                            </div>
                            <div id="WeightedSim.rowWeights" class="classattr">
                                        <input id="WeightedSim.rowWeights-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rowWeights</span>

                <label class="view-source-button" for="WeightedSim.rowWeights-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.rowWeights"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.rowWeights-595"><a href="#WeightedSim.rowWeights-595"><span class="linenos">595</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim.rowWeights-596"><a href="#WeightedSim.rowWeights-596"><span class="linenos">596</span></a>    <span class="k">def</span> <span class="nf">rowWeights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.rowWeights-597"><a href="#WeightedSim.rowWeights-597"><span class="linenos">597</span></a>        <span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): The triangular array of row</span>
</span><span id="WeightedSim.rowWeights-598"><a href="#WeightedSim.rowWeights-598"><span class="linenos">598</span></a><span class="sd">        weights for the weighted simulation. Denoted by $t$ in Section 9</span>
</span><span id="WeightedSim.rowWeights-599"><a href="#WeightedSim.rowWeights-599"><span class="linenos">599</span></a><span class="sd">        of the Paper.</span>
</span><span id="WeightedSim.rowWeights-600"><a href="#WeightedSim.rowWeights-600"><span class="linenos">600</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.rowWeights-601"><a href="#WeightedSim.rowWeights-601"><span class="linenos">601</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code>tuple</code>(<code>float</code>)): The triangular array of row
weights for the weighted simulation. Denoted by $t$ in Section 9
of the Paper.</p>
</div>


                            </div>
                            <div id="WeightedSim.rowDistSims" class="classattr">
                                        <input id="WeightedSim.rowDistSims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">rowDistSims</span>

                <label class="view-source-button" for="WeightedSim.rowDistSims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.rowDistSims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.rowDistSims-603"><a href="#WeightedSim.rowDistSims-603"><span class="linenos">603</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim.rowDistSims-604"><a href="#WeightedSim.rowDistSims-604"><span class="linenos">604</span></a>    <span class="k">def</span> <span class="nf">rowDistSims</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.rowDistSims-605"><a href="#WeightedSim.rowDistSims-605"><span class="linenos">605</span></a>        <span class="sa">r</span><span class="sd">&#39;&#39;&#39;`tuple`(`tuple`(`float`)): A tuple of simulated row</span>
</span><span id="WeightedSim.rowDistSims-606"><a href="#WeightedSim.rowDistSims-606"><span class="linenos">606</span></a><span class="sd">        distributions. If `row` is $m - 1$ and `state` is $\ell$, then</span>
</span><span id="WeightedSim.rowDistSims-607"><a href="#WeightedSim.rowDistSims-607"><span class="linenos">607</span></a><span class="sd">        `rowDistSims`[`row`][`state`] is denoted by $\theta_{m\ell}^*</span>
</span><span id="WeightedSim.rowDistSims-608"><a href="#WeightedSim.rowDistSims-608"><span class="linenos">608</span></a><span class="sd">        = u_m^*(\{\ell\})$ in Section 9 of the Paper.</span>
</span><span id="WeightedSim.rowDistSims-609"><a href="#WeightedSim.rowDistSims-609"><span class="linenos">609</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.rowDistSims-610"><a href="#WeightedSim.rowDistSims-610"><span class="linenos">610</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>tuple</code>(<code>tuple</code>(<code>float</code>)): A tuple of simulated row
distributions. If <code>row</code> is $m - 1$ and <code>state</code> is $\ell$, then
<code><a href="#WeightedSim.rowDistSims">rowDistSims</a></code>[<code>row</code>][<code>state</code>] is denoted by $\theta_{m\ell}^*
= u_m^*({\ell})$ in Section 9 of the Paper.</p>
</div>


                            </div>
                            <div id="WeightedSim.totalWeight" class="classattr">
                                        <input id="WeightedSim.totalWeight-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">totalWeight</span>

                <label class="view-source-button" for="WeightedSim.totalWeight-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.totalWeight"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.totalWeight-612"><a href="#WeightedSim.totalWeight-612"><span class="linenos">612</span></a>    <span class="nd">@property</span>
</span><span id="WeightedSim.totalWeight-613"><a href="#WeightedSim.totalWeight-613"><span class="linenos">613</span></a>    <span class="k">def</span> <span class="nf">totalWeight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.totalWeight-614"><a href="#WeightedSim.totalWeight-614"><span class="linenos">614</span></a>        <span class="sd">&#39;&#39;&#39;`float`: The total weight of the simulation. Denoted by $V$</span>
</span><span id="WeightedSim.totalWeight-615"><a href="#WeightedSim.totalWeight-615"><span class="linenos">615</span></a><span class="sd">        in Section 9 of the Paper.</span>
</span><span id="WeightedSim.totalWeight-616"><a href="#WeightedSim.totalWeight-616"><span class="linenos">616</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.totalWeight-617"><a href="#WeightedSim.totalWeight-617"><span class="linenos">617</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p><code>float</code>: The total weight of the simulation. Denoted by $V$
in Section 9 of the Paper.</p>
</div>


                            </div>
                            <div id="WeightedSim.updateRowCounts" class="classattr">
                                        <input id="WeightedSim.updateRowCounts-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updateRowCounts</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WeightedSim.updateRowCounts-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.updateRowCounts"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.updateRowCounts-619"><a href="#WeightedSim.updateRowCounts-619"><span class="linenos">619</span></a>    <span class="k">def</span> <span class="nf">updateRowCounts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-620"><a href="#WeightedSim.updateRowCounts-620"><span class="linenos">620</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `rowWeights`, `rowDistSims`, and `totalWeight`</span>
</span><span id="WeightedSim.updateRowCounts-621"><a href="#WeightedSim.updateRowCounts-621"><span class="linenos">621</span></a><span class="sd">        properties, if necessary, so that the number of rows in</span>
</span><span id="WeightedSim.updateRowCounts-622"><a href="#WeightedSim.updateRowCounts-622"><span class="linenos">622</span></a><span class="sd">        `rowDistSims` is the same as the number of rows in the</span>
</span><span id="WeightedSim.updateRowCounts-623"><a href="#WeightedSim.updateRowCounts-623"><span class="linenos">623</span></a><span class="sd">        `IDPModel.rowCounts` property of the associated `idpModel`</span>
</span><span id="WeightedSim.updateRowCounts-624"><a href="#WeightedSim.updateRowCounts-624"><span class="linenos">624</span></a><span class="sd">        instance.</span>
</span><span id="WeightedSim.updateRowCounts-625"><a href="#WeightedSim.updateRowCounts-625"><span class="linenos">625</span></a>
</span><span id="WeightedSim.updateRowCounts-626"><a href="#WeightedSim.updateRowCounts-626"><span class="linenos">626</span></a><span class="sd">        **Raises:**</span>
</span><span id="WeightedSim.updateRowCounts-627"><a href="#WeightedSim.updateRowCounts-627"><span class="linenos">627</span></a>
</span><span id="WeightedSim.updateRowCounts-628"><a href="#WeightedSim.updateRowCounts-628"><span class="linenos">628</span></a><span class="sd">        * **ValueError**: If the computed value for the `totalWeight`</span>
</span><span id="WeightedSim.updateRowCounts-629"><a href="#WeightedSim.updateRowCounts-629"><span class="linenos">629</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="WeightedSim.updateRowCounts-630"><a href="#WeightedSim.updateRowCounts-630"><span class="linenos">630</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="WeightedSim.updateRowCounts-631"><a href="#WeightedSim.updateRowCounts-631"><span class="linenos">631</span></a>
</span><span id="WeightedSim.updateRowCounts-632"><a href="#WeightedSim.updateRowCounts-632"><span class="linenos">632</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.updateRowCounts-633"><a href="#WeightedSim.updateRowCounts-633"><span class="linenos">633</span></a>        <span class="c1"># If $L$ is the number of states in the IDP, then the case</span>
</span><span id="WeightedSim.updateRowCounts-634"><a href="#WeightedSim.updateRowCounts-634"><span class="linenos">634</span></a>        <span class="c1"># $L = 2$ is separated from the case $2 &lt; L &lt; \infty$ to speed</span>
</span><span id="WeightedSim.updateRowCounts-635"><a href="#WeightedSim.updateRowCounts-635"><span class="linenos">635</span></a>        <span class="c1"># up code execution.</span>
</span><span id="WeightedSim.updateRowCounts-636"><a href="#WeightedSim.updateRowCounts-636"><span class="linenos">636</span></a>        <span class="n">baseMeas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-637"><a href="#WeightedSim.updateRowCounts-637"><span class="linenos">637</span></a>        <span class="n">numStates</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">baseMeas</span><span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-638"><a href="#WeightedSim.updateRowCounts-638"><span class="linenos">638</span></a>
</span><span id="WeightedSim.updateRowCounts-639"><a href="#WeightedSim.updateRowCounts-639"><span class="linenos">639</span></a>        <span class="c1"># expand properties if row counts have been added</span>
</span><span id="WeightedSim.updateRowCounts-640"><a href="#WeightedSim.updateRowCounts-640"><span class="linenos">640</span></a>        <span class="n">numOldSims</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-641"><a href="#WeightedSim.updateRowCounts-641"><span class="linenos">641</span></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">counts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">[</span><span class="n">numOldSims</span><span class="p">:]):</span>
</span><span id="WeightedSim.updateRowCounts-642"><a href="#WeightedSim.updateRowCounts-642"><span class="linenos">642</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="n">numOldSims</span> <span class="o">+</span> <span class="n">_</span>
</span><span id="WeightedSim.updateRowCounts-643"><a href="#WeightedSim.updateRowCounts-643"><span class="linenos">643</span></a>
</span><span id="WeightedSim.updateRowCounts-644"><a href="#WeightedSim.updateRowCounts-644"><span class="linenos">644</span></a>            <span class="c1"># build `rowWeights[m]`</span>
</span><span id="WeightedSim.updateRowCounts-645"><a href="#WeightedSim.updateRowCounts-645"><span class="linenos">645</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
</span><span id="WeightedSim.updateRowCounts-646"><a href="#WeightedSim.updateRowCounts-646"><span class="linenos">646</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-647"><a href="#WeightedSim.updateRowCounts-647"><span class="linenos">647</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-648"><a href="#WeightedSim.updateRowCounts-648"><span class="linenos">648</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-649"><a href="#WeightedSim.updateRowCounts-649"><span class="linenos">649</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span>
</span><span id="WeightedSim.updateRowCounts-650"><a href="#WeightedSim.updateRowCounts-650"><span class="linenos">650</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-651"><a href="#WeightedSim.updateRowCounts-651"><span class="linenos">651</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-652"><a href="#WeightedSim.updateRowCounts-652"><span class="linenos">652</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-653"><a href="#WeightedSim.updateRowCounts-653"><span class="linenos">653</span></a>                    <span class="n">weight</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-654"><a href="#WeightedSim.updateRowCounts-654"><span class="linenos">654</span></a>                    <span class="k">for</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">numStates</span><span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-655"><a href="#WeightedSim.updateRowCounts-655"><span class="linenos">655</span></a>                        <span class="n">weight</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">state</span><span class="p">]</span> <span class="o">**</span> <span class="n">counts</span><span class="p">[</span><span class="n">state</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-656"><a href="#WeightedSim.updateRowCounts-656"><span class="linenos">656</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-657"><a href="#WeightedSim.updateRowCounts-657"><span class="linenos">657</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-658"><a href="#WeightedSim.updateRowCounts-658"><span class="linenos">658</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">likelihoods</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-659"><a href="#WeightedSim.updateRowCounts-659"><span class="linenos">659</span></a>            <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-660"><a href="#WeightedSim.updateRowCounts-660"><span class="linenos">660</span></a>
</span><span id="WeightedSim.updateRowCounts-661"><a href="#WeightedSim.updateRowCounts-661"><span class="linenos">661</span></a>            <span class="c1"># build `rowDistSims[m]`</span>
</span><span id="WeightedSim.updateRowCounts-662"><a href="#WeightedSim.updateRowCounts-662"><span class="linenos">662</span></a>            <span class="n">choice</span> <span class="o">=</span> <span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">weights</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-663"><a href="#WeightedSim.updateRowCounts-663"><span class="linenos">663</span></a>            <span class="k">if</span> <span class="n">choice</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-664"><a href="#WeightedSim.updateRowCounts-664"><span class="linenos">664</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="n">choice</span><span class="p">])</span>
</span><span id="WeightedSim.updateRowCounts-665"><a href="#WeightedSim.updateRowCounts-665"><span class="linenos">665</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-666"><a href="#WeightedSim.updateRowCounts-666"><span class="linenos">666</span></a>                <span class="k">if</span> <span class="n">numStates</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-667"><a href="#WeightedSim.updateRowCounts-667"><span class="linenos">667</span></a>                    <span class="n">rowDistSim</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-668"><a href="#WeightedSim.updateRowCounts-668"><span class="linenos">668</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
</span><span id="WeightedSim.updateRowCounts-669"><a href="#WeightedSim.updateRowCounts-669"><span class="linenos">669</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-670"><a href="#WeightedSim.updateRowCounts-670"><span class="linenos">670</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-671"><a href="#WeightedSim.updateRowCounts-671"><span class="linenos">671</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">1</span> <span class="o">-</span> <span class="n">rowDistSim</span><span class="p">,</span> <span class="n">rowDistSim</span><span class="p">])</span>
</span><span id="WeightedSim.updateRowCounts-672"><a href="#WeightedSim.updateRowCounts-672"><span class="linenos">672</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="WeightedSim.updateRowCounts-673"><a href="#WeightedSim.updateRowCounts-673"><span class="linenos">673</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-674"><a href="#WeightedSim.updateRowCounts-674"><span class="linenos">674</span></a>                        <span class="c1"># vector sum fails for lists, works for ndarray</span>
</span><span id="WeightedSim.updateRowCounts-675"><a href="#WeightedSim.updateRowCounts-675"><span class="linenos">675</span></a>                        <span class="n">dirichlet</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-676"><a href="#WeightedSim.updateRowCounts-676"><span class="linenos">676</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowConc</span> <span class="o">*</span> <span class="n">baseMeas</span> <span class="o">+</span> <span class="n">counts</span>
</span><span id="WeightedSim.updateRowCounts-677"><a href="#WeightedSim.updateRowCounts-677"><span class="linenos">677</span></a>                        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-678"><a href="#WeightedSim.updateRowCounts-678"><span class="linenos">678</span></a>                    <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-679"><a href="#WeightedSim.updateRowCounts-679"><span class="linenos">679</span></a>
</span><span id="WeightedSim.updateRowCounts-680"><a href="#WeightedSim.updateRowCounts-680"><span class="linenos">680</span></a>            <span class="c1"># build `totalWeight`</span>
</span><span id="WeightedSim.updateRowCounts-681"><a href="#WeightedSim.updateRowCounts-681"><span class="linenos">681</span></a>            <span class="c1">#</span>
</span><span id="WeightedSim.updateRowCounts-682"><a href="#WeightedSim.updateRowCounts-682"><span class="linenos">682</span></a>            <span class="c1"># The m-th iteration of the `for` loop multiplies the</span>
</span><span id="WeightedSim.updateRowCounts-683"><a href="#WeightedSim.updateRowCounts-683"><span class="linenos">683</span></a>            <span class="c1"># previous value of `totalWeight` by the (m + 1)-th factor</span>
</span><span id="WeightedSim.updateRowCounts-684"><a href="#WeightedSim.updateRowCounts-684"><span class="linenos">684</span></a>            <span class="c1"># in the definition of $V$ in Section 9 of the Paper.</span>
</span><span id="WeightedSim.updateRowCounts-685"><a href="#WeightedSim.updateRowCounts-685"><span class="linenos">685</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-686"><a href="#WeightedSim.updateRowCounts-686"><span class="linenos">686</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="WeightedSim.updateRowCounts-687"><a href="#WeightedSim.updateRowCounts-687"><span class="linenos">687</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="WeightedSim.updateRowCounts-688"><a href="#WeightedSim.updateRowCounts-688"><span class="linenos">688</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="WeightedSim.updateRowCounts-689"><a href="#WeightedSim.updateRowCounts-689"><span class="linenos">689</span></a>                <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="WeightedSim.updateRowCounts-690"><a href="#WeightedSim.updateRowCounts-690"><span class="linenos">690</span></a>            <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-691"><a href="#WeightedSim.updateRowCounts-691"><span class="linenos">691</span></a>
</span><span id="WeightedSim.updateRowCounts-692"><a href="#WeightedSim.updateRowCounts-692"><span class="linenos">692</span></a>        <span class="c1"># check that total weight is not out of bounds</span>
</span><span id="WeightedSim.updateRowCounts-693"><a href="#WeightedSim.updateRowCounts-693"><span class="linenos">693</span></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-694"><a href="#WeightedSim.updateRowCounts-694"><span class="linenos">694</span></a>            <span class="n">adj</span> <span class="o">=</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-695"><a href="#WeightedSim.updateRowCounts-695"><span class="linenos">695</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-696"><a href="#WeightedSim.updateRowCounts-696"><span class="linenos">696</span></a>                <span class="s1">&#39;Simulation weight out of bounds.</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
</span><span id="WeightedSim.updateRowCounts-697"><a href="#WeightedSim.updateRowCounts-697"><span class="linenos">697</span></a>                <span class="sa">f</span><span class="s1">&#39;Try adjusting scale factor by </span><span class="si">{</span><span class="n">adj</span><span class="si">}</span><span class="s1">&#39;</span>
</span><span id="WeightedSim.updateRowCounts-698"><a href="#WeightedSim.updateRowCounts-698"><span class="linenos">698</span></a>            <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-699"><a href="#WeightedSim.updateRowCounts-699"><span class="linenos">699</span></a>
</span><span id="WeightedSim.updateRowCounts-700"><a href="#WeightedSim.updateRowCounts-700"><span class="linenos">700</span></a>        <span class="c1"># trim properties if row counts have been removed</span>
</span><span id="WeightedSim.updateRowCounts-701"><a href="#WeightedSim.updateRowCounts-701"><span class="linenos">701</span></a>        <span class="k">if</span> <span class="n">numOldSims</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-702"><a href="#WeightedSim.updateRowCounts-702"><span class="linenos">702</span></a>            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-703"><a href="#WeightedSim.updateRowCounts-703"><span class="linenos">703</span></a>                <span class="n">numOldSims</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">rowCounts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="WeightedSim.updateRowCounts-704"><a href="#WeightedSim.updateRowCounts-704"><span class="linenos">704</span></a>            <span class="p">):</span>
</span><span id="WeightedSim.updateRowCounts-705"><a href="#WeightedSim.updateRowCounts-705"><span class="linenos">705</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">-=</span> <span class="p">(</span>
</span><span id="WeightedSim.updateRowCounts-706"><a href="#WeightedSim.updateRowCounts-706"><span class="linenos">706</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span>
</span><span id="WeightedSim.updateRowCounts-707"><a href="#WeightedSim.updateRowCounts-707"><span class="linenos">707</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span>
</span><span id="WeightedSim.updateRowCounts-708"><a href="#WeightedSim.updateRowCounts-708"><span class="linenos">708</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">colConc</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">+</span>
</span><span id="WeightedSim.updateRowCounts-709"><a href="#WeightedSim.updateRowCounts-709"><span class="linenos">709</span></a>                    <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="n">m</span><span class="p">]))</span>
</span><span id="WeightedSim.updateRowCounts-710"><a href="#WeightedSim.updateRowCounts-710"><span class="linenos">710</span></a>                <span class="p">)</span>
</span><span id="WeightedSim.updateRowCounts-711"><a href="#WeightedSim.updateRowCounts-711"><span class="linenos">711</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowWeights</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="WeightedSim.updateRowCounts-712"><a href="#WeightedSim.updateRowCounts-712"><span class="linenos">712</span></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Updates the <code><a href="#WeightedSim.rowWeights">rowWeights</a></code>, <code><a href="#WeightedSim.rowDistSims">rowDistSims</a></code>, and <code><a href="#WeightedSim.totalWeight">totalWeight</a></code>
properties, if necessary, so that the number of rows in
<code><a href="#WeightedSim.rowDistSims">rowDistSims</a></code> is the same as the number of rows in the
<code><a href="#IDPModel.rowCounts">IDPModel.rowCounts</a></code> property of the associated <code><a href="#WeightedSim.idpModel">idpModel</a></code>
instance.</p>

<p><strong>Raises:</strong></p>

<ul>
<li><strong>ValueError</strong>: If the computed value for the <code><a href="#WeightedSim.totalWeight">totalWeight</a></code>
property is so small or so large that it evaluates to <code>0.0</code>
or <code>np.inf</code>.</li>
</ul>
</div>


                            </div>
                            <div id="WeightedSim.updateScale" class="classattr">
                                        <input id="WeightedSim.updateScale-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">updateScale</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="WeightedSim.updateScale-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#WeightedSim.updateScale"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="WeightedSim.updateScale-714"><a href="#WeightedSim.updateScale-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">updateScale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="WeightedSim.updateScale-715"><a href="#WeightedSim.updateScale-715"><span class="linenos">715</span></a>        <span class="sd">&#39;&#39;&#39;Updates the `totalWeight` property, if necessary, to account</span>
</span><span id="WeightedSim.updateScale-716"><a href="#WeightedSim.updateScale-716"><span class="linenos">716</span></a><span class="sd">        for a change in the `IDPModel.scale` property of the associated</span>
</span><span id="WeightedSim.updateScale-717"><a href="#WeightedSim.updateScale-717"><span class="linenos">717</span></a><span class="sd">        `idpModel` instance.</span>
</span><span id="WeightedSim.updateScale-718"><a href="#WeightedSim.updateScale-718"><span class="linenos">718</span></a>
</span><span id="WeightedSim.updateScale-719"><a href="#WeightedSim.updateScale-719"><span class="linenos">719</span></a><span class="sd">        **Raises:**</span>
</span><span id="WeightedSim.updateScale-720"><a href="#WeightedSim.updateScale-720"><span class="linenos">720</span></a>
</span><span id="WeightedSim.updateScale-721"><a href="#WeightedSim.updateScale-721"><span class="linenos">721</span></a><span class="sd">        * **ValueError**: If the new value for the `totalWeight`</span>
</span><span id="WeightedSim.updateScale-722"><a href="#WeightedSim.updateScale-722"><span class="linenos">722</span></a><span class="sd">            property is so small or so large that it evaluates to `0.0`</span>
</span><span id="WeightedSim.updateScale-723"><a href="#WeightedSim.updateScale-723"><span class="linenos">723</span></a><span class="sd">            or `np.inf`.</span>
</span><span id="WeightedSim.updateScale-724"><a href="#WeightedSim.updateScale-724"><span class="linenos">724</span></a>
</span><span id="WeightedSim.updateScale-725"><a href="#WeightedSim.updateScale-725"><span class="linenos">725</span></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="WeightedSim.updateScale-726"><a href="#WeightedSim.updateScale-726"><span class="linenos">726</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span>
</span><span id="WeightedSim.updateScale-727"><a href="#WeightedSim.updateScale-727"><span class="linenos">727</span></a>        <span class="k">if</span> <span class="n">diff</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="WeightedSim.updateScale-728"><a href="#WeightedSim.updateScale-728"><span class="linenos">728</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_rowDistSims</span><span class="p">)</span> <span class="o">*</span> <span class="n">diff</span>
</span><span id="WeightedSim.updateScale-729"><a href="#WeightedSim.updateScale-729"><span class="linenos">729</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_idpModel</span><span class="o">.</span><span class="n">scale</span>
</span><span id="WeightedSim.updateScale-730"><a href="#WeightedSim.updateScale-730"><span class="linenos">730</span></a>            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_logWeight</span><span class="p">)</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
</span><span id="WeightedSim.updateScale-731"><a href="#WeightedSim.updateScale-731"><span class="linenos">731</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="WeightedSim.updateScale-732"><a href="#WeightedSim.updateScale-732"><span class="linenos">732</span></a>                    <span class="s1">&#39;Resulting simulation weight is out of bounds&#39;</span>
</span><span id="WeightedSim.updateScale-733"><a href="#WeightedSim.updateScale-733"><span class="linenos">733</span></a>                <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Updates the <code><a href="#WeightedSim.totalWeight">totalWeight</a></code> property, if necessary, to account
for a change in the <code><a href="#IDPModel.scale">IDPModel.scale</a></code> property of the associated
<code><a href="#WeightedSim.idpModel">idpModel</a></code> instance.</p>

<p><strong>Raises:</strong></p>

<ul>
<li><strong>ValueError</strong>: If the new value for the <code><a href="#WeightedSim.totalWeight">totalWeight</a></code>
property is so small or so large that it evaluates to <code>0.0</code>
or <code>np.inf</code>.</li>
</ul>
</div>


                            </div>
                </section>
    </main>
</body>
</html>